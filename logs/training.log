2025-05-10 12:05:08,915 - train_models - INFO - Starting the model training process
2025-05-10 12:05:08,916 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:07:50,330 - train_models - INFO - Starting the model training process
2025-05-10 12:07:50,331 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:08:29,705 - train_models - INFO - Starting the model training process
2025-05-10 12:08:29,706 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.xlsx
2025-05-10 12:09:14,500 - train_models - INFO - Starting the model training process
2025-05-10 12:09:14,513 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-10 12:09:14,693 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-10 12:09:14,694 - train_models - INFO - Engineering features
2025-05-10 12:09:14,737 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-10 12:09:14,750 - train_models - INFO - Created 15 new features
2025-05-10 12:09:14,751 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-10 12:09:14,751 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-10 12:09:14,756 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-10 12:09:14,824 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-10 12:09:14,996 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-10 12:09:14,997 - train_models - INFO - Found 5 unique work types
2025-05-10 12:09:14,998 - train_models - INFO - Building models for 5 work types
2025-05-10 12:09:14,998 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-10 12:09:14,998 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-10 12:09:14,999 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-10 12:09:14,999 - train_models - INFO - Building model for WorkType: 209
2025-05-10 12:09:15,006 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:11:21,487 - train_models - INFO - Starting the model training process
2025-05-10 12:11:21,489 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-10 12:11:21,584 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-10 12:11:21,585 - train_models - INFO - Engineering features
2025-05-10 12:11:21,645 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-10 12:11:21,669 - train_models - INFO - Created 15 new features
2025-05-10 12:11:21,670 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-10 12:11:21,671 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-10 12:11:21,680 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-10 12:11:21,779 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-10 12:11:21,983 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-10 12:11:21,987 - train_models - INFO - Found 5 unique work types
2025-05-10 12:11:21,988 - train_models - INFO - Building models for 5 work types
2025-05-10 12:11:21,990 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-10 12:11:21,992 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-10 12:11:21,993 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-10 12:11:21,994 - train_models - INFO - Building model for WorkType: 209
2025-05-10 12:11:22,013 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:12:44,616 - train_models - INFO - Model for 209 - MAE: 0.4612, RMSE: 0.8679, R²: 0.9585, MAPE: 6.52%
2025-05-10 12:12:44,628 - train_models - INFO - Top 10 most important features for 209:
2025-05-10 12:12:44,628 - train_models - INFO -   Relative_Quantity: 0.6846
2025-05-10 12:12:44,629 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1485
2025-05-10 12:12:44,629 - train_models - INFO -   Hours_per_Quantity: 0.0548
2025-05-10 12:12:44,629 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-10 12:12:44,630 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0246
2025-05-10 12:12:44,630 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-10 12:12:44,631 - train_models - INFO -   NoOfMan_7day_trend: 0.0048
2025-05-10 12:12:44,631 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-10 12:12:44,632 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0026
2025-05-10 12:12:44,632 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-10 12:12:44,632 - train_models - INFO - Cross-validation details for 209:
2025-05-10 12:12:44,633 - train_models - INFO -   Fold 1: MAE=0.6603, RMSE=0.9510, R²=0.9399, MAPE=9.45%
2025-05-10 12:12:44,633 - train_models - INFO -   Fold 2: MAE=0.4873, RMSE=1.0376, R²=0.9461, MAPE=7.50%
2025-05-10 12:12:44,634 - train_models - INFO -   Fold 3: MAE=0.3704, RMSE=0.7427, R²=0.9586, MAPE=4.63%
2025-05-10 12:12:44,634 - train_models - INFO -   Fold 4: MAE=0.3784, RMSE=0.8627, R²=0.9649, MAPE=5.06%
2025-05-10 12:12:44,635 - train_models - INFO -   Fold 5: MAE=0.4094, RMSE=0.7454, R²=0.9831, MAPE=5.95%
2025-05-10 12:12:44,635 - train_models - INFO - Building model for WorkType: 211
2025-05-10 12:12:44,643 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:14:00,841 - train_models - INFO - Model for 211 - MAE: 0.6606, RMSE: 0.9850, R²: 0.9151, MAPE: 9.94%
2025-05-10 12:14:00,841 - train_models - INFO - Top 10 most important features for 211:
2025-05-10 12:14:00,842 - train_models - INFO -   Relative_Quantity: 0.4668
2025-05-10 12:14:00,842 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1591
2025-05-10 12:14:00,843 - train_models - INFO -   NoOfMan_7day_trend: 0.1100
2025-05-10 12:14:00,844 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0861
2025-05-10 12:14:00,844 - train_models - INFO -   NoOfMan_1day_trend: 0.0458
2025-05-10 12:14:00,845 - train_models - INFO -   NoOfMan_lag_1: 0.0258
2025-05-10 12:14:00,845 - train_models - INFO -   NoOfMan_lag_7: 0.0236
2025-05-10 12:14:00,845 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-10 12:14:00,846 - train_models - INFO -   Hours_per_Quantity: 0.0106
2025-05-10 12:14:00,846 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0052
2025-05-10 12:14:00,847 - train_models - INFO - Cross-validation details for 211:
2025-05-10 12:14:00,848 - train_models - INFO -   Fold 1: MAE=1.1096, RMSE=1.7041, R²=0.8114, MAPE=13.47%
2025-05-10 12:14:00,849 - train_models - INFO -   Fold 2: MAE=0.5611, RMSE=0.8506, R²=0.9317, MAPE=6.27%
2025-05-10 12:14:00,850 - train_models - INFO -   Fold 3: MAE=0.5784, RMSE=0.9275, R²=0.9325, MAPE=12.58%
2025-05-10 12:14:00,850 - train_models - INFO -   Fold 4: MAE=0.4559, RMSE=0.6714, R²=0.9616, MAPE=6.61%
2025-05-10 12:14:00,851 - train_models - INFO -   Fold 5: MAE=0.5981, RMSE=0.7712, R²=0.9385, MAPE=10.79%
2025-05-10 12:14:00,851 - train_models - INFO - Building model for WorkType: 213
2025-05-10 12:14:00,862 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:15:24,031 - train_models - INFO - Model for 213 - MAE: 0.4370, RMSE: 0.6455, R²: 0.8717, MAPE: 17.05%
2025-05-10 12:15:24,032 - train_models - INFO - Top 10 most important features for 213:
2025-05-10 12:15:24,033 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4479
2025-05-10 12:15:24,034 - train_models - INFO -   NoOfMan_7day_trend: 0.1968
2025-05-10 12:15:24,035 - train_models - INFO -   NoOfMan_1day_trend: 0.1472
2025-05-10 12:15:24,036 - train_models - INFO -   NoOfMan_lag_1: 0.0431
2025-05-10 12:15:24,037 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0419
2025-05-10 12:15:24,038 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0339
2025-05-10 12:15:24,040 - train_models - INFO -   NoOfMan_lag_7: 0.0248
2025-05-10 12:15:24,041 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0073
2025-05-10 12:15:24,042 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0064
2025-05-10 12:15:24,043 - train_models - INFO -   Relative_Quantity: 0.0064
2025-05-10 12:15:24,044 - train_models - INFO - Cross-validation details for 213:
2025-05-10 12:15:24,044 - train_models - INFO -   Fold 1: MAE=0.6100, RMSE=0.9201, R²=0.8055, MAPE=15.01%
2025-05-10 12:15:24,045 - train_models - INFO -   Fold 2: MAE=0.5253, RMSE=0.7163, R²=0.8335, MAPE=26.89%
2025-05-10 12:15:24,046 - train_models - INFO -   Fold 3: MAE=0.3567, RMSE=0.5451, R²=0.8953, MAPE=16.78%
2025-05-10 12:15:24,047 - train_models - INFO -   Fold 4: MAE=0.3548, RMSE=0.5172, R²=0.9087, MAPE=14.18%
2025-05-10 12:15:24,048 - train_models - INFO -   Fold 5: MAE=0.3382, RMSE=0.5287, R²=0.9155, MAPE=12.37%
2025-05-10 12:15:24,049 - train_models - INFO - Building model for WorkType: 214
2025-05-10 12:15:24,068 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:16:33,791 - train_models - INFO - Model for 214 - MAE: 0.4972, RMSE: 0.7220, R²: 0.8884, MAPE: 10.69%
2025-05-10 12:16:33,792 - train_models - INFO - Top 10 most important features for 214:
2025-05-10 12:16:33,792 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4705
2025-05-10 12:16:33,793 - train_models - INFO -   NoOfMan_7day_trend: 0.1602
2025-05-10 12:16:33,794 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-10 12:16:33,795 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0732
2025-05-10 12:16:33,796 - train_models - INFO -   NoOfMan_1day_trend: 0.0535
2025-05-10 12:16:33,797 - train_models - INFO -   NoOfMan_lag_7: 0.0438
2025-05-10 12:16:33,798 - train_models - INFO -   NoOfMan_lag_1: 0.0215
2025-05-10 12:16:33,800 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0084
2025-05-10 12:16:33,801 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0082
2025-05-10 12:16:33,802 - train_models - INFO -   Hours_per_Quantity: 0.0068
2025-05-10 12:16:33,803 - train_models - INFO - Cross-validation details for 214:
2025-05-10 12:16:33,804 - train_models - INFO -   Fold 1: MAE=0.4903, RMSE=0.6447, R²=0.8420, MAPE=11.18%
2025-05-10 12:16:33,805 - train_models - INFO -   Fold 2: MAE=0.4974, RMSE=0.6454, R²=0.8988, MAPE=11.58%
2025-05-10 12:16:33,806 - train_models - INFO -   Fold 3: MAE=0.3390, RMSE=0.4263, R²=0.9480, MAPE=8.88%
2025-05-10 12:16:33,807 - train_models - INFO -   Fold 4: MAE=0.3620, RMSE=0.5929, R²=0.9209, MAPE=7.18%
2025-05-10 12:16:33,807 - train_models - INFO -   Fold 5: MAE=0.7975, RMSE=1.3006, R²=0.8325, MAPE=14.62%
2025-05-10 12:16:33,808 - train_models - INFO - Building model for WorkType: 215
2025-05-10 12:16:33,826 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-10 12:17:38,200 - train_models - INFO - Model for 215 - MAE: 0.3156, RMSE: 0.6723, R²: 0.9556, MAPE: 6.74%
2025-05-10 12:17:38,200 - train_models - INFO - Top 10 most important features for 215:
2025-05-10 12:17:38,201 - train_models - INFO -   Relative_Quantity: 0.8666
2025-05-10 12:17:38,201 - train_models - INFO -   Hours_per_Quantity: 0.0557
2025-05-10 12:17:38,202 - train_models - INFO -   Quantity_per_Worker: 0.0412
2025-05-10 12:17:38,202 - train_models - INFO -   NoOfMan_1day_trend: 0.0070
2025-05-10 12:17:38,203 - train_models - INFO -   NoOfMan_7day_trend: 0.0064
2025-05-10 12:17:38,203 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0052
2025-05-10 12:17:38,204 - train_models - INFO -   Quantity_1day_trend: 0.0020
2025-05-10 12:17:38,204 - train_models - INFO -   SystemHours_per_Quantity: 0.0015
2025-05-10 12:17:38,205 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0014
2025-05-10 12:17:38,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0009
2025-05-10 12:17:38,206 - train_models - INFO - Cross-validation details for 215:
2025-05-10 12:17:38,208 - train_models - INFO -   Fold 1: MAE=0.6173, RMSE=1.2636, R²=0.8741, MAPE=12.09%
2025-05-10 12:17:38,208 - train_models - INFO -   Fold 2: MAE=0.2775, RMSE=0.4333, R²=0.9831, MAPE=7.01%
2025-05-10 12:17:38,209 - train_models - INFO -   Fold 3: MAE=0.2540, RMSE=0.6595, R²=0.9671, MAPE=5.42%
2025-05-10 12:17:38,210 - train_models - INFO -   Fold 4: MAE=0.2019, RMSE=0.4208, R²=0.9808, MAPE=5.02%
2025-05-10 12:17:38,210 - train_models - INFO -   Fold 5: MAE=0.2274, RMSE=0.5841, R²=0.9731, MAPE=4.13%
2025-05-10 12:17:38,211 - train_models - INFO - Saving 5 models to C:/forlogssystems/Models
2025-05-10 12:17:39,511 - train_models - INFO - Model files saved successfully
2025-05-10 12:17:39,512 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-10 12:17:39,512 - train_models - INFO - Model training completed
2025-05-14 14:27:29,518 - train_models - INFO - Starting the model training process
2025-05-14 14:27:29,520 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:27:29,561 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-14 14:27:29,561 - train_models - INFO - Engineering features
2025-05-14 14:27:29,576 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-14 14:27:29,580 - train_models - INFO - Created 15 new features
2025-05-14 14:27:29,581 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-14 14:27:29,581 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-14 14:27:29,583 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-14 14:27:29,616 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-14 14:27:29,677 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-14 14:27:29,679 - train_models - INFO - Found 5 unique work types
2025-05-14 14:27:29,679 - train_models - INFO - Building models for 5 work types
2025-05-14 14:27:29,679 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-14 14:27:29,680 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-14 14:27:29,680 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-14 14:27:29,680 - train_models - INFO - Building model for WorkType: 209
2025-05-14 14:27:29,685 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:27:57,696 - train_models - INFO - Model for 209 - MAE: 0.4612, RMSE: 0.8679, R²: 0.9585, MAPE: 6.52%
2025-05-14 14:27:57,697 - train_models - INFO - Top 10 most important features for 209:
2025-05-14 14:27:57,697 - train_models - INFO -   Relative_Quantity: 0.6846
2025-05-14 14:27:57,697 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1485
2025-05-14 14:27:57,697 - train_models - INFO -   Hours_per_Quantity: 0.0548
2025-05-14 14:27:57,698 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-14 14:27:57,698 - train_models - INFO -   Hours_SystemHours_Ratio: 0.0246
2025-05-14 14:27:57,698 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_7day_trend: 0.0048
2025-05-14 14:27:57,699 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_rolling_mean_14: 0.0026
2025-05-14 14:27:57,699 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-14 14:27:57,700 - train_models - INFO - Cross-validation details for 209:
2025-05-14 14:27:57,700 - train_models - INFO -   Fold 1: MAE=0.6603, RMSE=0.9510, R²=0.9399, MAPE=9.45%
2025-05-14 14:27:57,700 - train_models - INFO -   Fold 2: MAE=0.4873, RMSE=1.0376, R²=0.9461, MAPE=7.50%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 3: MAE=0.3704, RMSE=0.7427, R²=0.9586, MAPE=4.63%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 4: MAE=0.3784, RMSE=0.8627, R²=0.9649, MAPE=5.06%
2025-05-14 14:27:57,701 - train_models - INFO -   Fold 5: MAE=0.4094, RMSE=0.7454, R²=0.9831, MAPE=5.95%
2025-05-14 14:27:57,701 - train_models - INFO - Building model for WorkType: 211
2025-05-14 14:27:57,711 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:28:26,838 - train_models - INFO - Model for 211 - MAE: 0.6606, RMSE: 0.9850, R²: 0.9151, MAPE: 9.94%
2025-05-14 14:28:26,839 - train_models - INFO - Top 10 most important features for 211:
2025-05-14 14:28:26,839 - train_models - INFO -   Relative_Quantity: 0.4668
2025-05-14 14:28:26,839 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1591
2025-05-14 14:28:26,839 - train_models - INFO -   NoOfMan_7day_trend: 0.1100
2025-05-14 14:28:26,840 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0861
2025-05-14 14:28:26,840 - train_models - INFO -   NoOfMan_1day_trend: 0.0458
2025-05-14 14:28:26,841 - train_models - INFO -   NoOfMan_lag_1: 0.0258
2025-05-14 14:28:26,841 - train_models - INFO -   NoOfMan_lag_7: 0.0236
2025-05-14 14:28:26,841 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-14 14:28:26,841 - train_models - INFO -   Hours_per_Quantity: 0.0106
2025-05-14 14:28:26,842 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0052
2025-05-14 14:28:26,842 - train_models - INFO - Cross-validation details for 211:
2025-05-14 14:28:26,842 - train_models - INFO -   Fold 1: MAE=1.1096, RMSE=1.7041, R²=0.8114, MAPE=13.47%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 2: MAE=0.5611, RMSE=0.8506, R²=0.9317, MAPE=6.27%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 3: MAE=0.5784, RMSE=0.9275, R²=0.9325, MAPE=12.58%
2025-05-14 14:28:26,843 - train_models - INFO -   Fold 4: MAE=0.4559, RMSE=0.6714, R²=0.9616, MAPE=6.61%
2025-05-14 14:28:26,844 - train_models - INFO -   Fold 5: MAE=0.5981, RMSE=0.7712, R²=0.9385, MAPE=10.79%
2025-05-14 14:28:26,844 - train_models - INFO - Building model for WorkType: 213
2025-05-14 14:28:26,849 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:33:20,038 - train_models - INFO - Starting the model training process
2025-05-14 14:33:20,039 - train_models - INFO - Loading data from C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:33:20,067 - train_models - INFO - Data loaded successfully. Shape: (7257, 9)
2025-05-14 14:33:20,067 - train_models - INFO - Engineering features
2025-05-14 14:33:20,085 - train_models - INFO - Found productivity metrics, creating derived features
2025-05-14 14:33:20,092 - train_models - INFO - Created 15 new features
2025-05-14 14:33:20,092 - train_models - INFO - Creating lag features with lag days: [1, 2, 3, 7, 14, 30, 365]
2025-05-14 14:33:20,092 - train_models - INFO - Creating rolling window features with windows: [7, 14, 30, 90]
2025-05-14 14:33:20,095 - train_models - INFO - Number of non-zero NoOfMan values: 7177 out of 7257
2025-05-14 14:33:20,132 - train_models - INFO - Creating lag features for productivity metrics: ['Quantity', 'ResourceKPI', 'SystemKPI', 'Combined_KPI', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Hours_per_Quantity', 'SystemHours_per_Quantity']
2025-05-14 14:33:20,216 - train_models - INFO - Final shape after creating lag features: (7257, 74)
2025-05-14 14:33:20,217 - train_models - INFO - Found 5 unique work types
2025-05-14 14:33:20,218 - train_models - INFO - Building models for 5 work types
2025-05-14 14:33:20,218 - train_models - INFO - Base numeric features: ['IsWeekend_feat', 'NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_lag_14', 'NoOfMan_lag_30', 'NoOfMan_lag_365', 'NoOfMan_rolling_mean_7', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_rolling_mean_14', 'NoOfMan_rolling_mean_30', 'NoOfMan_rolling_mean_90', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_1day_trend', 'NoOfMan_7day_trend']
2025-05-14 14:33:20,218 - train_models - INFO - Productivity features (if available): ['Quantity_lag_1', 'Quantity_lag_7', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Quantity_rolling_mean_7', 'ResourceKPI_rolling_mean_7', 'SystemKPI_rolling_mean_7', 'Hours_SystemHours_Ratio', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend', 'Workers_Predicted_from_Quantity']
2025-05-14 14:33:20,218 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-14 14:33:20,219 - train_models - INFO - Building model for WorkType: 209
2025-05-14 14:33:20,226 - train_models - INFO - Using 36 numeric features and 2 categorical features
2025-05-14 14:36:49,290 - train_models - INFO - Starting the model training process
2025-05-14 14:36:49,291 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-14 14:37:36,411 - train_models - INFO - Starting the model training process
2025-05-14 14:37:36,412 - train_models - INFO - Training from SQL database (command line argument)
2025-05-14 14:37:36,416 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-14 14:37:36,530 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-14 14:37:37,119 - train_models - INFO - Read chunk of 10000 rows
2025-05-14 14:37:37,228 - train_models - INFO - Read chunk of 8386 rows
2025-05-14 14:37:37,246 - train_models - INFO - Data loaded successfully. Total rows: 18386
2025-05-14 14:37:37,248 - train_models - INFO - Engineering features
2025-05-14 14:37:37,249 - train_models - ERROR - Error in train_from_sql: Can only use .dt accessor with datetimelike values
2025-05-14 14:37:37,250 - train_models - INFO - Model training completed
2025-05-17 10:30:45,679 - train_models - INFO - Starting the model training process
2025-05-17 10:30:45,680 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-17 10:31:04,945 - train_models - INFO - Starting the model training process
2025-05-17 10:31:04,945 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:31:04,952 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:31:05,377 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-17 10:31:06,105 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:31:06,250 - train_models - INFO - Read chunk of 8397 rows
2025-05-17 10:31:06,297 - train_models - INFO - Data loaded successfully. Total rows: 18397
2025-05-17 10:31:06,302 - train_models - INFO - Engineering features...
2025-05-17 10:31:06,776 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:31:06,777 - utils.feature_engineering - ERROR - Error engineering features: Can only use .dt accessor with datetimelike values
2025-05-17 10:31:06,849 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 37, in engineer_features
    data['Year_feat'] = data['Date'].dt.year
                        ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\accessors.py", line 643, in __new__
    raise AttributeError("Can only use .dt accessor with datetimelike values")
AttributeError: Can only use .dt accessor with datetimelike values

2025-05-17 10:31:06,851 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: Can only use .dt accessor with datetimelike values
2025-05-17 10:31:06,853 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 37, in engineer_features
    data['Year_feat'] = data['Date'].dt.year
                        ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\accessor.py", line 224, in __get__
    accessor_obj = self._accessor(obj)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\accessors.py", line 643, in __new__
    raise AttributeError("Can only use .dt accessor with datetimelike values")
AttributeError: Can only use .dt accessor with datetimelike values

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 330, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 111, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: Can only use .dt accessor with datetimelike values

2025-05-17 10:31:06,854 - train_models - INFO - Model training completed successfully
2025-05-17 10:40:05,148 - train_models - INFO - Starting the model training process
2025-05-17 10:40:05,148 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:40:05,153 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:40:05,494 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData
            
2025-05-17 10:40:06,153 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:40:06,301 - train_models - INFO - Read chunk of 8397 rows
2025-05-17 10:40:06,356 - train_models - INFO - Data loaded successfully. Total rows: 18397
2025-05-17 10:40:06,358 - train_models - INFO - Converting Date column to datetime format
2025-05-17 10:40:06,379 - train_models - INFO - Engineering features...
2025-05-17 10:40:06,838 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:40:06,886 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-17 10:40:06,893 - train_models - INFO - Creating lag features...
2025-05-17 10:40:06,903 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-17 10:40:07,123 - utils.feature_engineering - INFO - Lag features created. Dropped 4520 rows with NaN values.
2025-05-17 10:40:07,123 - utils.feature_engineering - INFO - Final shape: (13877, 72)
2025-05-17 10:40:07,138 - train_models - INFO - Found 12 unique work types
2025-05-17 10:40:07,138 - train_models - INFO - Building models for 12 work types
2025-05-17 10:40:07,138 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-17 10:40:07,138 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-17 10:40:07,139 - train_models - INFO - Building model for WorkType: 201
2025-05-17 10:40:07,143 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:19,082 - train_models - INFO - Model for 201 - MAE: 21.5560, RMSE: 27.6092, R²: -7.0596, MAPE: 600.70%
2025-05-17 10:40:19,083 - train_models - INFO - Top 10 most important features for 201:
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6657
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0870
2025-05-17 10:40:19,084 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0631
2025-05-17 10:40:19,084 - train_models - INFO -   Relative_Quantity: 0.0563
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_lag_1: 0.0266
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_7day_trend: 0.0262
2025-05-17 10:40:19,085 - train_models - INFO -   NoOfMan_1day_trend: 0.0157
2025-05-17 10:40:19,086 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0086
2025-05-17 10:40:19,086 - train_models - INFO -   Quantity_per_Worker: 0.0083
2025-05-17 10:40:19,086 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-17 10:40:19,086 - train_models - INFO - Cross-validation details for 201:
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 1: MAE=28.3978, RMSE=40.9448, R²=0.7913, MAPE=27.14%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 2: MAE=33.9669, RMSE=49.5103, R²=0.7835, MAPE=135.47%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 3: MAE=45.0065, RMSE=46.1921, R²=-21.3890, MAPE=2805.39%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 4: MAE=0.3318, RMSE=0.9450, R²=-16.2019, MAPE=32.79%
2025-05-17 10:40:19,087 - train_models - INFO -   Fold 5: MAE=0.0770, RMSE=0.4539, R²=0.7180, MAPE=2.71%
2025-05-17 10:40:19,088 - train_models - INFO - Building model for WorkType: 202
2025-05-17 10:40:19,092 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:34,690 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-17 10:40:34,690 - train_models - INFO - Top 10 most important features for 202:
2025-05-17 10:40:34,690 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-17 10:40:34,691 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-17 10:40:34,692 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-17 10:40:34,692 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-17 10:40:34,692 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-17 10:40:34,693 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-17 10:40:34,693 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-17 10:40:34,693 - train_models - INFO - Cross-validation details for 202:
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-17 10:40:34,694 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-17 10:40:34,695 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-17 10:40:34,695 - train_models - INFO - Building model for WorkType: 203
2025-05-17 10:40:34,699 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:40:50,933 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-17 10:40:50,933 - train_models - INFO - Top 10 most important features for 203:
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-17 10:40:50,934 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-17 10:40:50,935 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-17 10:40:50,936 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-17 10:40:50,936 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-17 10:40:50,936 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-17 10:40:50,937 - train_models - INFO - Cross-validation details for 203:
2025-05-17 10:40:50,937 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-17 10:40:50,937 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-17 10:40:50,938 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-17 10:40:50,938 - train_models - INFO - Building model for WorkType: 206
2025-05-17 10:40:50,943 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:12,606 - train_models - INFO - Model for 206 - MAE: 1.3115, RMSE: 2.1334, R²: 0.9311, MAPE: 10.37%
2025-05-17 10:41:12,606 - train_models - INFO - Top 10 most important features for 206:
2025-05-17 10:41:12,607 - train_models - INFO -   Relative_Quantity: 0.6873
2025-05-17 10:41:12,608 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1237
2025-05-17 10:41:12,608 - train_models - INFO -   Hours_per_Quantity: 0.0417
2025-05-17 10:41:12,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0415
2025-05-17 10:41:12,609 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0313
2025-05-17 10:41:12,609 - train_models - INFO -   Quantity_per_Worker: 0.0277
2025-05-17 10:41:12,609 - train_models - INFO -   NoOfMan_1day_trend: 0.0102
2025-05-17 10:41:12,610 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-17 10:41:12,610 - train_models - INFO -   NoOfMan_lag_1: 0.0044
2025-05-17 10:41:12,610 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-17 10:41:12,610 - train_models - INFO - Cross-validation details for 206:
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 1: MAE=1.8039, RMSE=2.4177, R²=0.9220, MAPE=9.19%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 2: MAE=1.3929, RMSE=1.9463, R²=0.9430, MAPE=8.36%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 3: MAE=1.1018, RMSE=2.3244, R²=0.8987, MAPE=6.02%
2025-05-17 10:41:12,611 - train_models - INFO -   Fold 4: MAE=0.9892, RMSE=1.8699, R²=0.9362, MAPE=14.06%
2025-05-17 10:41:12,612 - train_models - INFO -   Fold 5: MAE=1.2697, RMSE=2.1087, R²=0.9559, MAPE=14.25%
2025-05-17 10:41:12,612 - train_models - INFO - Building model for WorkType: 209
2025-05-17 10:41:12,620 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:29,543 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-17 10:41:29,543 - train_models - INFO - Top 10 most important features for 209:
2025-05-17 10:41:29,544 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-17 10:41:29,544 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-17 10:41:29,544 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-17 10:41:29,544 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-17 10:41:29,545 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-17 10:41:29,546 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-17 10:41:29,546 - train_models - INFO - Cross-validation details for 209:
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-17 10:41:29,547 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-17 10:41:29,548 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-17 10:41:29,548 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-17 10:41:29,548 - train_models - INFO - Building model for WorkType: 210
2025-05-17 10:41:29,554 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:41:45,773 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-17 10:41:45,773 - train_models - INFO - Top 10 most important features for 210:
2025-05-17 10:41:45,773 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-17 10:41:45,774 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-17 10:41:45,774 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-17 10:41:45,774 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-17 10:41:45,774 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-17 10:41:45,775 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-17 10:41:45,775 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-17 10:41:45,775 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-17 10:41:45,776 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:41:45,776 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-17 10:41:45,776 - train_models - INFO - Cross-validation details for 210:
2025-05-17 10:41:45,776 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-17 10:41:45,776 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-17 10:41:45,777 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-17 10:41:45,778 - train_models - INFO - Building model for WorkType: 211
2025-05-17 10:41:45,781 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:04,156 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-17 10:42:04,156 - train_models - INFO - Top 10 most important features for 211:
2025-05-17 10:42:04,157 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-17 10:42:04,157 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-17 10:42:04,157 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-17 10:42:04,158 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-17 10:42:04,158 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-17 10:42:04,159 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-17 10:42:04,159 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-17 10:42:04,159 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-17 10:42:04,160 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-17 10:42:04,160 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-17 10:42:04,160 - train_models - INFO - Cross-validation details for 211:
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-17 10:42:04,161 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-17 10:42:04,162 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-17 10:42:04,162 - train_models - INFO - Building model for WorkType: 213
2025-05-17 10:42:04,167 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:20,765 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-17 10:42:20,766 - train_models - INFO - Top 10 most important features for 213:
2025-05-17 10:42:20,766 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-17 10:42:20,766 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-17 10:42:20,767 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-17 10:42:20,768 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-17 10:42:20,768 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-17 10:42:20,768 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-17 10:42:20,769 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-17 10:42:20,769 - train_models - INFO - Cross-validation details for 213:
2025-05-17 10:42:20,769 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-17 10:42:20,769 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-17 10:42:20,770 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-17 10:42:20,770 - train_models - INFO - Building model for WorkType: 214
2025-05-17 10:42:20,774 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:37,218 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-17 10:42:37,218 - train_models - INFO - Top 10 most important features for 214:
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-17 10:42:37,219 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-17 10:42:37,219 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-17 10:42:37,220 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-17 10:42:37,221 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-17 10:42:37,221 - train_models - INFO - Cross-validation details for 214:
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-17 10:42:37,222 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-17 10:42:37,223 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-17 10:42:37,223 - train_models - INFO - Building model for WorkType: 215
2025-05-17 10:42:37,228 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:42:57,594 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-17 10:42:57,594 - train_models - INFO - Top 10 most important features for 215:
2025-05-17 10:42:57,595 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-17 10:42:57,595 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-17 10:42:57,595 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-17 10:42:57,595 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-17 10:42:57,596 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-17 10:42:57,596 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-17 10:42:57,597 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:42:57,597 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-17 10:42:57,597 - train_models - INFO - Cross-validation details for 215:
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-17 10:42:57,598 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-17 10:42:57,599 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-17 10:42:57,599 - train_models - INFO - Building model for WorkType: 217
2025-05-17 10:42:57,607 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:43:13,832 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-17 10:43:13,833 - train_models - INFO - Top 10 most important features for 217:
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-17 10:43:13,833 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-17 10:43:13,834 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-17 10:43:13,834 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-17 10:43:13,835 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-17 10:43:13,835 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-17 10:43:13,835 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-17 10:43:13,835 - train_models - INFO - Cross-validation details for 217:
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-17 10:43:13,836 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-17 10:43:13,837 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-17 10:43:13,837 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-17 10:43:13,837 - train_models - INFO - Building model for WorkType: 221
2025-05-17 10:43:13,842 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:43:32,303 - train_models - INFO - Model for 221 - MAE: 3.1396, RMSE: 4.4881, R²: 0.8766, MAPE: 41.03%
2025-05-17 10:43:32,304 - train_models - INFO - Top 10 most important features for 221:
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_7day_trend: 0.4825
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_1day_trend: 0.1925
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1145
2025-05-17 10:43:32,304 - train_models - INFO -   NoOfMan_lag_1: 0.0728
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_lag_7: 0.0657
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0208
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0115
2025-05-17 10:43:32,305 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0053
2025-05-17 10:43:32,306 - train_models - INFO -   DayOfWeek_feat_6: 0.0039
2025-05-17 10:43:32,306 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0026
2025-05-17 10:43:32,306 - train_models - INFO - Cross-validation details for 221:
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 1: MAE=7.2098, RMSE=10.0122, R²=0.6202, MAPE=51.42%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 2: MAE=2.1735, RMSE=2.7722, R²=0.9405, MAPE=35.44%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 3: MAE=2.0096, RMSE=2.8182, R²=0.9471, MAPE=28.31%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 4: MAE=2.4982, RMSE=3.7345, R²=0.9374, MAPE=44.42%
2025-05-17 10:43:32,307 - train_models - INFO -   Fold 5: MAE=1.8069, RMSE=3.1033, R²=0.9376, MAPE=45.56%
2025-05-17 10:43:32,308 - train_models - INFO - Saving 12 models to C:/forlogssystems/Models
2025-05-17 10:43:33,264 - train_models - INFO - Model files saved successfully
2025-05-17 10:43:33,264 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-17 10:43:33,268 - train_models - INFO - Model training completed successfully
2025-05-17 10:45:13,278 - train_models - INFO - Starting the model training process
2025-05-17 10:45:13,278 - train_models - INFO - Training from SQL database (command line argument)
2025-05-17 10:45:13,281 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-17 10:45:13,609 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-17 10:45:14,273 - train_models - INFO - Read chunk of 10000 rows
2025-05-17 10:45:14,380 - train_models - INFO - Read chunk of 5416 rows
2025-05-17 10:45:14,432 - train_models - INFO - Data loaded successfully. Total rows: 15416
2025-05-17 10:45:14,434 - train_models - INFO - Converting Date column to datetime format
2025-05-17 10:45:14,444 - train_models - INFO - Engineering features...
2025-05-17 10:45:14,772 - utils.feature_engineering - INFO - Engineering features
2025-05-17 10:45:14,802 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-17 10:45:14,810 - train_models - INFO - Creating lag features...
2025-05-17 10:45:14,820 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-17 10:45:14,998 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-17 10:45:14,999 - utils.feature_engineering - INFO - Final shape: (11761, 72)
2025-05-17 10:45:15,013 - train_models - INFO - Found 10 unique work types
2025-05-17 10:45:15,014 - train_models - INFO - Building models for 10 work types
2025-05-17 10:45:15,014 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-17 10:45:15,014 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-17 10:45:15,014 - train_models - INFO - Building model for WorkType: 202
2025-05-17 10:45:15,018 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:45:30,239 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-17 10:45:30,240 - train_models - INFO - Top 10 most important features for 202:
2025-05-17 10:45:30,240 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-17 10:45:30,240 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-17 10:45:30,241 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-17 10:45:30,242 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-17 10:45:30,242 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-17 10:45:30,242 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-17 10:45:30,242 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-17 10:45:30,243 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-17 10:45:30,243 - train_models - INFO - Cross-validation details for 202:
2025-05-17 10:45:30,243 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-17 10:45:30,243 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-17 10:45:30,244 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-17 10:45:30,245 - train_models - INFO - Building model for WorkType: 203
2025-05-17 10:45:30,249 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:45:46,307 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-17 10:45:46,308 - train_models - INFO - Top 10 most important features for 203:
2025-05-17 10:45:46,308 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-17 10:45:46,308 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-17 10:45:46,309 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-17 10:45:46,310 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-17 10:45:46,310 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-17 10:45:46,310 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-17 10:45:46,311 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-17 10:45:46,311 - train_models - INFO - Cross-validation details for 203:
2025-05-17 10:45:46,311 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-17 10:45:46,311 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-17 10:45:46,312 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-17 10:45:46,312 - train_models - INFO - Building model for WorkType: 206
2025-05-17 10:45:46,319 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:08,029 - train_models - INFO - Model for 206 - MAE: 1.3115, RMSE: 2.1334, R²: 0.9311, MAPE: 10.37%
2025-05-17 10:46:08,029 - train_models - INFO - Top 10 most important features for 206:
2025-05-17 10:46:08,029 - train_models - INFO -   Relative_Quantity: 0.6873
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1237
2025-05-17 10:46:08,030 - train_models - INFO -   Hours_per_Quantity: 0.0417
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0415
2025-05-17 10:46:08,030 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0313
2025-05-17 10:46:08,031 - train_models - INFO -   Quantity_per_Worker: 0.0277
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_1day_trend: 0.0102
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-17 10:46:08,031 - train_models - INFO -   NoOfMan_lag_1: 0.0044
2025-05-17 10:46:08,032 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-17 10:46:08,032 - train_models - INFO - Cross-validation details for 206:
2025-05-17 10:46:08,032 - train_models - INFO -   Fold 1: MAE=1.8039, RMSE=2.4177, R²=0.9220, MAPE=9.19%
2025-05-17 10:46:08,032 - train_models - INFO -   Fold 2: MAE=1.3929, RMSE=1.9463, R²=0.9430, MAPE=8.36%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 3: MAE=1.1018, RMSE=2.3244, R²=0.8987, MAPE=6.02%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 4: MAE=0.9892, RMSE=1.8699, R²=0.9362, MAPE=14.06%
2025-05-17 10:46:08,033 - train_models - INFO -   Fold 5: MAE=1.2697, RMSE=2.1087, R²=0.9559, MAPE=14.25%
2025-05-17 10:46:08,033 - train_models - INFO - Building model for WorkType: 209
2025-05-17 10:46:08,039 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:25,170 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-17 10:46:25,170 - train_models - INFO - Top 10 most important features for 209:
2025-05-17 10:46:25,171 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-17 10:46:25,171 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-17 10:46:25,171 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-17 10:46:25,172 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-17 10:46:25,172 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-17 10:46:25,172 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-17 10:46:25,173 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-17 10:46:25,174 - train_models - INFO - Cross-validation details for 209:
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-17 10:46:25,174 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-17 10:46:25,175 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-17 10:46:25,175 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-17 10:46:25,175 - train_models - INFO - Building model for WorkType: 210
2025-05-17 10:46:25,180 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:46:43,003 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-17 10:46:43,003 - train_models - INFO - Top 10 most important features for 210:
2025-05-17 10:46:43,003 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-17 10:46:43,004 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-17 10:46:43,004 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-17 10:46:43,004 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-17 10:46:43,005 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-17 10:46:43,005 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-17 10:46:43,005 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-17 10:46:43,006 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-17 10:46:43,006 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:46:43,006 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-17 10:46:43,007 - train_models - INFO - Cross-validation details for 210:
2025-05-17 10:46:43,007 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-17 10:46:43,007 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-17 10:46:43,008 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-17 10:46:43,008 - train_models - INFO - Building model for WorkType: 211
2025-05-17 10:46:43,016 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:01,427 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-17 10:47:01,427 - train_models - INFO - Top 10 most important features for 211:
2025-05-17 10:47:01,427 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-17 10:47:01,428 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-17 10:47:01,429 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-17 10:47:01,429 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-17 10:47:01,429 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-17 10:47:01,429 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-17 10:47:01,430 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-17 10:47:01,430 - train_models - INFO - Cross-validation details for 211:
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-17 10:47:01,430 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-17 10:47:01,431 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-17 10:47:01,431 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-17 10:47:01,431 - train_models - INFO - Building model for WorkType: 213
2025-05-17 10:47:01,436 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:18,907 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-17 10:47:18,908 - train_models - INFO - Top 10 most important features for 213:
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-17 10:47:18,908 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-17 10:47:18,909 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-17 10:47:18,909 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-17 10:47:18,910 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-17 10:47:18,910 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-17 10:47:18,910 - train_models - INFO - Cross-validation details for 213:
2025-05-17 10:47:18,910 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-17 10:47:18,911 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-17 10:47:18,911 - train_models - INFO - Building model for WorkType: 214
2025-05-17 10:47:18,916 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:35,231 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-17 10:47:35,232 - train_models - INFO - Top 10 most important features for 214:
2025-05-17 10:47:35,232 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-17 10:47:35,232 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-17 10:47:35,233 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-17 10:47:35,233 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-17 10:47:35,233 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-17 10:47:35,234 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-17 10:47:35,235 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-17 10:47:35,235 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-17 10:47:35,235 - train_models - INFO - Cross-validation details for 214:
2025-05-17 10:47:35,235 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-17 10:47:35,236 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-17 10:47:35,237 - train_models - INFO - Building model for WorkType: 215
2025-05-17 10:47:35,242 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:47:53,947 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-17 10:47:53,947 - train_models - INFO - Top 10 most important features for 215:
2025-05-17 10:47:53,948 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-17 10:47:53,948 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-17 10:47:53,948 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-17 10:47:53,949 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-17 10:47:53,950 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-17 10:47:53,950 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-17 10:47:53,950 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-17 10:47:53,951 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-17 10:47:53,951 - train_models - INFO - Cross-validation details for 215:
2025-05-17 10:47:53,951 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-17 10:47:53,951 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-17 10:47:53,952 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-17 10:47:53,952 - train_models - INFO - Building model for WorkType: 217
2025-05-17 10:47:53,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-17 10:48:08,287 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-17 10:48:08,288 - train_models - INFO - Top 10 most important features for 217:
2025-05-17 10:48:08,288 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-17 10:48:08,288 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-17 10:48:08,289 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-17 10:48:08,290 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-17 10:48:08,290 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-17 10:48:08,291 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-17 10:48:08,291 - train_models - INFO - Cross-validation details for 217:
2025-05-17 10:48:08,291 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-17 10:48:08,291 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-17 10:48:08,292 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-17 10:48:08,293 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-17 10:48:08,962 - train_models - INFO - Model files saved successfully
2025-05-17 10:48:08,962 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-17 10:48:08,964 - train_models - INFO - Model training completed successfully
2025-05-19 09:18:53,967 - train_models - INFO - Starting the model training process
2025-05-19 09:18:53,970 - train_models - INFO - Training from SQL database (command line argument)
2025-05-19 09:18:53,973 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-19 09:18:54,087 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-19 09:18:54,657 - train_models - INFO - Read chunk of 10000 rows
2025-05-19 09:18:54,733 - train_models - INFO - Read chunk of 5415 rows
2025-05-19 09:18:54,751 - train_models - INFO - Data loaded successfully. Total rows: 15415
2025-05-19 09:18:54,753 - train_models - INFO - Converting Date column to datetime format
2025-05-19 09:18:54,767 - train_models - INFO - Engineering features...
2025-05-19 09:18:55,172 - utils.feature_engineering - INFO - Engineering features
2025-05-19 09:18:55,203 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-19 09:18:55,209 - train_models - INFO - Creating lag features...
2025-05-19 09:18:55,219 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-19 09:18:55,386 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-19 09:18:55,387 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-19 09:18:55,399 - train_models - INFO - Found 10 unique work types
2025-05-19 09:18:55,400 - train_models - INFO - Building models for 10 work types
2025-05-19 09:18:55,400 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-19 09:18:55,400 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-19 09:18:55,401 - train_models - INFO - Building model for WorkType: 202
2025-05-19 09:18:55,406 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:10,575 - train_models - INFO - Model for 202 - MAE: 0.1989, RMSE: 0.2853, R²: 0.8699, MAPE: 9.39%
2025-05-19 09:19:10,576 - train_models - INFO - Top 10 most important features for 202:
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3748
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-19 09:19:10,577 - train_models - INFO -   NoOfMan_1day_trend: 0.1213
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_lag_1: 0.0663
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_lag_7: 0.0623
2025-05-19 09:19:10,578 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0607
2025-05-19 09:19:10,578 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-19 09:19:10,579 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-19 09:19:10,579 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-19 09:19:10,579 - train_models - INFO -   Quantity_per_Worker: 0.0111
2025-05-19 09:19:10,579 - train_models - INFO - Cross-validation details for 202:
2025-05-19 09:19:10,579 - train_models - INFO -   Fold 1: MAE=0.1863, RMSE=0.2578, R²=0.8569, MAPE=10.35%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 2: MAE=0.2172, RMSE=0.3477, R²=0.8202, MAPE=11.03%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 3: MAE=0.1882, RMSE=0.2548, R²=0.8847, MAPE=9.57%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 4: MAE=0.1835, RMSE=0.2589, R²=0.8928, MAPE=7.88%
2025-05-19 09:19:10,580 - train_models - INFO -   Fold 5: MAE=0.2196, RMSE=0.3076, R²=0.8950, MAPE=8.10%
2025-05-19 09:19:10,581 - train_models - INFO - Building model for WorkType: 203
2025-05-19 09:19:10,585 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:26,916 - train_models - INFO - Model for 203 - MAE: 0.2658, RMSE: 0.3951, R²: 0.8619, MAPE: 5.51%
2025-05-19 09:19:26,917 - train_models - INFO - Top 10 most important features for 203:
2025-05-19 09:19:26,917 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-19 09:19:26,917 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1381
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1300
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_lag_7: 0.1009
2025-05-19 09:19:26,918 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0976
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_lag_1: 0.0532
2025-05-19 09:19:26,919 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0061
2025-05-19 09:19:26,920 - train_models - INFO -   Quantity_rolling_mean_7: 0.0030
2025-05-19 09:19:26,920 - train_models - INFO -   Quantity_same_dow_lag: 0.0030
2025-05-19 09:19:26,920 - train_models - INFO - Cross-validation details for 203:
2025-05-19 09:19:26,920 - train_models - INFO -   Fold 1: MAE=0.3925, RMSE=0.5103, R²=0.7449, MAPE=7.29%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 2: MAE=0.2894, RMSE=0.5470, R²=0.8098, MAPE=4.89%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 3: MAE=0.2766, RMSE=0.3951, R²=0.8921, MAPE=5.87%
2025-05-19 09:19:26,921 - train_models - INFO -   Fold 4: MAE=0.1973, RMSE=0.2950, R²=0.9290, MAPE=5.31%
2025-05-19 09:19:26,922 - train_models - INFO -   Fold 5: MAE=0.1733, RMSE=0.2280, R²=0.9338, MAPE=4.19%
2025-05-19 09:19:26,922 - train_models - INFO - Building model for WorkType: 206
2025-05-19 09:19:26,926 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:19:48,486 - train_models - INFO - Model for 206 - MAE: 1.2976, RMSE: 2.1155, R²: 0.9328, MAPE: 10.12%
2025-05-19 09:19:48,486 - train_models - INFO - Top 10 most important features for 206:
2025-05-19 09:19:48,487 - train_models - INFO -   Relative_Quantity: 0.6753
2025-05-19 09:19:48,487 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1293
2025-05-19 09:19:48,487 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0416
2025-05-19 09:19:48,488 - train_models - INFO -   Hours_per_Quantity: 0.0360
2025-05-19 09:19:48,488 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0357
2025-05-19 09:19:48,488 - train_models - INFO -   Quantity_per_Worker: 0.0294
2025-05-19 09:19:48,488 - train_models - INFO -   NoOfMan_1day_trend: 0.0131
2025-05-19 09:19:48,489 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-19 09:19:48,489 - train_models - INFO -   NoOfMan_lag_1: 0.0057
2025-05-19 09:19:48,489 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-19 09:19:48,490 - train_models - INFO - Cross-validation details for 206:
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 1: MAE=1.7951, RMSE=2.3845, R²=0.9241, MAPE=9.13%
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 2: MAE=1.3520, RMSE=1.8653, R²=0.9477, MAPE=8.07%
2025-05-19 09:19:48,490 - train_models - INFO -   Fold 3: MAE=1.0790, RMSE=2.2681, R²=0.9035, MAPE=5.87%
2025-05-19 09:19:48,491 - train_models - INFO -   Fold 4: MAE=0.9895, RMSE=1.8636, R²=0.9366, MAPE=14.03%
2025-05-19 09:19:48,491 - train_models - INFO -   Fold 5: MAE=1.2723, RMSE=2.1962, R²=0.9521, MAPE=13.51%
2025-05-19 09:19:48,491 - train_models - INFO - Building model for WorkType: 209
2025-05-19 09:19:48,496 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:05,530 - train_models - INFO - Model for 209 - MAE: 0.5564, RMSE: 1.0576, R²: 0.9378, MAPE: 10.17%
2025-05-19 09:20:05,530 - train_models - INFO - Top 10 most important features for 209:
2025-05-19 09:20:05,531 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-19 09:20:05,531 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1242
2025-05-19 09:20:05,531 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-19 09:20:05,532 - train_models - INFO -   Quantity_per_Worker: 0.0451
2025-05-19 09:20:05,532 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-19 09:20:05,532 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-19 09:20:05,533 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-19 09:20:05,534 - train_models - INFO - Cross-validation details for 209:
2025-05-19 09:20:05,534 - train_models - INFO -   Fold 1: MAE=0.9479, RMSE=1.9150, R²=0.8370, MAPE=15.13%
2025-05-19 09:20:05,534 - train_models - INFO -   Fold 2: MAE=0.4144, RMSE=0.6753, R²=0.9677, MAPE=4.77%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 3: MAE=0.5144, RMSE=1.1423, R²=0.9413, MAPE=6.08%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 4: MAE=0.4809, RMSE=0.7631, R²=0.9637, MAPE=19.73%
2025-05-19 09:20:05,535 - train_models - INFO -   Fold 5: MAE=0.4244, RMSE=0.7921, R²=0.9793, MAPE=5.15%
2025-05-19 09:20:05,535 - train_models - INFO - Building model for WorkType: 210
2025-05-19 09:20:05,540 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:21,418 - train_models - INFO - Model for 210 - MAE: 0.4188, RMSE: 0.8294, R²: 0.9410, MAPE: 7.67%
2025-05-19 09:20:21,418 - train_models - INFO - Top 10 most important features for 210:
2025-05-19 09:20:21,419 - train_models - INFO -   Relative_Quantity: 0.8391
2025-05-19 09:20:21,419 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-19 09:20:21,419 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-19 09:20:21,420 - train_models - INFO -   Hours_per_Quantity: 0.0438
2025-05-19 09:20:21,420 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0072
2025-05-19 09:20:21,420 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_1day_trend: 0.0017
2025-05-19 09:20:21,421 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-19 09:20:21,421 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-19 09:20:21,422 - train_models - INFO - Cross-validation details for 210:
2025-05-19 09:20:21,422 - train_models - INFO -   Fold 1: MAE=0.5854, RMSE=1.2289, R²=0.8842, MAPE=9.21%
2025-05-19 09:20:21,422 - train_models - INFO -   Fold 2: MAE=0.3901, RMSE=0.6365, R²=0.9611, MAPE=4.57%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 3: MAE=0.4164, RMSE=0.9235, R²=0.9206, MAPE=6.29%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 4: MAE=0.3502, RMSE=0.5861, R²=0.9686, MAPE=13.71%
2025-05-19 09:20:21,423 - train_models - INFO -   Fold 5: MAE=0.3516, RMSE=0.7722, R²=0.9705, MAPE=4.59%
2025-05-19 09:20:21,423 - train_models - INFO - Building model for WorkType: 211
2025-05-19 09:20:21,428 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:39,185 - train_models - INFO - Model for 211 - MAE: 0.7166, RMSE: 1.0122, R²: 0.9035, MAPE: 11.33%
2025-05-19 09:20:39,186 - train_models - INFO - Top 10 most important features for 211:
2025-05-19 09:20:39,186 - train_models - INFO -   Relative_Quantity: 0.4611
2025-05-19 09:20:39,186 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-19 09:20:39,186 - train_models - INFO -   NoOfMan_1day_trend: 0.0958
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_7day_trend: 0.0696
2025-05-19 09:20:39,187 - train_models - INFO -   NoOfMan_lag_1: 0.0337
2025-05-19 09:20:39,188 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-19 09:20:39,188 - train_models - INFO -   Quantity_per_Worker: 0.0112
2025-05-19 09:20:39,188 - train_models - INFO -   Hours_per_Quantity: 0.0090
2025-05-19 09:20:39,189 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-19 09:20:39,189 - train_models - INFO - Cross-validation details for 211:
2025-05-19 09:20:39,189 - train_models - INFO -   Fold 1: MAE=0.9197, RMSE=1.3137, R²=0.8375, MAPE=12.03%
2025-05-19 09:20:39,189 - train_models - INFO -   Fold 2: MAE=0.8565, RMSE=1.2996, R²=0.8757, MAPE=17.31%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 3: MAE=0.4930, RMSE=0.6772, R²=0.9415, MAPE=6.05%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 4: MAE=0.7637, RMSE=0.9924, R²=0.9243, MAPE=14.81%
2025-05-19 09:20:39,190 - train_models - INFO -   Fold 5: MAE=0.5500, RMSE=0.7783, R²=0.9387, MAPE=6.44%
2025-05-19 09:20:39,191 - train_models - INFO - Building model for WorkType: 213
2025-05-19 09:20:39,195 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:20:55,503 - train_models - INFO - Model for 213 - MAE: 0.3656, RMSE: 0.5355, R²: 0.8760, MAPE: 16.10%
2025-05-19 09:20:55,504 - train_models - INFO - Top 10 most important features for 213:
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_7day_trend: 0.2736
2025-05-19 09:20:55,504 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_lag_1: 0.0464
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-19 09:20:55,505 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-19 09:20:55,506 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-19 09:20:55,506 - train_models - INFO -   Relative_Quantity: 0.0215
2025-05-19 09:20:55,506 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-19 09:20:55,507 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-19 09:20:55,507 - train_models - INFO - Cross-validation details for 213:
2025-05-19 09:20:55,507 - train_models - INFO -   Fold 1: MAE=0.4302, RMSE=0.5387, R²=0.7928, MAPE=25.92%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 2: MAE=0.4311, RMSE=0.6778, R²=0.8494, MAPE=17.60%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 3: MAE=0.3646, RMSE=0.5268, R²=0.9110, MAPE=14.92%
2025-05-19 09:20:55,508 - train_models - INFO -   Fold 4: MAE=0.2903, RMSE=0.4908, R²=0.9028, MAPE=12.01%
2025-05-19 09:20:55,509 - train_models - INFO -   Fold 5: MAE=0.3119, RMSE=0.4435, R²=0.9242, MAPE=10.06%
2025-05-19 09:20:55,509 - train_models - INFO - Building model for WorkType: 214
2025-05-19 09:20:55,513 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:11,491 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7960, R²: 0.8785, MAPE: 11.87%
2025-05-19 09:21:11,492 - train_models - INFO - Top 10 most important features for 214:
2025-05-19 09:21:11,492 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-19 09:21:11,492 - train_models - INFO -   NoOfMan_7day_trend: 0.1459
2025-05-19 09:21:11,492 - train_models - INFO -   Relative_Quantity: 0.0991
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0624
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_1day_trend: 0.0541
2025-05-19 09:21:11,493 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0118
2025-05-19 09:21:11,494 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-19 09:21:11,495 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-19 09:21:11,495 - train_models - INFO - Cross-validation details for 214:
2025-05-19 09:21:11,495 - train_models - INFO -   Fold 1: MAE=0.5164, RMSE=0.6720, R²=0.8615, MAPE=12.92%
2025-05-19 09:21:11,495 - train_models - INFO -   Fold 2: MAE=0.4415, RMSE=0.5723, R²=0.9127, MAPE=11.23%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 3: MAE=0.4104, RMSE=0.5791, R²=0.9138, MAPE=9.37%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 4: MAE=0.6145, RMSE=1.0678, R²=0.8438, MAPE=11.88%
2025-05-19 09:21:11,496 - train_models - INFO -   Fold 5: MAE=0.6869, RMSE=1.0888, R²=0.8606, MAPE=13.93%
2025-05-19 09:21:11,496 - train_models - INFO - Building model for WorkType: 215
2025-05-19 09:21:11,501 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:30,982 - train_models - INFO - Model for 215 - MAE: 0.3440, RMSE: 0.6242, R²: 0.9646, MAPE: 6.54%
2025-05-19 09:21:30,982 - train_models - INFO - Top 10 most important features for 215:
2025-05-19 09:21:30,982 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-19 09:21:30,982 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-19 09:21:30,982 - train_models - INFO -   Quantity_per_Worker: 0.0367
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_1day_trend: 0.0046
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-19 09:21:30,983 - train_models - INFO -   SystemHours_per_Quantity: 0.0020
2025-05-19 09:21:30,983 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0019
2025-05-19 09:21:30,984 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-19 09:21:30,984 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-19 09:21:30,984 - train_models - INFO - Cross-validation details for 215:
2025-05-19 09:21:30,984 - train_models - INFO -   Fold 1: MAE=0.5056, RMSE=0.7072, R²=0.9601, MAPE=9.73%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 2: MAE=0.4832, RMSE=0.8937, R²=0.9416, MAPE=8.49%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 3: MAE=0.2470, RMSE=0.3660, R²=0.9787, MAPE=5.73%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 4: MAE=0.2242, RMSE=0.5106, R²=0.9772, MAPE=5.64%
2025-05-19 09:21:30,985 - train_models - INFO -   Fold 5: MAE=0.2598, RMSE=0.6435, R²=0.9652, MAPE=3.12%
2025-05-19 09:21:30,985 - train_models - INFO - Building model for WorkType: 217
2025-05-19 09:21:30,989 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-19 09:21:45,547 - train_models - INFO - Model for 217 - MAE: 0.4282, RMSE: 0.6070, R²: 0.9038, MAPE: 16.77%
2025-05-19 09:21:45,547 - train_models - INFO - Top 10 most important features for 217:
2025-05-19 09:21:45,547 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_7day_trend: 0.1906
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1828
2025-05-19 09:21:45,548 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_lag_7: 0.0385
2025-05-19 09:21:45,549 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0219
2025-05-19 09:21:45,549 - train_models - INFO -   NoOfMan_lag_1: 0.0208
2025-05-19 09:21:45,550 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-19 09:21:45,550 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-19 09:21:45,550 - train_models - INFO - Cross-validation details for 217:
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 1: MAE=0.4583, RMSE=0.6163, R²=0.8578, MAPE=22.23%
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 2: MAE=0.4577, RMSE=0.7053, R²=0.9025, MAPE=15.94%
2025-05-19 09:21:45,551 - train_models - INFO -   Fold 3: MAE=0.3500, RMSE=0.4629, R²=0.9242, MAPE=14.09%
2025-05-19 09:21:45,552 - train_models - INFO -   Fold 4: MAE=0.4730, RMSE=0.6435, R²=0.9220, MAPE=17.62%
2025-05-19 09:21:45,552 - train_models - INFO -   Fold 5: MAE=0.4021, RMSE=0.6069, R²=0.9125, MAPE=14.00%
2025-05-19 09:21:45,553 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-19 09:21:46,233 - train_models - INFO - Model files saved successfully
2025-05-19 09:21:46,233 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-19 09:21:46,237 - train_models - INFO - Model training completed successfully
2025-05-23 12:29:41,925 - train_models - INFO - Starting the model training process
2025-05-23 12:29:41,936 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 12:29:41,943 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 12:29:42,130 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 12:29:43,051 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 12:29:43,191 - train_models - INFO - Read chunk of 5446 rows
2025-05-23 12:29:43,214 - train_models - INFO - Data loaded successfully. Total rows: 15446
2025-05-23 12:29:43,216 - train_models - INFO - Converting Date column to datetime format
2025-05-23 12:29:43,241 - train_models - INFO - Engineering features...
2025-05-23 12:29:44,019 - utils.feature_engineering - INFO - Engineering features
2025-05-23 12:29:44,125 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 12:29:44,131 - train_models - INFO - Creating lag features...
2025-05-23 12:29:44,144 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 12:29:44,332 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 12:29:44,332 - utils.feature_engineering - INFO - Final shape: (11791, 72)
2025-05-23 12:29:44,342 - train_models - INFO - Found 10 unique work types
2025-05-23 12:29:44,342 - train_models - INFO - Building models for 10 work types
2025-05-23 12:29:44,342 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 12:29:44,343 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 12:29:44,343 - train_models - INFO - Building model for WorkType: 202
2025-05-23 12:29:44,349 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:02,088 - train_models - INFO - Model for 202 - MAE: 0.1982, RMSE: 0.2841, R²: 0.8704, MAPE: 9.37%
2025-05-23 12:30:02,088 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3689
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1832
2025-05-23 12:30:02,089 - train_models - INFO -   NoOfMan_1day_trend: 0.1209
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_lag_1: 0.0676
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_lag_7: 0.0612
2025-05-23 12:30:02,090 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0605
2025-05-23 12:30:02,090 - train_models - INFO -   Relative_Quantity: 0.0505
2025-05-23 12:30:02,091 - train_models - INFO -   Hours_per_Quantity: 0.0201
2025-05-23 12:30:02,091 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0197
2025-05-23 12:30:02,091 - train_models - INFO -   Quantity_per_Worker: 0.0123
2025-05-23 12:30:02,092 - train_models - INFO - Cross-validation details for 202:
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 1: MAE=0.1877, RMSE=0.2598, R²=0.8540, MAPE=10.44%
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 2: MAE=0.2154, RMSE=0.3448, R²=0.8223, MAPE=10.97%
2025-05-23 12:30:02,092 - train_models - INFO -   Fold 3: MAE=0.1877, RMSE=0.2542, R²=0.8849, MAPE=9.54%
2025-05-23 12:30:02,093 - train_models - INFO -   Fold 4: MAE=0.1842, RMSE=0.2584, R²=0.8932, MAPE=7.93%
2025-05-23 12:30:02,093 - train_models - INFO -   Fold 5: MAE=0.2162, RMSE=0.3031, R²=0.8975, MAPE=7.99%
2025-05-23 12:30:02,093 - train_models - INFO - Building model for WorkType: 203
2025-05-23 12:30:02,098 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:23,175 - train_models - INFO - Model for 203 - MAE: 0.2631, RMSE: 0.3986, R²: 0.8621, MAPE: 5.44%
2025-05-23 12:30:23,175 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 12:30:23,175 - train_models - INFO -   NoOfMan_7day_trend: 0.3411
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1339
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1309
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1009
2025-05-23 12:30:23,176 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_1day_trend: 0.0922
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_lag_1: 0.0530
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0060
2025-05-23 12:30:23,177 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 12:30:23,178 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 12:30:23,178 - train_models - INFO - Cross-validation details for 203:
2025-05-23 12:30:23,178 - train_models - INFO -   Fold 1: MAE=0.3957, RMSE=0.5379, R²=0.7656, MAPE=7.06%
2025-05-23 12:30:23,178 - train_models - INFO -   Fold 2: MAE=0.2774, RMSE=0.5411, R²=0.7861, MAPE=4.77%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 3: MAE=0.2723, RMSE=0.3878, R²=0.8961, MAPE=5.79%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 4: MAE=0.1941, RMSE=0.2934, R²=0.9293, MAPE=5.29%
2025-05-23 12:30:23,179 - train_models - INFO -   Fold 5: MAE=0.1762, RMSE=0.2328, R²=0.9333, MAPE=4.30%
2025-05-23 12:30:23,180 - train_models - INFO - Building model for WorkType: 206
2025-05-23 12:30:23,185 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:30:51,297 - train_models - INFO - Model for 206 - MAE: 1.3022, RMSE: 2.1162, R²: 0.9329, MAPE: 10.17%
2025-05-23 12:30:51,297 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 12:30:51,298 - train_models - INFO -   Relative_Quantity: 0.6663
2025-05-23 12:30:51,298 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1335
2025-05-23 12:30:51,298 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0441
2025-05-23 12:30:51,299 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0363
2025-05-23 12:30:51,299 - train_models - INFO -   Hours_per_Quantity: 0.0355
2025-05-23 12:30:51,299 - train_models - INFO -   Quantity_per_Worker: 0.0281
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_1day_trend: 0.0145
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_7day_trend: 0.0079
2025-05-23 12:30:51,300 - train_models - INFO -   NoOfMan_lag_1: 0.0060
2025-05-23 12:30:51,300 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 12:30:51,301 - train_models - INFO - Cross-validation details for 206:
2025-05-23 12:30:51,301 - train_models - INFO -   Fold 1: MAE=1.7909, RMSE=2.3718, R²=0.9246, MAPE=9.12%
2025-05-23 12:30:51,301 - train_models - INFO -   Fold 2: MAE=1.3475, RMSE=1.8615, R²=0.9483, MAPE=8.05%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 3: MAE=1.0780, RMSE=2.2686, R²=0.9030, MAPE=5.87%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 4: MAE=0.9898, RMSE=1.8517, R²=0.9374, MAPE=13.95%
2025-05-23 12:30:51,302 - train_models - INFO -   Fold 5: MAE=1.3048, RMSE=2.2275, R²=0.9512, MAPE=13.87%
2025-05-23 12:30:51,302 - train_models - INFO - Building model for WorkType: 209
2025-05-23 12:30:51,308 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:12,913 - train_models - INFO - Model for 209 - MAE: 0.5550, RMSE: 1.0543, R²: 0.9381, MAPE: 10.19%
2025-05-23 12:31:12,913 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 12:31:12,914 - train_models - INFO -   Relative_Quantity: 0.7430
2025-05-23 12:31:12,914 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1233
2025-05-23 12:31:12,914 - train_models - INFO -   Hours_per_Quantity: 0.0578
2025-05-23 12:31:12,914 - train_models - INFO -   Quantity_per_Worker: 0.0436
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0083
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0022
2025-05-23 12:31:12,915 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 12:31:12,916 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 12:31:12,916 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0010
2025-05-23 12:31:12,916 - train_models - INFO - Cross-validation details for 209:
2025-05-23 12:31:12,916 - train_models - INFO -   Fold 1: MAE=0.9394, RMSE=1.9101, R²=0.8372, MAPE=15.03%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 2: MAE=0.4044, RMSE=0.6589, R²=0.9691, MAPE=4.65%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 3: MAE=0.5124, RMSE=1.1393, R²=0.9413, MAPE=6.06%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 4: MAE=0.4823, RMSE=0.7631, R²=0.9639, MAPE=19.75%
2025-05-23 12:31:12,917 - train_models - INFO -   Fold 5: MAE=0.4366, RMSE=0.8002, R²=0.9790, MAPE=5.47%
2025-05-23 12:31:12,917 - train_models - INFO - Building model for WorkType: 210
2025-05-23 12:31:12,922 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:33,500 - train_models - INFO - Model for 210 - MAE: 0.4227, RMSE: 0.8346, R²: 0.9404, MAPE: 7.74%
2025-05-23 12:31:33,501 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 12:31:33,501 - train_models - INFO -   Relative_Quantity: 0.8380
2025-05-23 12:31:33,501 - train_models - INFO -   Quantity_per_Worker: 0.0469
2025-05-23 12:31:33,502 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0448
2025-05-23 12:31:33,502 - train_models - INFO -   Hours_per_Quantity: 0.0434
2025-05-23 12:31:33,502 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0067
2025-05-23 12:31:33,503 - train_models - INFO -   SystemHours_per_Quantity: 0.0033
2025-05-23 12:31:33,503 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-23 12:31:33,503 - train_models - INFO -   NoOfMan_1day_trend: 0.0015
2025-05-23 12:31:33,503 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 12:31:33,504 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 12:31:33,504 - train_models - INFO - Cross-validation details for 210:
2025-05-23 12:31:33,504 - train_models - INFO -   Fold 1: MAE=0.5895, RMSE=1.2393, R²=0.8823, MAPE=9.23%
2025-05-23 12:31:33,504 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6391, R²=0.9606, MAPE=4.58%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 3: MAE=0.4156, RMSE=0.9213, R²=0.9206, MAPE=6.27%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 4: MAE=0.3493, RMSE=0.5873, R²=0.9695, MAPE=13.75%
2025-05-23 12:31:33,505 - train_models - INFO -   Fold 5: MAE=0.3702, RMSE=0.7863, R²=0.9692, MAPE=4.89%
2025-05-23 12:31:33,505 - train_models - INFO - Building model for WorkType: 211
2025-05-23 12:31:33,510 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:31:56,892 - train_models - INFO - Model for 211 - MAE: 0.7206, RMSE: 1.0515, R²: 0.8985, MAPE: 12.09%
2025-05-23 12:31:56,892 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 12:31:56,893 - train_models - INFO -   Relative_Quantity: 0.4505
2025-05-23 12:31:56,893 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1671
2025-05-23 12:31:56,893 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0961
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_1day_trend: 0.0950
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_7day_trend: 0.0725
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_lag_1: 0.0329
2025-05-23 12:31:56,894 - train_models - INFO -   NoOfMan_lag_7: 0.0180
2025-05-23 12:31:56,895 - train_models - INFO -   Quantity_per_Worker: 0.0146
2025-05-23 12:31:56,895 - train_models - INFO -   Hours_per_Quantity: 0.0093
2025-05-23 12:31:56,895 - train_models - INFO -   SystemHours_per_Quantity: 0.0050
2025-05-23 12:31:56,896 - train_models - INFO - Cross-validation details for 211:
2025-05-23 12:31:56,896 - train_models - INFO -   Fold 1: MAE=0.8823, RMSE=1.2823, R²=0.8451, MAPE=11.31%
2025-05-23 12:31:56,896 - train_models - INFO -   Fold 2: MAE=0.8418, RMSE=1.3105, R²=0.8740, MAPE=17.32%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 3: MAE=0.4964, RMSE=0.6778, R²=0.9441, MAPE=6.16%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 4: MAE=0.7916, RMSE=1.0344, R²=0.9156, MAPE=15.05%
2025-05-23 12:31:56,897 - train_models - INFO -   Fold 5: MAE=0.5909, RMSE=0.9524, R²=0.9140, MAPE=10.61%
2025-05-23 12:31:56,898 - train_models - INFO - Building model for WorkType: 213
2025-05-23 12:31:56,903 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:32:20,207 - train_models - INFO - Model for 213 - MAE: 0.3667, RMSE: 0.5306, R²: 0.8779, MAPE: 16.16%
2025-05-23 12:32:20,208 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3549
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_7day_trend: 0.2744
2025-05-23 12:32:20,208 - train_models - INFO -   NoOfMan_1day_trend: 0.1610
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_lag_1: 0.0465
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0316
2025-05-23 12:32:20,209 - train_models - INFO -   NoOfMan_lag_7: 0.0243
2025-05-23 12:32:20,210 - train_models - INFO -   Relative_Quantity: 0.0200
2025-05-23 12:32:20,210 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-23 12:32:20,210 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 12:32:20,210 - train_models - INFO - Cross-validation details for 213:
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 1: MAE=0.4232, RMSE=0.5263, R²=0.7912, MAPE=25.90%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.6524, R²=0.8610, MAPE=17.54%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 3: MAE=0.3714, RMSE=0.5341, R²=0.9084, MAPE=15.15%
2025-05-23 12:32:20,211 - train_models - INFO -   Fold 4: MAE=0.2958, RMSE=0.4931, R²=0.9080, MAPE=11.81%
2025-05-23 12:32:20,212 - train_models - INFO -   Fold 5: MAE=0.3167, RMSE=0.4472, R²=0.9211, MAPE=10.40%
2025-05-23 12:32:20,212 - train_models - INFO - Building model for WorkType: 214
2025-05-23 12:32:20,216 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:32:42,245 - train_models - INFO - Model for 214 - MAE: 0.5339, RMSE: 0.7973, R²: 0.8785, MAPE: 11.87%
2025-05-23 12:32:42,246 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 12:32:42,246 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4966
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_7day_trend: 0.1473
2025-05-23 12:32:42,247 - train_models - INFO -   Relative_Quantity: 0.0988
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 12:32:42,247 - train_models - INFO -   NoOfMan_1day_trend: 0.0545
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_lag_7: 0.0314
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 12:32:42,248 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0126
2025-05-23 12:32:42,249 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-23 12:32:42,249 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0099
2025-05-23 12:32:42,249 - train_models - INFO - Cross-validation details for 214:
2025-05-23 12:32:42,249 - train_models - INFO -   Fold 1: MAE=0.5033, RMSE=0.6543, R²=0.8646, MAPE=12.67%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 2: MAE=0.4473, RMSE=0.5739, R²=0.9153, MAPE=11.79%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 3: MAE=0.4149, RMSE=0.5814, R²=0.9150, MAPE=9.05%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 4: MAE=0.6079, RMSE=1.0773, R²=0.8393, MAPE=11.77%
2025-05-23 12:32:42,250 - train_models - INFO -   Fold 5: MAE=0.6960, RMSE=1.0996, R²=0.8584, MAPE=14.05%
2025-05-23 12:32:42,251 - train_models - INFO - Building model for WorkType: 215
2025-05-23 12:32:42,257 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:33:08,020 - train_models - INFO - Model for 215 - MAE: 0.3432, RMSE: 0.6241, R²: 0.9646, MAPE: 6.55%
2025-05-23 12:33:08,021 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 12:33:08,021 - train_models - INFO -   Relative_Quantity: 0.8923
2025-05-23 12:33:08,021 - train_models - INFO -   Quantity_per_Worker: 0.0384
2025-05-23 12:33:08,022 - train_models - INFO -   Hours_per_Quantity: 0.0358
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_7day_trend: 0.0080
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_1day_trend: 0.0050
2025-05-23 12:33:08,022 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 12:33:08,023 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0023
2025-05-23 12:33:08,023 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 12:33:08,023 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 12:33:08,023 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 12:33:08,024 - train_models - INFO - Cross-validation details for 215:
2025-05-23 12:33:08,024 - train_models - INFO -   Fold 1: MAE=0.5066, RMSE=0.7027, R²=0.9608, MAPE=9.90%
2025-05-23 12:33:08,024 - train_models - INFO -   Fold 2: MAE=0.4893, RMSE=0.9036, R²=0.9408, MAPE=8.70%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 3: MAE=0.2384, RMSE=0.3577, R²=0.9796, MAPE=5.46%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 4: MAE=0.2216, RMSE=0.5019, R²=0.9777, MAPE=5.56%
2025-05-23 12:33:08,025 - train_models - INFO -   Fold 5: MAE=0.2600, RMSE=0.6548, R²=0.9639, MAPE=3.10%
2025-05-23 12:33:08,025 - train_models - INFO - Building model for WorkType: 217
2025-05-23 12:33:08,030 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 12:33:26,924 - train_models - INFO - Model for 217 - MAE: 0.4271, RMSE: 0.6031, R²: 0.9066, MAPE: 16.69%
2025-05-23 12:33:26,925 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4326
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_7day_trend: 0.1946
2025-05-23 12:33:26,925 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1805
2025-05-23 12:33:26,926 - train_models - INFO -   NoOfMan_1day_trend: 0.0454
2025-05-23 12:33:26,926 - train_models - INFO -   NoOfMan_lag_7: 0.0393
2025-05-23 12:33:26,926 - train_models - INFO -   Relative_Quantity: 0.0240
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0215
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_lag_1: 0.0185
2025-05-23 12:33:26,927 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0056
2025-05-23 12:33:26,928 - train_models - INFO -   Hours_per_Quantity: 0.0041
2025-05-23 12:33:26,928 - train_models - INFO - Cross-validation details for 217:
2025-05-23 12:33:26,928 - train_models - INFO -   Fold 1: MAE=0.4466, RMSE=0.5979, R²=0.8718, MAPE=21.71%
2025-05-23 12:33:26,928 - train_models - INFO -   Fold 2: MAE=0.4593, RMSE=0.7025, R²=0.9030, MAPE=16.03%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 3: MAE=0.3505, RMSE=0.4627, R²=0.9246, MAPE=14.26%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 4: MAE=0.4744, RMSE=0.6468, R²=0.9208, MAPE=17.33%
2025-05-23 12:33:26,929 - train_models - INFO -   Fold 5: MAE=0.4047, RMSE=0.6057, R²=0.9129, MAPE=14.13%
2025-05-23 12:33:26,930 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 12:33:28,195 - train_models - INFO - Model files saved successfully
2025-05-23 12:33:28,196 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 12:33:28,204 - train_models - INFO - Model training completed successfully
2025-05-23 13:14:48,953 - train_models - INFO - Starting the model training process
2025-05-23 13:14:48,953 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 13:14:48,957 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 13:14:49,140 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 13:14:49,401 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 13:14:49,424 - train_models - INFO - Read chunk of 5446 rows
2025-05-23 13:14:49,442 - train_models - INFO - Data loaded successfully. Total rows: 15446
2025-05-23 13:14:49,444 - train_models - INFO - Converting Date column to datetime format
2025-05-23 13:14:49,455 - train_models - INFO - Engineering features...
2025-05-23 13:14:49,989 - utils.feature_engineering - INFO - Engineering features
2025-05-23 13:14:50,023 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 13:14:50,027 - train_models - INFO - Creating lag features...
2025-05-23 13:14:50,040 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 13:14:50,221 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 13:14:50,221 - utils.feature_engineering - INFO - Final shape: (11791, 72)
2025-05-23 13:14:50,235 - train_models - INFO - Found 10 unique work types
2025-05-23 13:14:50,235 - train_models - INFO - Building models for 10 work types
2025-05-23 13:14:50,235 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 13:14:50,236 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 13:14:50,236 - train_models - INFO - Building model for WorkType: 202
2025-05-23 13:14:50,241 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:05,232 - train_models - INFO - Model for 202 - MAE: 0.1977, RMSE: 0.2839, R²: 0.8705, MAPE: 9.34%
2025-05-23 13:15:05,232 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3690
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_7day_trend: 0.1832
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_1day_trend: 0.1209
2025-05-23 13:15:05,233 - train_models - INFO -   NoOfMan_lag_1: 0.0677
2025-05-23 13:15:05,234 - train_models - INFO -   NoOfMan_lag_7: 0.0613
2025-05-23 13:15:05,234 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0604
2025-05-23 13:15:05,234 - train_models - INFO -   Relative_Quantity: 0.0506
2025-05-23 13:15:05,235 - train_models - INFO -   Hours_per_Quantity: 0.0206
2025-05-23 13:15:05,235 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0197
2025-05-23 13:15:05,235 - train_models - INFO -   Quantity_per_Worker: 0.0118
2025-05-23 13:15:05,235 - train_models - INFO - Cross-validation details for 202:
2025-05-23 13:15:05,235 - train_models - INFO -   Fold 1: MAE=0.1855, RMSE=0.2580, R²=0.8560, MAPE=10.35%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 2: MAE=0.2155, RMSE=0.3453, R²=0.8218, MAPE=10.96%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 3: MAE=0.1878, RMSE=0.2551, R²=0.8841, MAPE=9.54%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 4: MAE=0.1838, RMSE=0.2590, R²=0.8926, MAPE=7.91%
2025-05-23 13:15:05,236 - train_models - INFO -   Fold 5: MAE=0.2159, RMSE=0.3023, R²=0.8981, MAPE=7.96%
2025-05-23 13:15:05,236 - train_models - INFO - Building model for WorkType: 203
2025-05-23 13:15:05,241 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:21,323 - train_models - INFO - Model for 203 - MAE: 0.2630, RMSE: 0.3987, R²: 0.8621, MAPE: 5.44%
2025-05-23 13:15:21,323 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_7day_trend: 0.3409
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1338
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1317
2025-05-23 13:15:21,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1011
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_lag_7: 0.1002
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_1day_trend: 0.0923
2025-05-23 13:15:21,325 - train_models - INFO -   NoOfMan_lag_1: 0.0528
2025-05-23 13:15:21,326 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0059
2025-05-23 13:15:21,326 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 13:15:21,326 - train_models - INFO -   Quantity_same_dow_lag: 0.0028
2025-05-23 13:15:21,327 - train_models - INFO - Cross-validation details for 203:
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 1: MAE=0.3946, RMSE=0.5365, R²=0.7668, MAPE=7.04%
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 2: MAE=0.2779, RMSE=0.5420, R²=0.7853, MAPE=4.77%
2025-05-23 13:15:21,327 - train_models - INFO -   Fold 3: MAE=0.2729, RMSE=0.3885, R²=0.8957, MAPE=5.79%
2025-05-23 13:15:21,328 - train_models - INFO -   Fold 4: MAE=0.1929, RMSE=0.2924, R²=0.9298, MAPE=5.26%
2025-05-23 13:15:21,328 - train_models - INFO -   Fold 5: MAE=0.1770, RMSE=0.2339, R²=0.9327, MAPE=4.32%
2025-05-23 13:15:21,328 - train_models - INFO - Building model for WorkType: 206
2025-05-23 13:15:21,334 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:15:43,096 - train_models - INFO - Model for 206 - MAE: 1.2994, RMSE: 2.1096, R²: 0.9333, MAPE: 10.12%
2025-05-23 13:15:43,097 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 13:15:43,097 - train_models - INFO -   Relative_Quantity: 0.6664
2025-05-23 13:15:43,097 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1334
2025-05-23 13:15:43,097 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0439
2025-05-23 13:15:43,098 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0363
2025-05-23 13:15:43,098 - train_models - INFO -   Hours_per_Quantity: 0.0346
2025-05-23 13:15:43,098 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_1day_trend: 0.0145
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_7day_trend: 0.0076
2025-05-23 13:15:43,099 - train_models - INFO -   NoOfMan_lag_1: 0.0059
2025-05-23 13:15:43,099 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 13:15:43,100 - train_models - INFO - Cross-validation details for 206:
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 1: MAE=1.7889, RMSE=2.3775, R²=0.9243, MAPE=9.09%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 2: MAE=1.3473, RMSE=1.8652, R²=0.9481, MAPE=8.05%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 3: MAE=1.0777, RMSE=2.2633, R²=0.9034, MAPE=5.88%
2025-05-23 13:15:43,100 - train_models - INFO -   Fold 4: MAE=0.9802, RMSE=1.8305, R²=0.9388, MAPE=13.75%
2025-05-23 13:15:43,101 - train_models - INFO -   Fold 5: MAE=1.3032, RMSE=2.2114, R²=0.9519, MAPE=13.84%
2025-05-23 13:15:43,101 - train_models - INFO - Building model for WorkType: 209
2025-05-23 13:15:43,104 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:00,173 - train_models - INFO - Model for 209 - MAE: 0.5549, RMSE: 1.0554, R²: 0.9379, MAPE: 10.18%
2025-05-23 13:16:00,174 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 13:16:00,174 - train_models - INFO -   Relative_Quantity: 0.7431
2025-05-23 13:16:00,174 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1233
2025-05-23 13:16:00,175 - train_models - INFO -   Hours_per_Quantity: 0.0592
2025-05-23 13:16:00,175 - train_models - INFO -   Quantity_per_Worker: 0.0422
2025-05-23 13:16:00,175 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0084
2025-05-23 13:16:00,175 - train_models - INFO -   NoOfMan_7day_trend: 0.0056
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_1day_trend: 0.0016
2025-05-23 13:16:00,176 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 13:16:00,177 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0009
2025-05-23 13:16:00,177 - train_models - INFO - Cross-validation details for 209:
2025-05-23 13:16:00,177 - train_models - INFO -   Fold 1: MAE=0.9383, RMSE=1.9115, R²=0.8369, MAPE=14.99%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 2: MAE=0.4063, RMSE=0.6587, R²=0.9691, MAPE=4.68%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 3: MAE=0.5110, RMSE=1.1485, R²=0.9404, MAPE=6.04%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 4: MAE=0.4859, RMSE=0.7645, R²=0.9638, MAPE=19.76%
2025-05-23 13:16:00,178 - train_models - INFO -   Fold 5: MAE=0.4331, RMSE=0.7938, R²=0.9794, MAPE=5.42%
2025-05-23 13:16:00,179 - train_models - INFO - Building model for WorkType: 210
2025-05-23 13:16:00,185 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:16,965 - train_models - INFO - Model for 210 - MAE: 0.4241, RMSE: 0.8331, R²: 0.9406, MAPE: 7.72%
2025-05-23 13:16:16,965 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 13:16:16,965 - train_models - INFO -   Relative_Quantity: 0.8384
2025-05-23 13:16:16,965 - train_models - INFO -   Quantity_per_Worker: 0.0469
2025-05-23 13:16:16,966 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0447
2025-05-23 13:16:16,966 - train_models - INFO -   Hours_per_Quantity: 0.0432
2025-05-23 13:16:16,966 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0066
2025-05-23 13:16:16,967 - train_models - INFO -   SystemHours_per_Quantity: 0.0035
2025-05-23 13:16:16,967 - train_models - INFO -   NoOfMan_7day_trend: 0.0023
2025-05-23 13:16:16,967 - train_models - INFO -   NoOfMan_1day_trend: 0.0016
2025-05-23 13:16:16,967 - train_models - INFO -   Quantity_1day_trend: 0.0012
2025-05-23 13:16:16,968 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 13:16:16,968 - train_models - INFO - Cross-validation details for 210:
2025-05-23 13:16:16,968 - train_models - INFO -   Fold 1: MAE=0.5938, RMSE=1.2443, R²=0.8813, MAPE=9.27%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 2: MAE=0.3854, RMSE=0.6378, R²=0.9607, MAPE=4.53%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 3: MAE=0.4180, RMSE=0.9146, R²=0.9217, MAPE=6.27%
2025-05-23 13:16:16,969 - train_models - INFO -   Fold 4: MAE=0.3538, RMSE=0.5873, R²=0.9695, MAPE=13.66%
2025-05-23 13:16:16,970 - train_models - INFO -   Fold 5: MAE=0.3693, RMSE=0.7816, R²=0.9696, MAPE=4.87%
2025-05-23 13:16:16,970 - train_models - INFO - Building model for WorkType: 211
2025-05-23 13:16:16,974 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:34,874 - train_models - INFO - Model for 211 - MAE: 0.7178, RMSE: 1.0464, R²: 0.8994, MAPE: 12.04%
2025-05-23 13:16:34,874 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 13:16:34,874 - train_models - INFO -   Relative_Quantity: 0.4506
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1672
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0960
2025-05-23 13:16:34,875 - train_models - INFO -   NoOfMan_1day_trend: 0.0950
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_7day_trend: 0.0725
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_lag_1: 0.0328
2025-05-23 13:16:34,876 - train_models - INFO -   NoOfMan_lag_7: 0.0181
2025-05-23 13:16:34,877 - train_models - INFO -   Quantity_per_Worker: 0.0145
2025-05-23 13:16:34,877 - train_models - INFO -   Hours_per_Quantity: 0.0095
2025-05-23 13:16:34,877 - train_models - INFO -   SystemHours_per_Quantity: 0.0048
2025-05-23 13:16:34,878 - train_models - INFO - Cross-validation details for 211:
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 1: MAE=0.8838, RMSE=1.2866, R²=0.8440, MAPE=11.43%
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 2: MAE=0.8405, RMSE=1.3029, R²=0.8755, MAPE=17.14%
2025-05-23 13:16:34,878 - train_models - INFO -   Fold 3: MAE=0.4933, RMSE=0.6721, R²=0.9450, MAPE=6.11%
2025-05-23 13:16:34,879 - train_models - INFO -   Fold 4: MAE=0.7845, RMSE=1.0227, R²=0.9175, MAPE=14.93%
2025-05-23 13:16:34,879 - train_models - INFO -   Fold 5: MAE=0.5871, RMSE=0.9475, R²=0.9148, MAPE=10.61%
2025-05-23 13:16:34,879 - train_models - INFO - Building model for WorkType: 213
2025-05-23 13:16:34,883 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:16:51,388 - train_models - INFO - Model for 213 - MAE: 0.3675, RMSE: 0.5325, R²: 0.8769, MAPE: 16.21%
2025-05-23 13:16:51,389 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 13:16:51,389 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3547
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_7day_trend: 0.2750
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_1day_trend: 0.1607
2025-05-23 13:16:51,390 - train_models - INFO -   NoOfMan_lag_1: 0.0463
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0369
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0317
2025-05-23 13:16:51,391 - train_models - INFO -   NoOfMan_lag_7: 0.0242
2025-05-23 13:16:51,391 - train_models - INFO -   Relative_Quantity: 0.0200
2025-05-23 13:16:51,392 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0104
2025-05-23 13:16:51,392 - train_models - INFO -   NoOfMan_lag_3: 0.0038
2025-05-23 13:16:51,392 - train_models - INFO - Cross-validation details for 213:
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 1: MAE=0.4250, RMSE=0.5292, R²=0.7889, MAPE=26.05%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 2: MAE=0.4299, RMSE=0.6618, R²=0.8569, MAPE=17.64%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 3: MAE=0.3678, RMSE=0.5298, R²=0.9099, MAPE=15.02%
2025-05-23 13:16:51,393 - train_models - INFO -   Fold 4: MAE=0.2977, RMSE=0.4962, R²=0.9068, MAPE=11.90%
2025-05-23 13:16:51,394 - train_models - INFO -   Fold 5: MAE=0.3172, RMSE=0.4455, R²=0.9217, MAPE=10.44%
2025-05-23 13:16:51,394 - train_models - INFO - Building model for WorkType: 214
2025-05-23 13:16:51,399 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:07,505 - train_models - INFO - Model for 214 - MAE: 0.5344, RMSE: 0.7974, R²: 0.8784, MAPE: 11.89%
2025-05-23 13:17:07,505 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 13:17:07,506 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4964
2025-05-23 13:17:07,506 - train_models - INFO -   NoOfMan_7day_trend: 0.1472
2025-05-23 13:17:07,506 - train_models - INFO -   Relative_Quantity: 0.0990
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_1day_trend: 0.0543
2025-05-23 13:17:07,507 - train_models - INFO -   NoOfMan_lag_7: 0.0314
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0127
2025-05-23 13:17:07,508 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0106
2025-05-23 13:17:07,509 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0099
2025-05-23 13:17:07,509 - train_models - INFO - Cross-validation details for 214:
2025-05-23 13:17:07,509 - train_models - INFO -   Fold 1: MAE=0.5054, RMSE=0.6559, R²=0.8640, MAPE=12.72%
2025-05-23 13:17:07,509 - train_models - INFO -   Fold 2: MAE=0.4475, RMSE=0.5747, R²=0.9151, MAPE=11.79%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 3: MAE=0.4140, RMSE=0.5817, R²=0.9149, MAPE=9.02%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 4: MAE=0.6097, RMSE=1.0811, R²=0.8381, MAPE=11.78%
2025-05-23 13:17:07,510 - train_models - INFO -   Fold 5: MAE=0.6953, RMSE=1.0937, R²=0.8599, MAPE=14.13%
2025-05-23 13:17:07,510 - train_models - INFO - Building model for WorkType: 215
2025-05-23 13:17:07,517 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:26,086 - train_models - INFO - Model for 215 - MAE: 0.3448, RMSE: 0.6265, R²: 0.9643, MAPE: 6.55%
2025-05-23 13:17:26,086 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 13:17:26,087 - train_models - INFO -   Relative_Quantity: 0.8929
2025-05-23 13:17:26,087 - train_models - INFO -   Hours_per_Quantity: 0.0379
2025-05-23 13:17:26,087 - train_models - INFO -   Quantity_per_Worker: 0.0363
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_7day_trend: 0.0083
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_1day_trend: 0.0047
2025-05-23 13:17:26,088 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 13:17:26,089 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 13:17:26,089 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0020
2025-05-23 13:17:26,089 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:17:26,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 13:17:26,090 - train_models - INFO - Cross-validation details for 215:
2025-05-23 13:17:26,090 - train_models - INFO -   Fold 1: MAE=0.5154, RMSE=0.7192, R²=0.9589, MAPE=9.96%
2025-05-23 13:17:26,090 - train_models - INFO -   Fold 2: MAE=0.4888, RMSE=0.8972, R²=0.9417, MAPE=8.69%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 3: MAE=0.2384, RMSE=0.3591, R²=0.9794, MAPE=5.44%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 4: MAE=0.2224, RMSE=0.5013, R²=0.9777, MAPE=5.59%
2025-05-23 13:17:26,091 - train_models - INFO -   Fold 5: MAE=0.2589, RMSE=0.6557, R²=0.9638, MAPE=3.09%
2025-05-23 13:17:26,091 - train_models - INFO - Building model for WorkType: 217
2025-05-23 13:17:26,096 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:17:40,258 - train_models - INFO - Model for 217 - MAE: 0.4264, RMSE: 0.6024, R²: 0.9068, MAPE: 16.67%
2025-05-23 13:17:40,258 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4326
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_7day_trend: 0.1947
2025-05-23 13:17:40,259 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1805
2025-05-23 13:17:40,260 - train_models - INFO -   NoOfMan_1day_trend: 0.0452
2025-05-23 13:17:40,260 - train_models - INFO -   NoOfMan_lag_7: 0.0394
2025-05-23 13:17:40,260 - train_models - INFO -   Relative_Quantity: 0.0238
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0214
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_lag_1: 0.0185
2025-05-23 13:17:40,261 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0056
2025-05-23 13:17:40,261 - train_models - INFO -   Hours_per_Quantity: 0.0038
2025-05-23 13:17:40,262 - train_models - INFO - Cross-validation details for 217:
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 1: MAE=0.4444, RMSE=0.5968, R²=0.8722, MAPE=21.63%
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 2: MAE=0.4580, RMSE=0.7031, R²=0.9028, MAPE=15.97%
2025-05-23 13:17:40,262 - train_models - INFO -   Fold 3: MAE=0.3531, RMSE=0.4637, R²=0.9242, MAPE=14.35%
2025-05-23 13:17:40,263 - train_models - INFO -   Fold 4: MAE=0.4731, RMSE=0.6472, R²=0.9207, MAPE=17.27%
2025-05-23 13:17:40,263 - train_models - INFO -   Fold 5: MAE=0.4034, RMSE=0.6013, R²=0.9142, MAPE=14.12%
2025-05-23 13:17:40,263 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 13:17:40,928 - train_models - INFO - Model files saved successfully
2025-05-23 13:17:40,928 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 13:17:40,931 - train_models - INFO - Model training completed successfully
2025-05-23 13:21:32,001 - train_models - INFO - Starting the model training process
2025-05-23 13:21:32,001 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 13:21:32,007 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 13:21:32,138 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 13:21:32,767 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 13:21:32,844 - train_models - INFO - Read chunk of 5415 rows
2025-05-23 13:21:32,863 - train_models - INFO - Data loaded successfully. Total rows: 15415
2025-05-23 13:21:32,866 - train_models - INFO - Converting Date column to datetime format
2025-05-23 13:21:32,880 - train_models - INFO - Engineering features...
2025-05-23 13:21:33,445 - utils.feature_engineering - INFO - Engineering features
2025-05-23 13:21:33,479 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 13:21:33,484 - train_models - INFO - Creating lag features...
2025-05-23 13:21:33,495 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 13:21:33,697 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 13:21:33,698 - utils.feature_engineering - INFO - Final shape: (11760, 72)
2025-05-23 13:21:33,710 - train_models - INFO - Found 10 unique work types
2025-05-23 13:21:33,711 - train_models - INFO - Building models for 10 work types
2025-05-23 13:21:33,711 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 13:21:33,711 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 13:21:33,711 - train_models - INFO - Building model for WorkType: 202
2025-05-23 13:21:33,719 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:21:50,598 - train_models - INFO - Model for 202 - MAE: 0.1993, RMSE: 0.2857, R²: 0.8696, MAPE: 9.40%
2025-05-23 13:21:50,598 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3747
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_7day_trend: 0.1880
2025-05-23 13:21:50,599 - train_models - INFO -   NoOfMan_1day_trend: 0.1214
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_lag_1: 0.0665
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_lag_7: 0.0622
2025-05-23 13:21:50,600 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0608
2025-05-23 13:21:50,600 - train_models - INFO -   Relative_Quantity: 0.0431
2025-05-23 13:21:50,601 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0200
2025-05-23 13:21:50,601 - train_models - INFO -   Hours_per_Quantity: 0.0169
2025-05-23 13:21:50,601 - train_models - INFO -   Quantity_per_Worker: 0.0108
2025-05-23 13:21:50,601 - train_models - INFO - Cross-validation details for 202:
2025-05-23 13:21:50,602 - train_models - INFO -   Fold 1: MAE=0.1869, RMSE=0.2576, R²=0.8571, MAPE=10.38%
2025-05-23 13:21:50,602 - train_models - INFO -   Fold 2: MAE=0.2177, RMSE=0.3482, R²=0.8197, MAPE=11.06%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 3: MAE=0.1883, RMSE=0.2557, R²=0.8838, MAPE=9.58%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 4: MAE=0.1829, RMSE=0.2580, R²=0.8935, MAPE=7.87%
2025-05-23 13:21:50,603 - train_models - INFO -   Fold 5: MAE=0.2205, RMSE=0.3090, R²=0.8940, MAPE=8.13%
2025-05-23 13:21:50,603 - train_models - INFO - Building model for WorkType: 203
2025-05-23 13:21:50,610 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:08,059 - train_models - INFO - Model for 203 - MAE: 0.2650, RMSE: 0.3940, R²: 0.8627, MAPE: 5.49%
2025-05-23 13:22:08,060 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_7day_trend: 0.3391
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1380
2025-05-23 13:22:08,060 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1298
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_lag_7: 0.1010
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0977
2025-05-23 13:22:08,061 - train_models - INFO -   NoOfMan_1day_trend: 0.0934
2025-05-23 13:22:08,062 - train_models - INFO -   NoOfMan_lag_1: 0.0533
2025-05-23 13:22:08,062 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0062
2025-05-23 13:22:08,062 - train_models - INFO -   Quantity_rolling_mean_7: 0.0029
2025-05-23 13:22:08,063 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0029
2025-05-23 13:22:08,063 - train_models - INFO - Cross-validation details for 203:
2025-05-23 13:22:08,063 - train_models - INFO -   Fold 1: MAE=0.3900, RMSE=0.5075, R²=0.7476, MAPE=7.24%
2025-05-23 13:22:08,063 - train_models - INFO -   Fold 2: MAE=0.2891, RMSE=0.5457, R²=0.8106, MAPE=4.89%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 3: MAE=0.2755, RMSE=0.3950, R²=0.8922, MAPE=5.85%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2932, R²=0.9298, MAPE=5.29%
2025-05-23 13:22:08,064 - train_models - INFO -   Fold 5: MAE=0.1735, RMSE=0.2286, R²=0.9335, MAPE=4.19%
2025-05-23 13:22:08,064 - train_models - INFO - Building model for WorkType: 206
2025-05-23 13:22:08,073 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:33,219 - train_models - INFO - Model for 206 - MAE: 1.2967, RMSE: 2.1084, R²: 0.9333, MAPE: 10.10%
2025-05-23 13:22:33,219 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 13:22:33,220 - train_models - INFO -   Relative_Quantity: 0.6755
2025-05-23 13:22:33,220 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1293
2025-05-23 13:22:33,220 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0417
2025-05-23 13:22:33,221 - train_models - INFO -   Hours_per_Quantity: 0.0373
2025-05-23 13:22:33,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0357
2025-05-23 13:22:33,221 - train_models - INFO -   Quantity_per_Worker: 0.0278
2025-05-23 13:22:33,221 - train_models - INFO -   NoOfMan_1day_trend: 0.0132
2025-05-23 13:22:33,222 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-23 13:22:33,222 - train_models - INFO -   NoOfMan_lag_1: 0.0058
2025-05-23 13:22:33,222 - train_models - INFO -   Quantity_same_dow_lag: 0.0038
2025-05-23 13:22:33,222 - train_models - INFO - Cross-validation details for 206:
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 1: MAE=1.7984, RMSE=2.3954, R²=0.9234, MAPE=9.14%
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 2: MAE=1.3517, RMSE=1.8689, R²=0.9475, MAPE=8.06%
2025-05-23 13:22:33,223 - train_models - INFO -   Fold 3: MAE=1.0769, RMSE=2.2594, R²=0.9043, MAPE=5.86%
2025-05-23 13:22:33,224 - train_models - INFO -   Fold 4: MAE=0.9777, RMSE=1.8351, R²=0.9385, MAPE=13.85%
2025-05-23 13:22:33,224 - train_models - INFO -   Fold 5: MAE=1.2791, RMSE=2.1831, R²=0.9527, MAPE=13.58%
2025-05-23 13:22:33,224 - train_models - INFO - Building model for WorkType: 209
2025-05-23 13:22:33,231 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:22:52,072 - train_models - INFO - Model for 209 - MAE: 0.5550, RMSE: 1.0555, R²: 0.9378, MAPE: 10.13%
2025-05-23 13:22:52,073 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 13:22:52,073 - train_models - INFO -   Relative_Quantity: 0.7444
2025-05-23 13:22:52,073 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1241
2025-05-23 13:22:52,073 - train_models - INFO -   Hours_per_Quantity: 0.0555
2025-05-23 13:22:52,074 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 13:22:52,074 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0070
2025-05-23 13:22:52,074 - train_models - INFO -   NoOfMan_7day_trend: 0.0054
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0021
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-23 13:22:52,075 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 13:22:52,076 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0009
2025-05-23 13:22:52,076 - train_models - INFO - Cross-validation details for 209:
2025-05-23 13:22:52,076 - train_models - INFO -   Fold 1: MAE=0.9492, RMSE=1.9176, R²=0.8366, MAPE=15.08%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 2: MAE=0.4109, RMSE=0.6708, R²=0.9681, MAPE=4.74%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 3: MAE=0.5127, RMSE=1.1513, R²=0.9404, MAPE=6.06%
2025-05-23 13:22:52,077 - train_models - INFO -   Fold 4: MAE=0.4839, RMSE=0.7640, R²=0.9636, MAPE=19.71%
2025-05-23 13:22:52,078 - train_models - INFO -   Fold 5: MAE=0.4182, RMSE=0.7740, R²=0.9803, MAPE=5.07%
2025-05-23 13:22:52,078 - train_models - INFO - Building model for WorkType: 210
2025-05-23 13:22:52,083 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:09,285 - train_models - INFO - Model for 210 - MAE: 0.4171, RMSE: 0.8260, R²: 0.9413, MAPE: 7.63%
2025-05-23 13:23:09,285 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 13:23:09,285 - train_models - INFO -   Relative_Quantity: 0.8393
2025-05-23 13:23:09,286 - train_models - INFO -   Quantity_per_Worker: 0.0453
2025-05-23 13:23:09,286 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0442
2025-05-23 13:23:09,286 - train_models - INFO -   Hours_per_Quantity: 0.0437
2025-05-23 13:23:09,286 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0071
2025-05-23 13:23:09,287 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_7day_trend: 0.0022
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_1day_trend: 0.0019
2025-05-23 13:23:09,287 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 13:23:09,288 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:23:09,288 - train_models - INFO - Cross-validation details for 210:
2025-05-23 13:23:09,288 - train_models - INFO -   Fold 1: MAE=0.5855, RMSE=1.2373, R²=0.8826, MAPE=9.19%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 2: MAE=0.3836, RMSE=0.6265, R²=0.9623, MAPE=4.51%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 3: MAE=0.4190, RMSE=0.9168, R²=0.9217, MAPE=6.29%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 4: MAE=0.3464, RMSE=0.5809, R²=0.9692, MAPE=13.54%
2025-05-23 13:23:09,289 - train_models - INFO -   Fold 5: MAE=0.3508, RMSE=0.7682, R²=0.9708, MAPE=4.58%
2025-05-23 13:23:09,290 - train_models - INFO - Building model for WorkType: 211
2025-05-23 13:23:09,294 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:28,425 - train_models - INFO - Model for 211 - MAE: 0.7176, RMSE: 1.0143, R²: 0.9031, MAPE: 11.35%
2025-05-23 13:23:28,425 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 13:23:28,426 - train_models - INFO -   Relative_Quantity: 0.4612
2025-05-23 13:23:28,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1697
2025-05-23 13:23:28,426 - train_models - INFO -   NoOfMan_1day_trend: 0.0960
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_7day_trend: 0.0692
2025-05-23 13:23:28,427 - train_models - INFO -   NoOfMan_lag_1: 0.0335
2025-05-23 13:23:28,428 - train_models - INFO -   NoOfMan_lag_7: 0.0200
2025-05-23 13:23:28,428 - train_models - INFO -   Quantity_per_Worker: 0.0118
2025-05-23 13:23:28,428 - train_models - INFO -   Hours_per_Quantity: 0.0086
2025-05-23 13:23:28,428 - train_models - INFO -   SystemHours_per_Quantity: 0.0055
2025-05-23 13:23:28,429 - train_models - INFO - Cross-validation details for 211:
2025-05-23 13:23:28,429 - train_models - INFO -   Fold 1: MAE=0.9249, RMSE=1.3235, R²=0.8351, MAPE=12.10%
2025-05-23 13:23:28,429 - train_models - INFO -   Fold 2: MAE=0.8533, RMSE=1.2989, R²=0.8758, MAPE=17.30%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 3: MAE=0.4937, RMSE=0.6742, R²=0.9420, MAPE=6.02%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 4: MAE=0.7644, RMSE=0.9941, R²=0.9240, MAPE=14.82%
2025-05-23 13:23:28,430 - train_models - INFO -   Fold 5: MAE=0.5516, RMSE=0.7807, R²=0.9383, MAPE=6.48%
2025-05-23 13:23:28,430 - train_models - INFO - Building model for WorkType: 213
2025-05-23 13:23:28,435 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:23:47,204 - train_models - INFO - Model for 213 - MAE: 0.3677, RMSE: 0.5374, R²: 0.8751, MAPE: 16.19%
2025-05-23 13:23:47,205 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 13:23:47,205 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3548
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_7day_trend: 0.2735
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_1day_trend: 0.1613
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_lag_1: 0.0465
2025-05-23 13:23:47,206 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-23 13:23:47,207 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0315
2025-05-23 13:23:47,207 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 13:23:47,207 - train_models - INFO -   Relative_Quantity: 0.0213
2025-05-23 13:23:47,208 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0105
2025-05-23 13:23:47,208 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 13:23:47,208 - train_models - INFO - Cross-validation details for 213:
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 1: MAE=0.4347, RMSE=0.5431, R²=0.7894, MAPE=26.26%
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 2: MAE=0.4301, RMSE=0.6761, R²=0.8501, MAPE=17.57%
2025-05-23 13:23:47,209 - train_models - INFO -   Fold 3: MAE=0.3695, RMSE=0.5361, R²=0.9078, MAPE=15.00%
2025-05-23 13:23:47,210 - train_models - INFO -   Fold 4: MAE=0.2914, RMSE=0.4899, R²=0.9031, MAPE=12.08%
2025-05-23 13:23:47,210 - train_models - INFO -   Fold 5: MAE=0.3126, RMSE=0.4417, R²=0.9248, MAPE=10.06%
2025-05-23 13:23:47,210 - train_models - INFO - Building model for WorkType: 214
2025-05-23 13:23:47,214 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:04,010 - train_models - INFO - Model for 214 - MAE: 0.5344, RMSE: 0.7970, R²: 0.8782, MAPE: 11.87%
2025-05-23 13:24:04,011 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 13:24:04,011 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4965
2025-05-23 13:24:04,011 - train_models - INFO -   NoOfMan_7day_trend: 0.1460
2025-05-23 13:24:04,011 - train_models - INFO -   Relative_Quantity: 0.0987
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0625
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_1day_trend: 0.0540
2025-05-23 13:24:04,012 - train_models - INFO -   NoOfMan_lag_7: 0.0308
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_lag_1: 0.0205
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0119
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0107
2025-05-23 13:24:04,013 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 13:24:04,013 - train_models - INFO - Cross-validation details for 214:
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 1: MAE=0.5190, RMSE=0.6742, R²=0.8606, MAPE=12.99%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 2: MAE=0.4409, RMSE=0.5715, R²=0.9130, MAPE=11.24%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 3: MAE=0.4107, RMSE=0.5799, R²=0.9136, MAPE=9.39%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 4: MAE=0.6140, RMSE=1.0686, R²=0.8436, MAPE=11.84%
2025-05-23 13:24:04,014 - train_models - INFO -   Fold 5: MAE=0.6876, RMSE=1.0905, R²=0.8601, MAPE=13.91%
2025-05-23 13:24:04,015 - train_models - INFO - Building model for WorkType: 215
2025-05-23 13:24:04,019 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:23,387 - train_models - INFO - Model for 215 - MAE: 0.3470, RMSE: 0.6295, R²: 0.9639, MAPE: 6.57%
2025-05-23 13:24:23,388 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 13:24:23,388 - train_models - INFO -   Relative_Quantity: 0.8927
2025-05-23 13:24:23,388 - train_models - INFO -   Quantity_per_Worker: 0.0375
2025-05-23 13:24:23,388 - train_models - INFO -   Hours_per_Quantity: 0.0364
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_7day_trend: 0.0080
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 13:24:23,389 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0040
2025-05-23 13:24:23,390 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0021
2025-05-23 13:24:23,390 - train_models - INFO -   SystemHours_per_Quantity: 0.0021
2025-05-23 13:24:23,390 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 13:24:23,391 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 13:24:23,391 - train_models - INFO - Cross-validation details for 215:
2025-05-23 13:24:23,391 - train_models - INFO -   Fold 1: MAE=0.5133, RMSE=0.7212, R²=0.9585, MAPE=9.80%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 2: MAE=0.4888, RMSE=0.9011, R²=0.9406, MAPE=8.54%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 3: MAE=0.2453, RMSE=0.3630, R²=0.9790, MAPE=5.70%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 4: MAE=0.2240, RMSE=0.5064, R²=0.9776, MAPE=5.66%
2025-05-23 13:24:23,392 - train_models - INFO -   Fold 5: MAE=0.2635, RMSE=0.6557, R²=0.9639, MAPE=3.17%
2025-05-23 13:24:23,392 - train_models - INFO - Building model for WorkType: 217
2025-05-23 13:24:23,396 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 13:24:38,135 - train_models - INFO - Model for 217 - MAE: 0.4289, RMSE: 0.6073, R²: 0.9037, MAPE: 16.80%
2025-05-23 13:24:38,135 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4308
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_7day_trend: 0.1907
2025-05-23 13:24:38,136 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1826
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_lag_7: 0.0387
2025-05-23 13:24:38,137 - train_models - INFO -   Relative_Quantity: 0.0233
2025-05-23 13:24:38,137 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0218
2025-05-23 13:24:38,138 - train_models - INFO -   NoOfMan_lag_1: 0.0209
2025-05-23 13:24:38,138 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0057
2025-05-23 13:24:38,138 - train_models - INFO -   Hours_per_Quantity: 0.0039
2025-05-23 13:24:38,138 - train_models - INFO - Cross-validation details for 217:
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 1: MAE=0.4579, RMSE=0.6158, R²=0.8581, MAPE=22.17%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 2: MAE=0.4597, RMSE=0.7088, R²=0.9015, MAPE=15.98%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 3: MAE=0.3524, RMSE=0.4637, R²=0.9240, MAPE=14.16%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 4: MAE=0.4689, RMSE=0.6377, R²=0.9234, MAPE=17.50%
2025-05-23 13:24:38,139 - train_models - INFO -   Fold 5: MAE=0.4057, RMSE=0.6107, R²=0.9114, MAPE=14.18%
2025-05-23 13:24:38,140 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 13:24:38,955 - train_models - INFO - Model files saved successfully
2025-05-23 13:24:38,955 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 13:24:38,960 - train_models - INFO - Model training completed successfully
2025-05-23 14:32:17,253 - train_models - INFO - Starting the model training process
2025-05-23 14:32:17,253 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:32:17,258 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:32:17,385 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:32:18,005 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:32:18,068 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:32:18,085 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:32:18,086 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:32:18,098 - train_models - INFO - Engineering features...
2025-05-23 14:32:18,597 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:32:18,627 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:32:18,632 - train_models - INFO - Creating lag features...
2025-05-23 14:32:18,642 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:32:18,820 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:32:18,820 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:32:18,831 - train_models - INFO - Found 10 unique work types
2025-05-23 14:32:18,832 - train_models - INFO - Building models for 10 work types
2025-05-23 14:32:18,832 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:32:18,832 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:32:18,833 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:32:18,836 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:32:34,769 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-23 14:32:34,769 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:32:34,769 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 14:32:34,770 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 14:32:34,771 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 14:32:34,771 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 14:32:34,772 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-23 14:32:34,772 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-23 14:32:34,772 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:32:34,772 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-23 14:32:34,773 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-23 14:32:34,774 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-23 14:32:34,774 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:32:34,777 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:32:51,937 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-23 14:32:51,938 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:32:51,938 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 14:32:51,938 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 14:32:51,939 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-23 14:32:51,940 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 14:32:51,941 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 14:32:51,941 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:32:51,941 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-23 14:32:51,942 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-23 14:32:51,942 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:32:51,947 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:14,741 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-23 14:33:14,742 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:33:14,742 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 14:33:14,742 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 14:33:14,742 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-23 14:33:14,743 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-23 14:33:14,743 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 14:33:14,743 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 14:33:14,743 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 14:33:14,744 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 14:33:14,744 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 14:33:14,744 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 14:33:14,744 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-23 14:33:14,745 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-23 14:33:14,746 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-23 14:33:14,746 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-23 14:33:14,746 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:33:14,750 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:32,430 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 14:33:32,430 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:33:32,430 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 14:33:32,431 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 14:33:32,431 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 14:33:32,431 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 14:33:32,432 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 14:33:32,433 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 14:33:32,433 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 14:33:32,433 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 14:33:32,433 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 14:33:32,434 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 14:33:32,435 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 14:33:32,435 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:33:32,445 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:33:49,842 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 14:33:49,842 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:33:49,842 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 14:33:49,843 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 14:33:49,843 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 14:33:49,843 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 14:33:49,844 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 14:33:49,844 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 14:33:49,844 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 14:33:49,845 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 14:33:49,845 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 14:33:49,845 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 14:33:49,845 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 14:33:49,846 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 14:33:49,847 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 14:33:49,847 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:33:49,854 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:08,708 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-23 14:34:08,709 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:34:08,709 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 14:34:08,709 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-23 14:34:08,710 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-23 14:34:08,711 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 14:34:08,711 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 14:34:08,711 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-23 14:34:08,711 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-23 14:34:08,712 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 14:34:08,712 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:34:08,712 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-23 14:34:08,712 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-23 14:34:08,713 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-23 14:34:08,714 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:34:08,719 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:26,245 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-23 14:34:26,245 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-23 14:34:26,246 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 14:34:26,247 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 14:34:26,248 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-23 14:34:26,248 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-23 14:34:26,248 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 14:34:26,249 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-23 14:34:26,249 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-23 14:34:26,250 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-23 14:34:26,250 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-23 14:34:26,250 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:34:26,256 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:34:42,957 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-23 14:34:42,957 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:34:42,957 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 14:34:42,958 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-23 14:34:42,958 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-23 14:34:42,959 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-23 14:34:42,960 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 14:34:42,960 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 14:34:42,960 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:34:42,960 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-23 14:34:42,961 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-23 14:34:42,961 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:34:42,965 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:35:02,904 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-23 14:35:02,904 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:35:02,904 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-23 14:35:02,905 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-23 14:35:02,905 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-23 14:35:02,905 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 14:35:02,905 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 14:35:02,906 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 14:35:02,906 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-23 14:35:02,906 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 14:35:02,907 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 14:35:02,907 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 14:35:02,907 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-23 14:35:02,908 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-23 14:35:02,909 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-23 14:35:02,909 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:35:02,915 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:35:17,687 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-23 14:35:17,688 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:35:17,688 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 14:35:17,688 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-23 14:35:17,689 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 14:35:17,689 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 14:35:17,690 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 14:35:17,691 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 14:35:17,691 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:35:17,691 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-23 14:35:17,691 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-23 14:35:17,692 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-23 14:35:17,693 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:35:18,366 - train_models - INFO - Model files saved successfully
2025-05-23 14:35:18,366 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:35:18,369 - train_models - INFO - Model training completed successfully
2025-05-23 14:43:26,700 - train_models - INFO - Starting the model training process
2025-05-23 14:43:26,700 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:43:26,703 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:43:26,822 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:43:27,460 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:43:27,536 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:43:27,554 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:43:27,557 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:43:27,580 - train_models - INFO - Engineering features...
2025-05-23 14:43:28,036 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:43:28,069 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:43:28,074 - train_models - INFO - Creating lag features...
2025-05-23 14:43:28,084 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:43:28,259 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:43:28,260 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:43:28,270 - train_models - INFO - Found 10 unique work types
2025-05-23 14:43:28,271 - train_models - INFO - Building models for 10 work types
2025-05-23 14:43:28,271 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:43:28,271 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:43:28,272 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:43:28,278 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:43:44,346 - train_models - INFO - Model for 202 - MAE: 0.1969, RMSE: 0.2838, R²: 0.8722, MAPE: 9.31%
2025-05-23 14:43:44,346 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:43:44,346 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_1day_trend: 0.1203
2025-05-23 14:43:44,347 - train_models - INFO -   NoOfMan_lag_7: 0.0695
2025-05-23 14:43:44,348 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 14:43:44,348 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-23 14:43:44,348 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 14:43:44,349 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0186
2025-05-23 14:43:44,349 - train_models - INFO -   Hours_per_Quantity: 0.0168
2025-05-23 14:43:44,349 - train_models - INFO -   Quantity_per_Worker: 0.0084
2025-05-23 14:43:44,350 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 1: MAE=0.1846, RMSE=0.2573, R²=0.8575, MAPE=10.27%
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 2: MAE=0.2148, RMSE=0.3455, R²=0.8238, MAPE=10.79%
2025-05-23 14:43:44,350 - train_models - INFO -   Fold 3: MAE=0.1844, RMSE=0.2488, R²=0.8882, MAPE=9.41%
2025-05-23 14:43:44,351 - train_models - INFO -   Fold 4: MAE=0.1732, RMSE=0.2520, R²=0.8970, MAPE=7.24%
2025-05-23 14:43:44,351 - train_models - INFO -   Fold 5: MAE=0.2276, RMSE=0.3154, R²=0.8945, MAPE=8.84%
2025-05-23 14:43:44,351 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:43:44,358 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:01,274 - train_models - INFO - Model for 203 - MAE: 0.2661, RMSE: 0.4015, R²: 0.8608, MAPE: 5.50%
2025-05-23 14:44:01,274 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1330
2025-05-23 14:44:01,275 - train_models - INFO -   NoOfMan_lag_7: 0.1006
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_1day_trend: 0.0913
2025-05-23 14:44:01,276 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 14:44:01,277 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0028
2025-05-23 14:44:01,278 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 1: MAE=0.3983, RMSE=0.5321, R²=0.7557, MAPE=7.22%
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 2: MAE=0.2761, RMSE=0.5436, R²=0.7943, MAPE=4.72%
2025-05-23 14:44:01,278 - train_models - INFO -   Fold 3: MAE=0.2725, RMSE=0.3877, R²=0.8972, MAPE=5.77%
2025-05-23 14:44:01,279 - train_models - INFO -   Fold 4: MAE=0.1955, RMSE=0.2962, R²=0.9258, MAPE=5.33%
2025-05-23 14:44:01,279 - train_models - INFO -   Fold 5: MAE=0.1880, RMSE=0.2477, R²=0.9312, MAPE=4.44%
2025-05-23 14:44:01,279 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:44:01,284 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:23,663 - train_models - INFO - Model for 206 - MAE: 1.2960, RMSE: 2.1104, R²: 0.9329, MAPE: 10.16%
2025-05-23 14:44:23,663 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:44:23,664 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 14:44:23,664 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1310
2025-05-23 14:44:23,664 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0405
2025-05-23 14:44:23,665 - train_models - INFO -   Hours_per_Quantity: 0.0366
2025-05-23 14:44:23,665 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 14:44:23,665 - train_models - INFO -   Quantity_per_Worker: 0.0300
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_1day_trend: 0.0121
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_7day_trend: 0.0069
2025-05-23 14:44:23,666 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 14:44:23,667 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 14:44:23,667 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:44:23,667 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3615, R²=0.9255, MAPE=9.12%
2025-05-23 14:44:23,667 - train_models - INFO -   Fold 2: MAE=1.3791, RMSE=1.8956, R²=0.9456, MAPE=8.19%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 3: MAE=1.0668, RMSE=2.2623, R²=0.9045, MAPE=5.83%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 4: MAE=0.9879, RMSE=1.8814, R²=0.9349, MAPE=14.19%
2025-05-23 14:44:23,668 - train_models - INFO -   Fold 5: MAE=1.2643, RMSE=2.1510, R²=0.9539, MAPE=13.45%
2025-05-23 14:44:23,668 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:44:23,673 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:41,071 - train_models - INFO - Model for 209 - MAE: 0.5533, RMSE: 1.0455, R²: 0.9383, MAPE: 10.19%
2025-05-23 14:44:41,071 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:44:41,072 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 14:44:41,072 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 14:44:41,072 - train_models - INFO -   Hours_per_Quantity: 0.0539
2025-05-23 14:44:41,073 - train_models - INFO -   Quantity_per_Worker: 0.0467
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0075
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_7day_trend: 0.0058
2025-05-23 14:44:41,073 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0021
2025-05-23 14:44:41,074 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 14:44:41,074 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 14:44:41,074 - train_models - INFO -   Quantity_same_dow_lag: 0.0009
2025-05-23 14:44:41,074 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 1: MAE=0.9734, RMSE=1.9430, R²=0.8316, MAPE=15.34%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 2: MAE=0.3886, RMSE=0.6162, R²=0.9729, MAPE=4.52%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 3: MAE=0.5222, RMSE=1.1530, R²=0.9403, MAPE=6.22%
2025-05-23 14:44:41,075 - train_models - INFO -   Fold 4: MAE=0.4632, RMSE=0.7323, R²=0.9668, MAPE=19.79%
2025-05-23 14:44:41,076 - train_models - INFO -   Fold 5: MAE=0.4193, RMSE=0.7831, R²=0.9797, MAPE=5.06%
2025-05-23 14:44:41,076 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:44:41,081 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:44:58,329 - train_models - INFO - Model for 210 - MAE: 0.4230, RMSE: 0.8372, R²: 0.9404, MAPE: 7.63%
2025-05-23 14:44:58,329 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:44:58,329 - train_models - INFO -   Relative_Quantity: 0.8401
2025-05-23 14:44:58,330 - train_models - INFO -   Quantity_per_Worker: 0.0460
2025-05-23 14:44:58,330 - train_models - INFO -   Hours_per_Quantity: 0.0440
2025-05-23 14:44:58,330 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0419
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 14:44:58,331 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_1day_trend: 0.0020
2025-05-23 14:44:58,331 - train_models - INFO -   NoOfMan_7day_trend: 0.0019
2025-05-23 14:44:58,332 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0012
2025-05-23 14:44:58,332 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 14:44:58,332 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 1: MAE=0.5899, RMSE=1.2384, R²=0.8841, MAPE=9.04%
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 2: MAE=0.3918, RMSE=0.6339, R²=0.9605, MAPE=4.61%
2025-05-23 14:44:58,333 - train_models - INFO -   Fold 3: MAE=0.4198, RMSE=0.9362, R²=0.9195, MAPE=6.40%
2025-05-23 14:44:58,334 - train_models - INFO -   Fold 4: MAE=0.3575, RMSE=0.5936, R²=0.9683, MAPE=13.50%
2025-05-23 14:44:58,334 - train_models - INFO -   Fold 5: MAE=0.3561, RMSE=0.7836, R²=0.9695, MAPE=4.61%
2025-05-23 14:44:58,334 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:44:58,339 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:17,200 - train_models - INFO - Model for 211 - MAE: 0.7154, RMSE: 1.0140, R²: 0.9028, MAPE: 11.28%
2025-05-23 14:45:17,200 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:45:17,200 - train_models - INFO -   Relative_Quantity: 0.4586
2025-05-23 14:45:17,200 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_1day_trend: 0.0959
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 14:45:17,201 - train_models - INFO -   NoOfMan_7day_trend: 0.0707
2025-05-23 14:45:17,202 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 14:45:17,202 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 14:45:17,202 - train_models - INFO -   Quantity_per_Worker: 0.0121
2025-05-23 14:45:17,202 - train_models - INFO -   Hours_per_Quantity: 0.0081
2025-05-23 14:45:17,203 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 14:45:17,203 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:45:17,203 - train_models - INFO -   Fold 1: MAE=0.9326, RMSE=1.3190, R²=0.8354, MAPE=12.19%
2025-05-23 14:45:17,203 - train_models - INFO -   Fold 2: MAE=0.8391, RMSE=1.2942, R²=0.8765, MAPE=17.04%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 3: MAE=0.4928, RMSE=0.6710, R²=0.9451, MAPE=6.10%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 4: MAE=0.7963, RMSE=1.0367, R²=0.9145, MAPE=15.14%
2025-05-23 14:45:17,204 - train_models - INFO -   Fold 5: MAE=0.5163, RMSE=0.7492, R²=0.9423, MAPE=5.95%
2025-05-23 14:45:17,204 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:45:17,209 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:34,606 - train_models - INFO - Model for 213 - MAE: 0.3653, RMSE: 0.5316, R²: 0.8790, MAPE: 16.03%
2025-05-23 14:45:34,607 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:45:34,607 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3526
2025-05-23 14:45:34,607 - train_models - INFO -   NoOfMan_7day_trend: 0.2757
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0376
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 14:45:34,608 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-23 14:45:34,609 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 14:45:34,609 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0102
2025-05-23 14:45:34,609 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 14:45:34,609 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:45:34,609 - train_models - INFO -   Fold 1: MAE=0.4254, RMSE=0.5297, R²=0.8009, MAPE=25.75%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 2: MAE=0.4236, RMSE=0.6574, R²=0.8581, MAPE=17.39%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 3: MAE=0.3670, RMSE=0.5286, R²=0.9122, MAPE=14.95%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 4: MAE=0.2946, RMSE=0.4955, R²=0.9075, MAPE=11.85%
2025-05-23 14:45:34,610 - train_models - INFO -   Fold 5: MAE=0.3162, RMSE=0.4469, R²=0.9165, MAPE=10.21%
2025-05-23 14:45:34,610 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:45:34,614 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:45:51,995 - train_models - INFO - Model for 214 - MAE: 0.5305, RMSE: 0.7931, R²: 0.8796, MAPE: 11.77%
2025-05-23 14:45:51,996 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:45:51,996 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 14:45:51,996 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 14:45:51,997 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-23 14:45:51,997 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0616
2025-05-23 14:45:51,997 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_lag_7: 0.0322
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0121
2025-05-23 14:45:51,998 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0105
2025-05-23 14:45:51,999 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 14:45:51,999 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:45:51,999 - train_models - INFO -   Fold 1: MAE=0.5114, RMSE=0.6670, R²=0.8616, MAPE=12.88%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 2: MAE=0.4457, RMSE=0.5749, R²=0.9146, MAPE=11.73%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 3: MAE=0.4147, RMSE=0.5815, R²=0.9156, MAPE=9.01%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 4: MAE=0.6179, RMSE=1.0840, R²=0.8396, MAPE=11.86%
2025-05-23 14:45:52,000 - train_models - INFO -   Fold 5: MAE=0.6627, RMSE=1.0583, R²=0.8665, MAPE=13.36%
2025-05-23 14:45:52,001 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:45:52,006 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:46:11,270 - train_models - INFO - Model for 215 - MAE: 0.3442, RMSE: 0.6280, R²: 0.9640, MAPE: 6.51%
2025-05-23 14:46:11,270 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:46:11,270 - train_models - INFO -   Relative_Quantity: 0.8933
2025-05-23 14:46:11,271 - train_models - INFO -   Quantity_per_Worker: 0.0387
2025-05-23 14:46:11,271 - train_models - INFO -   Hours_per_Quantity: 0.0354
2025-05-23 14:46:11,271 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 14:46:11,272 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 14:46:11,272 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0041
2025-05-23 14:46:11,272 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 14:46:11,273 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0021
2025-05-23 14:46:11,273 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 14:46:11,273 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 14:46:11,274 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 1: MAE=0.5155, RMSE=0.7261, R²=0.9580, MAPE=9.88%
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 2: MAE=0.4871, RMSE=0.8993, R²=0.9412, MAPE=8.61%
2025-05-23 14:46:11,274 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3584, R²=0.9795, MAPE=5.42%
2025-05-23 14:46:11,275 - train_models - INFO -   Fold 4: MAE=0.2232, RMSE=0.5097, R²=0.9768, MAPE=5.59%
2025-05-23 14:46:11,275 - train_models - INFO -   Fold 5: MAE=0.2571, RMSE=0.6463, R²=0.9645, MAPE=3.06%
2025-05-23 14:46:11,275 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:46:11,281 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:46:25,634 - train_models - INFO - Model for 217 - MAE: 0.4288, RMSE: 0.6067, R²: 0.9038, MAPE: 16.78%
2025-05-23 14:46:25,634 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:46:25,634 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2294
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_7day_trend: 0.1902
2025-05-23 14:46:25,635 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 14:46:25,636 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 14:46:25,636 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 14:46:25,636 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 14:46:25,637 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 14:46:25,637 - train_models - INFO -   Hours_per_Quantity: 0.0055
2025-05-23 14:46:25,637 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-05-23 14:46:25,637 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 1: MAE=0.4525, RMSE=0.6100, R²=0.8598, MAPE=21.99%
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 2: MAE=0.4695, RMSE=0.7062, R²=0.9018, MAPE=16.38%
2025-05-23 14:46:25,638 - train_models - INFO -   Fold 3: MAE=0.3425, RMSE=0.4583, R²=0.9254, MAPE=13.91%
2025-05-23 14:46:25,639 - train_models - INFO -   Fold 4: MAE=0.4752, RMSE=0.6516, R²=0.9212, MAPE=17.59%
2025-05-23 14:46:25,639 - train_models - INFO -   Fold 5: MAE=0.4044, RMSE=0.6073, R²=0.9107, MAPE=14.00%
2025-05-23 14:46:25,640 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:46:26,298 - train_models - INFO - Model files saved successfully
2025-05-23 14:46:26,298 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:46:26,301 - train_models - INFO - Model training completed successfully
2025-05-23 14:51:12,768 - train_models - INFO - Starting the model training process
2025-05-23 14:51:12,768 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:51:12,772 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:51:12,884 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:51:13,464 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:51:13,542 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:51:13,560 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:51:13,562 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:51:13,575 - train_models - INFO - Engineering features...
2025-05-23 14:51:14,038 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:51:14,074 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:51:14,084 - train_models - INFO - Creating lag features...
2025-05-23 14:51:14,095 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:51:14,322 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:51:14,322 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:51:14,340 - train_models - INFO - Found 10 unique work types
2025-05-23 14:51:14,340 - train_models - INFO - Building models for 10 work types
2025-05-23 14:51:14,340 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:51:14,341 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 14:51:14,341 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:51:14,348 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 14:51:14,354 - train_models - ERROR - Error building models: A given column is not a column of the dataframe
2025-05-23 14:51:14,512 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DayOfWeek_feat'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_indexing.py", line 364, in _get_column_indices
    col_idx = all_columns.get_loc(col)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DayOfWeek_feat'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 199, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 654, in fit
    Xt = self._fit(X, y, routed_params, raw_params=params)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 588, in _fit
    X, fitted_transformer = fit_transform_one_cached(
                            ~~~~~~~~~~~~~~~~~~~~~~~~^
        cloned_transformer,
        ^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        params=step_params,
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\joblib\memory.py", line 312, in __call__
    return self.func(*args, **kwargs)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 1551, in _fit_transform_one
    res = transformer.fit_transform(X, y, **params.get("fit_transform", {}))
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 993, in fit_transform
    self._validate_column_callables(X)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\compose\_column_transformer.py", line 552, in _validate_column_callables
    transformer_to_input_indices[name] = _get_column_indices(X, columns)
                                         ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_indexing.py", line 372, in _get_column_indices
    raise ValueError("A given column is not a column of the dataframe") from e
ValueError: A given column is not a column of the dataframe

2025-05-23 14:51:14,514 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 14:51:14,547 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 14:51:14,656 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 416, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 14:51:14,659 - train_models - INFO - Model training completed successfully
2025-05-23 14:52:06,824 - train_models - INFO - Starting the model training process
2025-05-23 14:52:06,824 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 14:52:06,828 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 14:52:06,944 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 14:52:07,544 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 14:52:07,622 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 14:52:07,639 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 14:52:07,641 - train_models - INFO - Converting Date column to datetime format
2025-05-23 14:52:07,651 - train_models - INFO - Engineering features...
2025-05-23 14:52:08,035 - utils.feature_engineering - INFO - Engineering features
2025-05-23 14:52:08,066 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 14:52:08,074 - train_models - INFO - Creating lag features...
2025-05-23 14:52:08,084 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 14:52:08,285 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 14:52:08,286 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 14:52:08,297 - train_models - INFO - Found 10 unique work types
2025-05-23 14:52:08,298 - train_models - INFO - Building models for 10 work types
2025-05-23 14:52:08,298 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 14:52:08,298 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat']
2025-05-23 14:52:08,299 - train_models - INFO - Building model for WorkType: 202
2025-05-23 14:52:08,307 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:21,138 - train_models - INFO - Model for 202 - MAE: 0.2538, RMSE: 0.3706, R²: 0.7767, MAPE: 11.85%
2025-05-23 14:52:21,138 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 14:52:21,138 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3991
2025-05-23 14:52:21,139 - train_models - INFO -   Relative_Quantity: 0.2655
2025-05-23 14:52:21,139 - train_models - INFO -   Hours_per_Quantity: 0.1518
2025-05-23 14:52:21,139 - train_models - INFO -   Quantity_per_Worker: 0.0998
2025-05-23 14:52:21,140 - train_models - INFO -   NoOfMan_lag_1: 0.0169
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_7day_trend: 0.0085
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_same_dow_lag: 0.0053
2025-05-23 14:52:21,140 - train_models - INFO -   Quantity_1day_trend: 0.0051
2025-05-23 14:52:21,141 - train_models - INFO -   SystemHours_per_Quantity: 0.0045
2025-05-23 14:52:21,141 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0044
2025-05-23 14:52:21,141 - train_models - INFO - Cross-validation details for 202:
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 1: MAE=0.2468, RMSE=0.3434, R²=0.7462, MAPE=13.07%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 2: MAE=0.2997, RMSE=0.4709, R²=0.6726, MAPE=15.43%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 3: MAE=0.2647, RMSE=0.3721, R²=0.7499, MAPE=12.49%
2025-05-23 14:52:21,142 - train_models - INFO -   Fold 4: MAE=0.1910, RMSE=0.2792, R²=0.8736, MAPE=7.90%
2025-05-23 14:52:21,143 - train_models - INFO -   Fold 5: MAE=0.2668, RMSE=0.3872, R²=0.8410, MAPE=10.34%
2025-05-23 14:52:21,143 - train_models - INFO - Building model for WorkType: 203
2025-05-23 14:52:21,148 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:35,425 - train_models - INFO - Model for 203 - MAE: 0.5821, RMSE: 0.7744, R²: 0.5017, MAPE: 12.33%
2025-05-23 14:52:35,425 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 14:52:35,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3950
2025-05-23 14:52:35,426 - train_models - INFO -   Relative_Quantity: 0.1193
2025-05-23 14:52:35,426 - train_models - INFO -   NoOfMan_lag_1: 0.0825
2025-05-23 14:52:35,427 - train_models - INFO -   Quantity_per_Worker: 0.0630
2025-05-23 14:52:35,427 - train_models - INFO -   Hours_per_Quantity: 0.0623
2025-05-23 14:52:35,427 - train_models - INFO -   NoOfMan_lag_3: 0.0281
2025-05-23 14:52:35,428 - train_models - INFO -   Quantity_7day_trend: 0.0253
2025-05-23 14:52:35,428 - train_models - INFO -   Quantity_1day_trend: 0.0229
2025-05-23 14:52:35,428 - train_models - INFO -   NoOfMan_lag_7: 0.0214
2025-05-23 14:52:35,429 - train_models - INFO -   Quantity_same_dow_lag: 0.0206
2025-05-23 14:52:35,429 - train_models - INFO - Cross-validation details for 203:
2025-05-23 14:52:35,429 - train_models - INFO -   Fold 1: MAE=0.6472, RMSE=0.8935, R²=0.3110, MAPE=12.43%
2025-05-23 14:52:35,429 - train_models - INFO -   Fold 2: MAE=0.6427, RMSE=0.8343, R²=0.5155, MAPE=12.14%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 3: MAE=0.6197, RMSE=0.8095, R²=0.5518, MAPE=12.91%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 4: MAE=0.5247, RMSE=0.6892, R²=0.5981, MAPE=13.16%
2025-05-23 14:52:35,430 - train_models - INFO -   Fold 5: MAE=0.4762, RMSE=0.6458, R²=0.5319, MAPE=10.99%
2025-05-23 14:52:35,430 - train_models - INFO - Building model for WorkType: 206
2025-05-23 14:52:35,436 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:52:52,982 - train_models - INFO - Model for 206 - MAE: 1.1569, RMSE: 2.0885, R²: 0.9340, MAPE: 9.91%
2025-05-23 14:52:52,982 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 14:52:52,983 - train_models - INFO -   Relative_Quantity: 0.7617
2025-05-23 14:52:52,983 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1000
2025-05-23 14:52:52,983 - train_models - INFO -   Hours_per_Quantity: 0.0568
2025-05-23 14:52:52,984 - train_models - INFO -   Quantity_per_Worker: 0.0456
2025-05-23 14:52:52,984 - train_models - INFO -   Quantity_same_dow_lag: 0.0108
2025-05-23 14:52:52,984 - train_models - INFO -   DayOfWeek_feat_4: 0.0053
2025-05-23 14:52:52,984 - train_models - INFO -   NoOfMan_lag_1: 0.0031
2025-05-23 14:52:52,985 - train_models - INFO -   NoOfMan_lag_7: 0.0018
2025-05-23 14:52:52,985 - train_models - INFO -   NoOfMan_lag_3: 0.0014
2025-05-23 14:52:52,985 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0013
2025-05-23 14:52:52,986 - train_models - INFO - Cross-validation details for 206:
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 1: MAE=1.8507, RMSE=2.6752, R²=0.9044, MAPE=10.01%
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 2: MAE=1.0664, RMSE=1.5392, R²=0.9641, MAPE=6.12%
2025-05-23 14:52:52,986 - train_models - INFO -   Fold 3: MAE=0.8671, RMSE=2.1292, R²=0.9154, MAPE=4.84%
2025-05-23 14:52:52,987 - train_models - INFO -   Fold 4: MAE=0.8086, RMSE=1.8845, R²=0.9347, MAPE=14.25%
2025-05-23 14:52:52,987 - train_models - INFO -   Fold 5: MAE=1.1917, RMSE=2.2146, R²=0.9512, MAPE=14.31%
2025-05-23 14:52:52,987 - train_models - INFO - Building model for WorkType: 209
2025-05-23 14:52:52,992 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:06,456 - train_models - INFO - Model for 209 - MAE: 0.5236, RMSE: 1.0354, R²: 0.9374, MAPE: 10.31%
2025-05-23 14:53:06,456 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 14:53:06,457 - train_models - INFO -   Relative_Quantity: 0.7599
2025-05-23 14:53:06,457 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0915
2025-05-23 14:53:06,457 - train_models - INFO -   Hours_per_Quantity: 0.0672
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_per_Worker: 0.0642
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_rolling_mean_7: 0.0028
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_1day_trend: 0.0014
2025-05-23 14:53:06,458 - train_models - INFO -   Quantity_7day_trend: 0.0011
2025-05-23 14:53:06,459 - train_models - INFO -   NoOfMan_lag_3: 0.0011
2025-05-23 14:53:06,459 - train_models - INFO -   Quantity_same_dow_lag: 0.0010
2025-05-23 14:53:06,459 - train_models - INFO -   SystemHours_per_Quantity: 0.0010
2025-05-23 14:53:06,459 - train_models - INFO - Cross-validation details for 209:
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 1: MAE=0.9920, RMSE=2.0008, R²=0.8215, MAPE=15.73%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 2: MAE=0.3992, RMSE=0.6202, R²=0.9726, MAPE=4.59%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 3: MAE=0.5060, RMSE=1.2144, R²=0.9338, MAPE=6.03%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 4: MAE=0.3656, RMSE=0.6137, R²=0.9767, MAPE=20.47%
2025-05-23 14:53:06,460 - train_models - INFO -   Fold 5: MAE=0.3550, RMSE=0.7279, R²=0.9825, MAPE=4.73%
2025-05-23 14:53:06,461 - train_models - INFO - Building model for WorkType: 210
2025-05-23 14:53:06,466 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:19,669 - train_models - INFO - Model for 210 - MAE: 0.4113, RMSE: 0.8576, R²: 0.9367, MAPE: 7.91%
2025-05-23 14:53:19,670 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 14:53:19,670 - train_models - INFO -   Relative_Quantity: 0.8527
2025-05-23 14:53:19,670 - train_models - INFO -   Hours_per_Quantity: 0.0542
2025-05-23 14:53:19,670 - train_models - INFO -   Quantity_per_Worker: 0.0542
2025-05-23 14:53:19,671 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0203
2025-05-23 14:53:19,671 - train_models - INFO -   SystemHours_per_Quantity: 0.0056
2025-05-23 14:53:19,671 - train_models - INFO -   Quantity_1day_trend: 0.0022
2025-05-23 14:53:19,672 - train_models - INFO -   Hours_SystemHours_Ratio_lag_1: 0.0013
2025-05-23 14:53:19,672 - train_models - INFO -   SystemKPI_lag_1: 0.0011
2025-05-23 14:53:19,672 - train_models - INFO -   Quantity_same_dow_lag: 0.0010
2025-05-23 14:53:19,672 - train_models - INFO -   Combined_KPI_lag_1: 0.0009
2025-05-23 14:53:19,673 - train_models - INFO - Cross-validation details for 210:
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 1: MAE=0.5952, RMSE=1.3201, R²=0.8683, MAPE=8.84%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 2: MAE=0.3867, RMSE=0.6460, R²=0.9590, MAPE=4.48%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 3: MAE=0.4121, RMSE=0.9396, R²=0.9189, MAPE=6.11%
2025-05-23 14:53:19,673 - train_models - INFO -   Fold 4: MAE=0.3304, RMSE=0.5999, R²=0.9676, MAPE=15.58%
2025-05-23 14:53:19,674 - train_models - INFO -   Fold 5: MAE=0.3324, RMSE=0.7824, R²=0.9695, MAPE=4.54%
2025-05-23 14:53:19,674 - train_models - INFO - Building model for WorkType: 211
2025-05-23 14:53:19,679 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:34,716 - train_models - INFO - Model for 211 - MAE: 0.8164, RMSE: 1.1902, R²: 0.8583, MAPE: 12.68%
2025-05-23 14:53:34,716 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 14:53:34,716 - train_models - INFO -   Relative_Quantity: 0.5870
2025-05-23 14:53:34,717 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2219
2025-05-23 14:53:34,717 - train_models - INFO -   Quantity_per_Worker: 0.0565
2025-05-23 14:53:34,717 - train_models - INFO -   Hours_per_Quantity: 0.0483
2025-05-23 14:53:34,718 - train_models - INFO -   SystemHours_per_Quantity: 0.0255
2025-05-23 14:53:34,718 - train_models - INFO -   Quantity_1day_trend: 0.0078
2025-05-23 14:53:34,718 - train_models - INFO -   Quantity_same_dow_lag: 0.0071
2025-05-23 14:53:34,718 - train_models - INFO -   NoOfMan_lag_1: 0.0062
2025-05-23 14:53:34,719 - train_models - INFO -   Quantity_7day_trend: 0.0047
2025-05-23 14:53:34,719 - train_models - INFO -   NoOfMan_lag_2: 0.0040
2025-05-23 14:53:34,719 - train_models - INFO - Cross-validation details for 211:
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 1: MAE=1.3222, RMSE=1.8035, R²=0.6923, MAPE=15.99%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 2: MAE=1.0345, RMSE=1.5429, R²=0.8245, MAPE=19.28%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 3: MAE=0.5333, RMSE=0.8052, R²=0.9210, MAPE=6.69%
2025-05-23 14:53:34,720 - train_models - INFO -   Fold 4: MAE=0.6527, RMSE=0.9433, R²=0.9292, MAPE=13.67%
2025-05-23 14:53:34,721 - train_models - INFO -   Fold 5: MAE=0.5395, RMSE=0.8563, R²=0.9246, MAPE=7.80%
2025-05-23 14:53:34,721 - train_models - INFO - Building model for WorkType: 213
2025-05-23 14:53:34,726 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:53:48,442 - train_models - INFO - Model for 213 - MAE: 0.6018, RMSE: 0.8479, R²: 0.6913, MAPE: 27.20%
2025-05-23 14:53:48,442 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 14:53:48,443 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4762
2025-05-23 14:53:48,443 - train_models - INFO -   Relative_Quantity: 0.1606
2025-05-23 14:53:48,443 - train_models - INFO -   Quantity_7day_trend: 0.0716
2025-05-23 14:53:48,444 - train_models - INFO -   Hours_per_Quantity: 0.0508
2025-05-23 14:53:48,444 - train_models - INFO -   Quantity_per_Worker: 0.0472
2025-05-23 14:53:48,444 - train_models - INFO -   Quantity_1day_trend: 0.0423
2025-05-23 14:53:48,445 - train_models - INFO -   NoOfMan_lag_1: 0.0121
2025-05-23 14:53:48,445 - train_models - INFO -   NoOfMan_lag_3: 0.0120
2025-05-23 14:53:48,445 - train_models - INFO -   SystemKPI_lag_1: 0.0110
2025-05-23 14:53:48,445 - train_models - INFO -   SystemHours_per_Quantity: 0.0109
2025-05-23 14:53:48,446 - train_models - INFO - Cross-validation details for 213:
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 1: MAE=0.6523, RMSE=0.8489, R²=0.4886, MAPE=38.88%
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 2: MAE=0.7170, RMSE=1.0667, R²=0.6264, MAPE=34.02%
2025-05-23 14:53:48,446 - train_models - INFO -   Fold 3: MAE=0.6500, RMSE=0.9589, R²=0.7110, MAPE=24.80%
2025-05-23 14:53:48,447 - train_models - INFO -   Fold 4: MAE=0.5068, RMSE=0.6980, R²=0.8164, MAPE=22.05%
2025-05-23 14:53:48,447 - train_models - INFO -   Fold 5: MAE=0.4829, RMSE=0.6669, R²=0.8139, MAPE=16.23%
2025-05-23 14:53:48,447 - train_models - INFO - Building model for WorkType: 214
2025-05-23 14:53:48,451 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:01,559 - train_models - INFO - Model for 214 - MAE: 0.6296, RMSE: 0.9212, R²: 0.8317, MAPE: 13.85%
2025-05-23 14:54:01,559 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 14:54:01,560 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5628
2025-05-23 14:54:01,560 - train_models - INFO -   Relative_Quantity: 0.2165
2025-05-23 14:54:01,560 - train_models - INFO -   Quantity_per_Worker: 0.0508
2025-05-23 14:54:01,560 - train_models - INFO -   Hours_per_Quantity: 0.0434
2025-05-23 14:54:01,560 - train_models - INFO -   SystemHours_per_Quantity: 0.0337
2025-05-23 14:54:01,561 - train_models - INFO -   Quantity_7day_trend: 0.0132
2025-05-23 14:54:01,561 - train_models - INFO -   Quantity_1day_trend: 0.0116
2025-05-23 14:54:01,561 - train_models - INFO -   DayOfWeek_feat_6: 0.0093
2025-05-23 14:54:01,562 - train_models - INFO -   Quantity_same_dow_lag: 0.0083
2025-05-23 14:54:01,562 - train_models - INFO -   NoOfMan_lag_1: 0.0060
2025-05-23 14:54:01,562 - train_models - INFO - Cross-validation details for 214:
2025-05-23 14:54:01,562 - train_models - INFO -   Fold 1: MAE=0.6551, RMSE=0.8530, R²=0.7736, MAPE=15.69%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 2: MAE=0.5878, RMSE=0.7720, R²=0.8460, MAPE=13.77%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 3: MAE=0.5510, RMSE=0.7778, R²=0.8489, MAPE=11.61%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 4: MAE=0.6654, RMSE=1.0945, R²=0.8365, MAPE=13.33%
2025-05-23 14:54:01,563 - train_models - INFO -   Fold 5: MAE=0.6889, RMSE=1.1085, R²=0.8536, MAPE=14.87%
2025-05-23 14:54:01,563 - train_models - INFO - Building model for WorkType: 215
2025-05-23 14:54:01,567 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:16,481 - train_models - INFO - Model for 215 - MAE: 0.3198, RMSE: 0.6181, R²: 0.9654, MAPE: 6.19%
2025-05-23 14:54:16,481 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 14:54:16,482 - train_models - INFO -   Relative_Quantity: 0.9023
2025-05-23 14:54:16,482 - train_models - INFO -   Hours_per_Quantity: 0.0410
2025-05-23 14:54:16,482 - train_models - INFO -   Quantity_per_Worker: 0.0374
2025-05-23 14:54:16,482 - train_models - INFO -   Quantity_1day_trend: 0.0040
2025-05-23 14:54:16,483 - train_models - INFO -   SystemHours_per_Quantity: 0.0034
2025-05-23 14:54:16,483 - train_models - INFO -   Quantity_7day_trend: 0.0021
2025-05-23 14:54:16,483 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0013
2025-05-23 14:54:16,483 - train_models - INFO -   NoOfMan_lag_3: 0.0010
2025-05-23 14:54:16,484 - train_models - INFO -   NoOfMan_lag_2: 0.0010
2025-05-23 14:54:16,484 - train_models - INFO -   SystemKPI_lag_1: 0.0007
2025-05-23 14:54:16,484 - train_models - INFO - Cross-validation details for 215:
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 1: MAE=0.5006, RMSE=0.7378, R²=0.9566, MAPE=9.50%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 2: MAE=0.4075, RMSE=0.8216, R²=0.9509, MAPE=7.56%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 3: MAE=0.2295, RMSE=0.3581, R²=0.9795, MAPE=5.41%
2025-05-23 14:54:16,485 - train_models - INFO -   Fold 4: MAE=0.2287, RMSE=0.5753, R²=0.9704, MAPE=5.65%
2025-05-23 14:54:16,486 - train_models - INFO -   Fold 5: MAE=0.2328, RMSE=0.5977, R²=0.9696, MAPE=2.84%
2025-05-23 14:54:16,486 - train_models - INFO - Building model for WorkType: 217
2025-05-23 14:54:16,491 - train_models - INFO - Using 21 numeric features and 2 categorical features
2025-05-23 14:54:28,104 - train_models - INFO - Model for 217 - MAE: 0.6579, RMSE: 0.9192, R²: 0.7678, MAPE: 26.66%
2025-05-23 14:54:28,105 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 14:54:28,105 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.6170
2025-05-23 14:54:28,105 - train_models - INFO -   Relative_Quantity: 0.1636
2025-05-23 14:54:28,106 - train_models - INFO -   Hours_per_Quantity: 0.0580
2025-05-23 14:54:28,106 - train_models - INFO -   Quantity_per_Worker: 0.0542
2025-05-23 14:54:28,106 - train_models - INFO -   NoOfMan_lag_1: 0.0151
2025-05-23 14:54:28,107 - train_models - INFO -   Quantity_7day_trend: 0.0149
2025-05-23 14:54:28,107 - train_models - INFO -   SystemHours_per_Quantity: 0.0130
2025-05-23 14:54:28,107 - train_models - INFO -   Quantity_1day_trend: 0.0088
2025-05-23 14:54:28,108 - train_models - INFO -   NoOfMan_lag_7: 0.0063
2025-05-23 14:54:28,108 - train_models - INFO -   NoOfMan_lag_3: 0.0058
2025-05-23 14:54:28,108 - train_models - INFO - Cross-validation details for 217:
2025-05-23 14:54:28,108 - train_models - INFO -   Fold 1: MAE=0.7837, RMSE=1.0374, R²=0.5944, MAPE=35.87%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 2: MAE=0.7079, RMSE=1.0667, R²=0.7760, MAPE=25.56%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 3: MAE=0.5931, RMSE=0.7986, R²=0.7736, MAPE=24.31%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 4: MAE=0.6035, RMSE=0.8648, R²=0.8611, MAPE=25.59%
2025-05-23 14:54:28,109 - train_models - INFO -   Fold 5: MAE=0.6012, RMSE=0.8282, R²=0.8339, MAPE=21.95%
2025-05-23 14:54:28,110 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 14:54:28,717 - train_models - INFO - Model files saved successfully
2025-05-23 14:54:28,717 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 14:54:28,720 - train_models - INFO - Model training completed successfully
2025-05-23 15:03:43,552 - train_models - INFO - Starting the model training process
2025-05-23 15:03:43,552 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:03:43,557 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:03:43,677 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:03:44,287 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:03:44,373 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:03:44,394 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:03:44,398 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:03:44,418 - train_models - INFO - Engineering features...
2025-05-23 15:03:44,885 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:03:44,920 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:03:44,928 - train_models - INFO - Creating lag features...
2025-05-23 15:03:44,939 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:03:45,141 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:03:45,141 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:03:45,154 - train_models - INFO - Found 10 unique work types
2025-05-23 15:03:45,155 - train_models - INFO - Building models for 10 work types
2025-05-23 15:03:45,155 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:03:45,155 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:03:45,156 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:03:45,161 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:02,517 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2833, R²: 0.8728, MAPE: 9.29%
2025-05-23 15:04:02,517 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 15:04:02,518 - train_models - INFO -   NoOfMan_lag_7: 0.0694
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:04:02,519 - train_models - INFO -   Relative_Quantity: 0.0382
2025-05-23 15:04:02,519 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:04:02,520 - train_models - INFO -   Hours_per_Quantity: 0.0166
2025-05-23 15:04:02,520 - train_models - INFO -   Quantity_per_Worker: 0.0086
2025-05-23 15:04:02,520 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:04:02,520 - train_models - INFO -   Fold 1: MAE=0.1833, RMSE=0.2552, R²=0.8598, MAPE=10.17%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 2: MAE=0.2149, RMSE=0.3452, R²=0.8241, MAPE=10.80%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2482, R²=0.8887, MAPE=9.37%
2025-05-23 15:04:02,521 - train_models - INFO -   Fold 4: MAE=0.1730, RMSE=0.2502, R²=0.8984, MAPE=7.25%
2025-05-23 15:04:02,522 - train_models - INFO -   Fold 5: MAE=0.2287, RMSE=0.3177, R²=0.8930, MAPE=8.84%
2025-05-23 15:04:02,522 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:04:02,528 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:20,514 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4017, R²: 0.8607, MAPE: 5.51%
2025-05-23 15:04:20,514 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 15:04:20,515 - train_models - INFO -   NoOfMan_lag_7: 0.1005
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0983
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_1day_trend: 0.0911
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0049
2025-05-23 15:04:20,516 - train_models - INFO -   NoOfMan_lag_2: 0.0030
2025-05-23 15:04:20,517 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:04:20,517 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:04:20,517 - train_models - INFO -   Fold 1: MAE=0.3987, RMSE=0.5317, R²=0.7560, MAPE=7.22%
2025-05-23 15:04:20,517 - train_models - INFO -   Fold 2: MAE=0.2769, RMSE=0.5439, R²=0.7941, MAPE=4.74%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 3: MAE=0.2728, RMSE=0.3879, R²=0.8971, MAPE=5.78%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 4: MAE=0.1956, RMSE=0.2961, R²=0.9258, MAPE=5.33%
2025-05-23 15:04:20,518 - train_models - INFO -   Fold 5: MAE=0.1892, RMSE=0.2491, R²=0.9303, MAPE=4.47%
2025-05-23 15:04:20,518 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:04:20,522 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:04:44,955 - train_models - INFO - Model for 206 - MAE: 1.2985, RMSE: 2.1094, R²: 0.9329, MAPE: 10.13%
2025-05-23 15:04:44,955 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:04:44,956 - train_models - INFO -   Relative_Quantity: 0.6750
2025-05-23 15:04:44,956 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:04:44,956 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0408
2025-05-23 15:04:44,956 - train_models - INFO -   Hours_per_Quantity: 0.0370
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:04:44,957 - train_models - INFO -   Quantity_per_Worker: 0.0291
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 15:04:44,957 - train_models - INFO -   NoOfMan_lag_1: 0.0053
2025-05-23 15:04:44,958 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:04:44,958 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:04:44,958 - train_models - INFO -   Fold 1: MAE=1.7806, RMSE=2.3592, R²=0.9257, MAPE=9.13%
2025-05-23 15:04:44,958 - train_models - INFO -   Fold 2: MAE=1.3723, RMSE=1.8870, R²=0.9461, MAPE=8.15%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 3: MAE=1.0791, RMSE=2.2740, R²=0.9035, MAPE=5.87%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 4: MAE=0.9947, RMSE=1.8693, R²=0.9358, MAPE=14.09%
2025-05-23 15:04:44,959 - train_models - INFO -   Fold 5: MAE=1.2660, RMSE=2.1573, R²=0.9537, MAPE=13.42%
2025-05-23 15:04:44,959 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:04:44,963 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:03,500 - train_models - INFO - Model for 209 - MAE: 0.5529, RMSE: 1.0429, R²: 0.9384, MAPE: 10.23%
2025-05-23 15:05:03,500 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:05:03,500 - train_models - INFO -   Relative_Quantity: 0.7433
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1247
2025-05-23 15:05:03,501 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:05:03,501 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0075
2025-05-23 15:05:03,501 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0019
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:05:03,502 - train_models - INFO -   NoOfMan_lag_7: 0.0012
2025-05-23 15:05:03,502 - train_models - INFO -   Quantity_rolling_mean_7: 0.0009
2025-05-23 15:05:03,502 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 1: MAE=0.9712, RMSE=1.9404, R²=0.8321, MAPE=15.36%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 2: MAE=0.3919, RMSE=0.6217, R²=0.9724, MAPE=4.57%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 3: MAE=0.5155, RMSE=1.1498, R²=0.9406, MAPE=6.13%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.7413, R²=0.9660, MAPE=20.01%
2025-05-23 15:05:03,503 - train_models - INFO -   Fold 5: MAE=0.4112, RMSE=0.7614, R²=0.9808, MAPE=5.08%
2025-05-23 15:05:03,504 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:05:03,507 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:21,439 - train_models - INFO - Model for 210 - MAE: 0.4239, RMSE: 0.8392, R²: 0.9402, MAPE: 7.67%
2025-05-23 15:05:21,440 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:05:21,440 - train_models - INFO -   Relative_Quantity: 0.8401
2025-05-23 15:05:21,440 - train_models - INFO -   Quantity_per_Worker: 0.0458
2025-05-23 15:05:21,440 - train_models - INFO -   Hours_per_Quantity: 0.0444
2025-05-23 15:05:21,440 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:05:21,441 - train_models - INFO -   SystemHours_per_Quantity: 0.0037
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_7day_trend: 0.0020
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_1day_trend: 0.0019
2025-05-23 15:05:21,441 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:05:21,442 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:05:21,442 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 1: MAE=0.5872, RMSE=1.2270, R²=0.8863, MAPE=9.02%
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 2: MAE=0.3931, RMSE=0.6374, R²=0.9601, MAPE=4.63%
2025-05-23 15:05:21,442 - train_models - INFO -   Fold 3: MAE=0.4218, RMSE=0.9508, R²=0.9170, MAPE=6.45%
2025-05-23 15:05:21,443 - train_models - INFO -   Fold 4: MAE=0.3586, RMSE=0.5929, R²=0.9684, MAPE=13.62%
2025-05-23 15:05:21,443 - train_models - INFO -   Fold 5: MAE=0.3585, RMSE=0.7881, R²=0.9691, MAPE=4.64%
2025-05-23 15:05:21,443 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:05:21,449 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:05:42,794 - train_models - INFO - Model for 211 - MAE: 0.7165, RMSE: 1.0151, R²: 0.9028, MAPE: 11.26%
2025-05-23 15:05:42,795 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:05:42,795 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 15:05:42,795 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_7day_trend: 0.0706
2025-05-23 15:05:42,796 - train_models - INFO -   NoOfMan_lag_1: 0.0335
2025-05-23 15:05:42,797 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-05-23 15:05:42,797 - train_models - INFO -   Quantity_per_Worker: 0.0119
2025-05-23 15:05:42,797 - train_models - INFO -   Hours_per_Quantity: 0.0082
2025-05-23 15:05:42,797 - train_models - INFO -   SystemHours_per_Quantity: 0.0057
2025-05-23 15:05:42,797 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 1: MAE=0.9276, RMSE=1.3133, R²=0.8368, MAPE=11.94%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 2: MAE=0.8357, RMSE=1.2856, R²=0.8782, MAPE=17.02%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 3: MAE=0.4952, RMSE=0.6762, R²=0.9443, MAPE=6.16%
2025-05-23 15:05:42,798 - train_models - INFO -   Fold 4: MAE=0.8019, RMSE=1.0425, R²=0.9135, MAPE=15.23%
2025-05-23 15:05:42,799 - train_models - INFO -   Fold 5: MAE=0.5223, RMSE=0.7578, R²=0.9410, MAPE=5.95%
2025-05-23 15:05:42,799 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:05:42,804 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:01,203 - train_models - INFO - Model for 213 - MAE: 0.3657, RMSE: 0.5324, R²: 0.8788, MAPE: 16.02%
2025-05-23 15:06:01,204 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3527
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_7day_trend: 0.2753
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 15:06:01,204 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0376
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_lag_7: 0.0231
2025-05-23 15:06:01,205 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 15:06:01,205 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0105
2025-05-23 15:06:01,206 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-23 15:06:01,206 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:06:01,206 - train_models - INFO -   Fold 1: MAE=0.4254, RMSE=0.5286, R²=0.8017, MAPE=25.69%
2025-05-23 15:06:01,206 - train_models - INFO -   Fold 2: MAE=0.4243, RMSE=0.6590, R²=0.8574, MAPE=17.28%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 3: MAE=0.3687, RMSE=0.5323, R²=0.9110, MAPE=15.01%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 4: MAE=0.2935, RMSE=0.4950, R²=0.9077, MAPE=11.80%
2025-05-23 15:06:01,207 - train_models - INFO -   Fold 5: MAE=0.3163, RMSE=0.4471, R²=0.9164, MAPE=10.30%
2025-05-23 15:06:01,208 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:06:01,212 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:20,035 - train_models - INFO - Model for 214 - MAE: 0.5304, RMSE: 0.7931, R²: 0.8797, MAPE: 11.78%
2025-05-23 15:06:20,035 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:06:20,035 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 15:06:20,036 - train_models - INFO -   Relative_Quantity: 0.0953
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0616
2025-05-23 15:06:20,036 - train_models - INFO -   NoOfMan_1day_trend: 0.0558
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0125
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 15:06:20,037 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0101
2025-05-23 15:06:20,038 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6630, R²=0.8632, MAPE=12.83%
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 2: MAE=0.4463, RMSE=0.5754, R²=0.9144, MAPE=11.76%
2025-05-23 15:06:20,038 - train_models - INFO -   Fold 3: MAE=0.4159, RMSE=0.5826, R²=0.9152, MAPE=9.06%
2025-05-23 15:06:20,039 - train_models - INFO -   Fold 4: MAE=0.6164, RMSE=1.0800, R²=0.8408, MAPE=11.87%
2025-05-23 15:06:20,039 - train_models - INFO -   Fold 5: MAE=0.6641, RMSE=1.0645, R²=0.8650, MAPE=13.37%
2025-05-23 15:06:20,039 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:06:20,043 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:41,104 - train_models - INFO - Model for 215 - MAE: 0.3427, RMSE: 0.6236, R²: 0.9644, MAPE: 6.50%
2025-05-23 15:06:41,105 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:06:41,105 - train_models - INFO -   Relative_Quantity: 0.8928
2025-05-23 15:06:41,105 - train_models - INFO -   Quantity_per_Worker: 0.0379
2025-05-23 15:06:41,106 - train_models - INFO -   Hours_per_Quantity: 0.0361
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_7day_trend: 0.0076
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_1day_trend: 0.0053
2025-05-23 15:06:41,106 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0040
2025-05-23 15:06:41,107 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0024
2025-05-23 15:06:41,107 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:06:41,107 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 15:06:41,108 - train_models - INFO -   NoOfMan_lag_2: 0.0009
2025-05-23 15:06:41,108 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:06:41,108 - train_models - INFO -   Fold 1: MAE=0.5083, RMSE=0.7128, R²=0.9595, MAPE=9.80%
2025-05-23 15:06:41,108 - train_models - INFO -   Fold 2: MAE=0.4902, RMSE=0.9051, R²=0.9404, MAPE=8.68%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 3: MAE=0.2369, RMSE=0.3560, R²=0.9798, MAPE=5.40%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 4: MAE=0.2205, RMSE=0.4999, R²=0.9777, MAPE=5.55%
2025-05-23 15:06:41,109 - train_models - INFO -   Fold 5: MAE=0.2574, RMSE=0.6442, R²=0.9647, MAPE=3.07%
2025-05-23 15:06:41,109 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:06:41,114 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:06:56,972 - train_models - INFO - Model for 217 - MAE: 0.4295, RMSE: 0.6076, R²: 0.9033, MAPE: 16.79%
2025-05-23 15:06:56,972 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2295
2025-05-23 15:06:56,973 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_lag_7: 0.0377
2025-05-23 15:06:56,974 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 15:06:56,974 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 15:06:56,975 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 15:06:56,975 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 15:06:56,975 - train_models - INFO -   Hours_per_Quantity: 0.0052
2025-05-23 15:06:56,976 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 1: MAE=0.4549, RMSE=0.6129, R²=0.8584, MAPE=22.10%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 2: MAE=0.4708, RMSE=0.7086, R²=0.9012, MAPE=16.36%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 3: MAE=0.3434, RMSE=0.4598, R²=0.9249, MAPE=13.88%
2025-05-23 15:06:56,976 - train_models - INFO -   Fold 4: MAE=0.4713, RMSE=0.6454, R²=0.9227, MAPE=17.59%
2025-05-23 15:06:56,977 - train_models - INFO -   Fold 5: MAE=0.4071, RMSE=0.6114, R²=0.9095, MAPE=14.03%
2025-05-23 15:06:56,977 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:06:57,731 - train_models - INFO - Model files saved successfully
2025-05-23 15:06:57,731 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:06:57,735 - train_models - INFO - Model training completed successfully
2025-05-23 15:08:39,646 - train_models - INFO - Starting the model training process
2025-05-23 15:08:39,647 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:08:39,651 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:08:39,767 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:08:40,381 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:08:40,466 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:08:40,486 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:08:40,489 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:08:40,514 - train_models - INFO - Engineering features...
2025-05-23 15:08:41,031 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:08:41,067 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:08:41,071 - train_models - INFO - Creating lag features...
2025-05-23 15:08:41,085 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:08:41,296 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:08:41,297 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:08:41,311 - train_models - INFO - Found 10 unique work types
2025-05-23 15:08:41,312 - train_models - INFO - Building models for 10 work types
2025-05-23 15:08:41,312 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:08:41,313 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:08:41,313 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:08:41,318 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:08:58,936 - train_models - INFO - Model for 202 - MAE: 0.1962, RMSE: 0.2829, R²: 0.8730, MAPE: 9.28%
2025-05-23 15:08:58,936 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3730
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:08:58,937 - train_models - INFO -   NoOfMan_1day_trend: 0.1205
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_lag_7: 0.0694
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:08:58,938 - train_models - INFO -   Relative_Quantity: 0.0382
2025-05-23 15:08:58,938 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:08:58,939 - train_models - INFO -   Hours_per_Quantity: 0.0163
2025-05-23 15:08:58,939 - train_models - INFO -   Quantity_per_Worker: 0.0090
2025-05-23 15:08:58,939 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:08:58,939 - train_models - INFO -   Fold 1: MAE=0.1844, RMSE=0.2569, R²=0.8579, MAPE=10.27%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 2: MAE=0.2148, RMSE=0.3451, R²=0.8242, MAPE=10.81%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 3: MAE=0.1830, RMSE=0.2482, R²=0.8887, MAPE=9.36%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 4: MAE=0.1717, RMSE=0.2484, R²=0.8999, MAPE=7.20%
2025-05-23 15:08:58,940 - train_models - INFO -   Fold 5: MAE=0.2270, RMSE=0.3157, R²=0.8943, MAPE=8.78%
2025-05-23 15:08:58,941 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:08:58,946 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:09:18,519 - train_models - INFO - Model for 203 - MAE: 0.2663, RMSE: 0.4018, R²: 0.8606, MAPE: 5.50%
2025-05-23 15:09:18,519 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_7day_trend: 0.3472
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1348
2025-05-23 15:09:18,520 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1335
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_lag_7: 0.1005
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0983
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_1day_trend: 0.0909
2025-05-23 15:09:18,521 - train_models - INFO -   NoOfMan_lag_1: 0.0484
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0050
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 15:09:18,522 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:09:18,523 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 1: MAE=0.3984, RMSE=0.5326, R²=0.7552, MAPE=7.22%
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 2: MAE=0.2760, RMSE=0.5428, R²=0.7949, MAPE=4.72%
2025-05-23 15:09:18,523 - train_models - INFO -   Fold 3: MAE=0.2727, RMSE=0.3881, R²=0.8970, MAPE=5.78%
2025-05-23 15:09:18,524 - train_models - INFO -   Fold 4: MAE=0.1959, RMSE=0.2972, R²=0.9253, MAPE=5.34%
2025-05-23 15:09:18,524 - train_models - INFO -   Fold 5: MAE=0.1883, RMSE=0.2483, R²=0.9308, MAPE=4.45%
2025-05-23 15:09:18,524 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:09:18,528 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:09:42,395 - train_models - INFO - Model for 206 - MAE: 1.2929, RMSE: 2.1012, R²: 0.9333, MAPE: 10.14%
2025-05-23 15:09:42,395 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:09:42,396 - train_models - INFO -   Relative_Quantity: 0.6750
2025-05-23 15:09:42,396 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:09:42,396 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0406
2025-05-23 15:09:42,397 - train_models - INFO -   Hours_per_Quantity: 0.0372
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:09:42,397 - train_models - INFO -   Quantity_per_Worker: 0.0290
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:09:42,397 - train_models - INFO -   NoOfMan_7day_trend: 0.0071
2025-05-23 15:09:42,398 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 15:09:42,398 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:09:42,398 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:09:42,398 - train_models - INFO -   Fold 1: MAE=1.7741, RMSE=2.3512, R²=0.9262, MAPE=9.10%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 2: MAE=1.3848, RMSE=1.8883, R²=0.9460, MAPE=8.20%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 3: MAE=1.0714, RMSE=2.2732, R²=0.9036, MAPE=5.84%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 4: MAE=0.9878, RMSE=1.8726, R²=0.9355, MAPE=14.11%
2025-05-23 15:09:42,399 - train_models - INFO -   Fold 5: MAE=1.2466, RMSE=2.1208, R²=0.9552, MAPE=13.45%
2025-05-23 15:09:42,400 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:09:42,403 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:01,621 - train_models - INFO - Model for 209 - MAE: 0.5522, RMSE: 1.0416, R²: 0.9383, MAPE: 10.19%
2025-05-23 15:10:01,622 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:10:01,622 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:10:01,622 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1249
2025-05-23 15:10:01,622 - train_models - INFO -   Hours_per_Quantity: 0.0540
2025-05-23 15:10:01,622 - train_models - INFO -   Quantity_per_Worker: 0.0466
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0074
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_7day_trend: 0.0058
2025-05-23 15:10:01,623 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:10:01,624 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-23 15:10:01,624 - train_models - INFO -   NoOfMan_lag_7: 0.0012
2025-05-23 15:10:01,624 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:10:01,624 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:10:01,624 - train_models - INFO -   Fold 1: MAE=0.9806, RMSE=1.9546, R²=0.8296, MAPE=15.36%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 2: MAE=0.3897, RMSE=0.6178, R²=0.9728, MAPE=4.53%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 3: MAE=0.5139, RMSE=1.1365, R²=0.9420, MAPE=6.14%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 4: MAE=0.4648, RMSE=0.7345, R²=0.9666, MAPE=19.80%
2025-05-23 15:10:01,625 - train_models - INFO -   Fold 5: MAE=0.4124, RMSE=0.7649, R²=0.9806, MAPE=5.12%
2025-05-23 15:10:01,625 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:10:01,631 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:19,655 - train_models - INFO - Model for 210 - MAE: 0.4203, RMSE: 0.8322, R²: 0.9410, MAPE: 7.61%
2025-05-23 15:10:19,656 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:10:19,656 - train_models - INFO -   Relative_Quantity: 0.8400
2025-05-23 15:10:19,656 - train_models - INFO -   Quantity_per_Worker: 0.0466
2025-05-23 15:10:19,657 - train_models - INFO -   Hours_per_Quantity: 0.0433
2025-05-23 15:10:19,657 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:10:19,657 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:10:19,658 - train_models - INFO -   SystemHours_per_Quantity: 0.0042
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_7day_trend: 0.0020
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_1day_trend: 0.0018
2025-05-23 15:10:19,658 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:10:19,658 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 15:10:19,659 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:10:19,659 - train_models - INFO -   Fold 1: MAE=0.5875, RMSE=1.2313, R²=0.8855, MAPE=9.02%
2025-05-23 15:10:19,659 - train_models - INFO -   Fold 2: MAE=0.3906, RMSE=0.6315, R²=0.9608, MAPE=4.59%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 3: MAE=0.4149, RMSE=0.9306, R²=0.9204, MAPE=6.34%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 4: MAE=0.3550, RMSE=0.5929, R²=0.9684, MAPE=13.48%
2025-05-23 15:10:19,660 - train_models - INFO -   Fold 5: MAE=0.3533, RMSE=0.7749, R²=0.9701, MAPE=4.59%
2025-05-23 15:10:19,661 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:10:19,665 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:39,413 - train_models - INFO - Model for 211 - MAE: 0.7154, RMSE: 1.0139, R²: 0.9029, MAPE: 11.29%
2025-05-23 15:10:39,414 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:10:39,414 - train_models - INFO -   Relative_Quantity: 0.4585
2025-05-23 15:10:39,414 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_1day_trend: 0.0959
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0856
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_7day_trend: 0.0707
2025-05-23 15:10:39,415 - train_models - INFO -   NoOfMan_lag_1: 0.0336
2025-05-23 15:10:39,416 - train_models - INFO -   NoOfMan_lag_7: 0.0206
2025-05-23 15:10:39,416 - train_models - INFO -   Quantity_per_Worker: 0.0116
2025-05-23 15:10:39,417 - train_models - INFO -   Hours_per_Quantity: 0.0082
2025-05-23 15:10:39,417 - train_models - INFO -   SystemHours_per_Quantity: 0.0058
2025-05-23 15:10:39,417 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 1: MAE=0.9294, RMSE=1.3138, R²=0.8367, MAPE=12.16%
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 2: MAE=0.8391, RMSE=1.2903, R²=0.8773, MAPE=17.05%
2025-05-23 15:10:39,418 - train_models - INFO -   Fold 3: MAE=0.4925, RMSE=0.6708, R²=0.9452, MAPE=6.10%
2025-05-23 15:10:39,419 - train_models - INFO -   Fold 4: MAE=0.7996, RMSE=1.0450, R²=0.9131, MAPE=15.20%
2025-05-23 15:10:39,419 - train_models - INFO -   Fold 5: MAE=0.5163, RMSE=0.7497, R²=0.9422, MAPE=5.93%
2025-05-23 15:10:39,419 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:10:39,427 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:10:57,856 - train_models - INFO - Model for 213 - MAE: 0.3646, RMSE: 0.5306, R²: 0.8798, MAPE: 15.98%
2025-05-23 15:10:57,856 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3526
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_7day_trend: 0.2754
2025-05-23 15:10:57,857 - train_models - INFO -   NoOfMan_1day_trend: 0.1609
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_lag_1: 0.0459
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0378
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:10:57,858 - train_models - INFO -   NoOfMan_lag_7: 0.0231
2025-05-23 15:10:57,859 - train_models - INFO -   Relative_Quantity: 0.0209
2025-05-23 15:10:57,859 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0099
2025-05-23 15:10:57,859 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 15:10:57,860 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 1: MAE=0.4207, RMSE=0.5236, R²=0.8054, MAPE=25.50%
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 2: MAE=0.4251, RMSE=0.6582, R²=0.8577, MAPE=17.36%
2025-05-23 15:10:57,860 - train_models - INFO -   Fold 3: MAE=0.3663, RMSE=0.5272, R²=0.9126, MAPE=14.95%
2025-05-23 15:10:57,861 - train_models - INFO -   Fold 4: MAE=0.2957, RMSE=0.4978, R²=0.9066, MAPE=11.84%
2025-05-23 15:10:57,861 - train_models - INFO -   Fold 5: MAE=0.3154, RMSE=0.4462, R²=0.9167, MAPE=10.22%
2025-05-23 15:10:57,861 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:10:57,865 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:15,746 - train_models - INFO - Model for 214 - MAE: 0.5294, RMSE: 0.7913, R²: 0.8801, MAPE: 11.75%
2025-05-23 15:11:15,746 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:11:15,747 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:11:15,747 - train_models - INFO -   NoOfMan_7day_trend: 0.1493
2025-05-23 15:11:15,747 - train_models - INFO -   Relative_Quantity: 0.0949
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0617
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_1day_trend: 0.0559
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:11:15,748 - train_models - INFO -   NoOfMan_lag_1: 0.0212
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0121
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0105
2025-05-23 15:11:15,749 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 15:11:15,750 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 1: MAE=0.5106, RMSE=0.6659, R²=0.8620, MAPE=12.87%
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 2: MAE=0.4451, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 15:11:15,750 - train_models - INFO -   Fold 3: MAE=0.4135, RMSE=0.5806, R²=0.9158, MAPE=8.99%
2025-05-23 15:11:15,751 - train_models - INFO -   Fold 4: MAE=0.6170, RMSE=1.0803, R²=0.8407, MAPE=11.85%
2025-05-23 15:11:15,751 - train_models - INFO -   Fold 5: MAE=0.6609, RMSE=1.0564, R²=0.8670, MAPE=13.33%
2025-05-23 15:11:15,751 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:11:15,758 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:36,175 - train_models - INFO - Model for 215 - MAE: 0.3427, RMSE: 0.6239, R²: 0.9644, MAPE: 6.50%
2025-05-23 15:11:36,175 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:11:36,176 - train_models - INFO -   Relative_Quantity: 0.8934
2025-05-23 15:11:36,176 - train_models - INFO -   Quantity_per_Worker: 0.0386
2025-05-23 15:11:36,176 - train_models - INFO -   Hours_per_Quantity: 0.0355
2025-05-23 15:11:36,176 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 15:11:36,177 - train_models - INFO -   NoOfMan_1day_trend: 0.0048
2025-05-23 15:11:36,177 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 15:11:36,178 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:11:36,178 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0020
2025-05-23 15:11:36,178 - train_models - INFO -   Quantity_1day_trend: 0.0013
2025-05-23 15:11:36,178 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0011
2025-05-23 15:11:36,179 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 1: MAE=0.5102, RMSE=0.7135, R²=0.9594, MAPE=9.84%
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 2: MAE=0.4868, RMSE=0.9034, R²=0.9407, MAPE=8.61%
2025-05-23 15:11:36,179 - train_models - INFO -   Fold 3: MAE=0.2380, RMSE=0.3585, R²=0.9795, MAPE=5.42%
2025-05-23 15:11:36,180 - train_models - INFO -   Fold 4: MAE=0.2203, RMSE=0.5000, R²=0.9776, MAPE=5.55%
2025-05-23 15:11:36,180 - train_models - INFO -   Fold 5: MAE=0.2581, RMSE=0.6441, R²=0.9647, MAPE=3.08%
2025-05-23 15:11:36,180 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:11:36,190 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:11:51,397 - train_models - INFO - Model for 217 - MAE: 0.4279, RMSE: 0.6068, R²: 0.9036, MAPE: 16.75%
2025-05-23 15:11:51,398 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:11:51,398 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:11:51,398 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_7day_trend: 0.1903
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_1day_trend: 0.0470
2025-05-23 15:11:51,399 - train_models - INFO -   NoOfMan_lag_7: 0.0377
2025-05-23 15:11:51,399 - train_models - INFO -   Relative_Quantity: 0.0269
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0220
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_lag_1: 0.0211
2025-05-23 15:11:51,400 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0054
2025-05-23 15:11:51,400 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 15:11:51,401 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:11:51,401 - train_models - INFO -   Fold 1: MAE=0.4529, RMSE=0.6113, R²=0.8591, MAPE=22.00%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 2: MAE=0.4674, RMSE=0.7055, R²=0.9020, MAPE=16.27%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 3: MAE=0.3435, RMSE=0.4602, R²=0.9248, MAPE=13.93%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 4: MAE=0.4718, RMSE=0.6481, R²=0.9220, MAPE=17.55%
2025-05-23 15:11:51,402 - train_models - INFO -   Fold 5: MAE=0.4037, RMSE=0.6088, R²=0.9102, MAPE=14.00%
2025-05-23 15:11:51,403 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:11:52,135 - train_models - INFO - Model files saved successfully
2025-05-23 15:11:52,135 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:11:52,138 - train_models - INFO - Model training completed successfully
2025-05-23 15:19:02,679 - train_models - INFO - Starting the model training process
2025-05-23 15:19:02,680 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:19:02,684 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:19:02,822 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (202, 203, 206, 208, 210, 217, 215, 209, 213, 211, 214)
            
2025-05-23 15:19:03,467 - train_models - INFO - Read chunk of 10000 rows
2025-05-23 15:19:03,539 - train_models - INFO - Read chunk of 5476 rows
2025-05-23 15:19:03,557 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-23 15:19:03,559 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:19:03,578 - train_models - INFO - Engineering features...
2025-05-23 15:19:04,147 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:19:04,176 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:19:04,182 - train_models - INFO - Creating lag features...
2025-05-23 15:19:04,193 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:19:04,392 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-23 15:19:04,392 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-23 15:19:04,407 - train_models - INFO - Found 10 unique work types
2025-05-23 15:19:04,407 - train_models - INFO - Building models for 10 work types
2025-05-23 15:19:04,407 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:19:04,408 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:19:04,408 - train_models - INFO - Building model for WorkType: 202
2025-05-23 15:19:04,417 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:19:21,193 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-23 15:19:21,194 - train_models - INFO - Top 10 most important features for 202:
2025-05-23 15:19:21,194 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-23 15:19:21,195 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-23 15:19:21,196 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-23 15:19:21,196 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-23 15:19:21,196 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-23 15:19:21,197 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-23 15:19:21,197 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-23 15:19:21,197 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-23 15:19:21,198 - train_models - INFO - Cross-validation details for 202:
2025-05-23 15:19:21,198 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-23 15:19:21,198 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-23 15:19:21,199 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-23 15:19:21,199 - train_models - INFO - Building model for WorkType: 203
2025-05-23 15:19:21,204 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:19:39,875 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-23 15:19:39,875 - train_models - INFO - Top 10 most important features for 203:
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-23 15:19:39,876 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-23 15:19:39,877 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-23 15:19:39,878 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-23 15:19:39,878 - train_models - INFO - Cross-validation details for 203:
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-23 15:19:39,879 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-23 15:19:39,880 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-23 15:19:39,880 - train_models - INFO - Building model for WorkType: 206
2025-05-23 15:19:39,885 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:05,922 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-23 15:20:05,922 - train_models - INFO - Top 10 most important features for 206:
2025-05-23 15:20:05,923 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-23 15:20:05,923 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-23 15:20:05,923 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-23 15:20:05,924 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-23 15:20:05,924 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-23 15:20:05,924 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-23 15:20:05,925 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-23 15:20:05,925 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-23 15:20:05,925 - train_models - INFO - Cross-validation details for 206:
2025-05-23 15:20:05,925 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-23 15:20:05,926 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-23 15:20:05,927 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-23 15:20:05,927 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:20:05,932 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:24,450 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:20:24,450 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:20:24,451 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:20:24,451 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:20:24,451 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:20:24,452 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:20:24,452 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:20:24,452 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:20:24,453 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:20:24,453 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:20:24,454 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:20:24,454 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:20:24,455 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:20:24,456 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:20:24,456 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:20:24,461 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:20:42,320 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:20:42,320 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:20:42,321 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:20:42,321 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:20:42,321 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:20:42,322 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:20:42,322 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:20:42,323 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:20:42,323 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:20:42,324 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:20:42,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:20:42,324 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:20:42,325 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:20:42,325 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:20:42,326 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:20:42,326 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:20:42,326 - train_models - INFO - Building model for WorkType: 211
2025-05-23 15:20:42,330 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:02,608 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-23 15:21:02,609 - train_models - INFO - Top 10 most important features for 211:
2025-05-23 15:21:02,609 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-23 15:21:02,609 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-23 15:21:02,610 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-23 15:21:02,611 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-23 15:21:02,611 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-23 15:21:02,611 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-23 15:21:02,611 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-23 15:21:02,612 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-23 15:21:02,612 - train_models - INFO - Cross-validation details for 211:
2025-05-23 15:21:02,612 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-23 15:21:02,613 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-23 15:21:02,614 - train_models - INFO - Building model for WorkType: 213
2025-05-23 15:21:02,620 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:21,337 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-23 15:21:21,338 - train_models - INFO - Top 10 most important features for 213:
2025-05-23 15:21:21,338 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-23 15:21:21,339 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-23 15:21:21,340 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-23 15:21:21,341 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-23 15:21:21,341 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-23 15:21:21,341 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-23 15:21:21,342 - train_models - INFO - Cross-validation details for 213:
2025-05-23 15:21:21,342 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-23 15:21:21,342 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-23 15:21:21,343 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-23 15:21:21,343 - train_models - INFO - Building model for WorkType: 214
2025-05-23 15:21:21,350 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:39,209 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-23 15:21:39,210 - train_models - INFO - Top 10 most important features for 214:
2025-05-23 15:21:39,210 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-23 15:21:39,210 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-23 15:21:39,211 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-23 15:21:39,211 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-23 15:21:39,211 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-23 15:21:39,212 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-23 15:21:39,213 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-23 15:21:39,213 - train_models - INFO - Cross-validation details for 214:
2025-05-23 15:21:39,213 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-23 15:21:39,213 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-23 15:21:39,214 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-23 15:21:39,214 - train_models - INFO - Building model for WorkType: 215
2025-05-23 15:21:39,222 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:21:59,873 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-23 15:21:59,874 - train_models - INFO - Top 10 most important features for 215:
2025-05-23 15:21:59,874 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-23 15:21:59,874 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-23 15:21:59,875 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-23 15:21:59,875 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-23 15:21:59,876 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-23 15:21:59,876 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-23 15:21:59,876 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-23 15:21:59,876 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-23 15:21:59,877 - train_models - INFO - Cross-validation details for 215:
2025-05-23 15:21:59,877 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-23 15:21:59,877 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-23 15:21:59,878 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-23 15:21:59,878 - train_models - INFO - Building model for WorkType: 217
2025-05-23 15:21:59,884 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:22:16,425 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-23 15:22:16,426 - train_models - INFO - Top 10 most important features for 217:
2025-05-23 15:22:16,426 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-23 15:22:16,426 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-23 15:22:16,427 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-23 15:22:16,428 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-23 15:22:16,428 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-23 15:22:16,428 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-23 15:22:16,429 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-23 15:22:16,429 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-23 15:22:16,429 - train_models - INFO - Cross-validation details for 217:
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-23 15:22:16,430 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-23 15:22:16,431 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-23 15:22:16,431 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-23 15:22:16,431 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-23 15:22:17,131 - train_models - INFO - Model files saved successfully
2025-05-23 15:22:17,132 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:22:17,134 - train_models - INFO - Model training completed successfully
2025-05-23 15:26:42,577 - train_models - INFO - Starting the model training process
2025-05-23 15:26:42,577 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:26:42,581 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:26:42,700 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:26:43,142 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:26:43,159 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:26:43,160 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:26:43,170 - train_models - INFO - Engineering features...
2025-05-23 15:26:43,566 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:26:43,580 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:26:43,582 - train_models - INFO - Creating lag features...
2025-05-23 15:26:43,588 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:26:43,669 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:26:43,669 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:26:43,673 - train_models - INFO - Found 2 unique work types
2025-05-23 15:26:43,673 - train_models - INFO - Building models for 2 work types
2025-05-23 15:26:43,674 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:26:43,674 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:26:43,674 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:26:43,678 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:27:01,247 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:27:01,248 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:27:01,248 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:27:01,248 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:27:01,249 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:27:01,249 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:27:01,249 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:27:01,250 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:27:01,251 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:27:01,251 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:27:01,251 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:27:01,252 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:27:01,253 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:27:01,253 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:27:01,258 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:27:18,108 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:27:18,109 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:27:18,109 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:27:18,109 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:27:18,110 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:27:18,110 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:27:18,110 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:27:18,110 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:27:18,111 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:27:18,111 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:27:18,112 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:27:18,112 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:27:18,112 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:27:18,113 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:27:18,114 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:27:18,480 - train_models - INFO - Model files saved successfully
2025-05-23 15:27:18,480 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:27:18,481 - train_models - INFO - Model training completed successfully
2025-05-23 15:32:53,958 - train_models - INFO - Starting the model training process
2025-05-23 15:32:53,959 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:32:53,963 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:32:54,099 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:32:54,529 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:32:54,545 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:32:54,546 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:32:54,554 - train_models - INFO - Engineering features...
2025-05-23 15:32:55,046 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:32:55,058 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:32:55,061 - train_models - INFO - Creating lag features...
2025-05-23 15:32:55,067 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:32:55,140 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:32:55,140 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:32:55,143 - train_models - INFO - Found 2 unique work types
2025-05-23 15:32:55,143 - train_models - INFO - Building models for 2 work types
2025-05-23 15:32:55,143 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:32:55,144 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:32:55,144 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:32:55,216 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:33:13,702 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:33:13,702 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:33:13,702 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:33:13,703 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:33:13,703 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:33:13,703 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:33:13,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:33:13,704 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:33:13,705 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:33:13,705 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:33:13,705 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:33:13,706 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:33:13,706 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:33:13,706 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:33:13,764 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:33:32,425 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:33:32,426 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:33:32,426 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:33:32,426 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:33:32,427 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:33:32,427 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:33:32,427 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:33:32,427 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:33:32,428 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:33:32,428 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:33:32,429 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:33:32,429 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:33:32,430 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:33:32,803 - train_models - INFO - Model files saved successfully
2025-05-23 15:33:32,804 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:33:32,804 - train_models - INFO - Model training completed successfully
2025-05-23 15:36:22,455 - train_models - INFO - Starting the model training process
2025-05-23 15:36:22,456 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:36:22,461 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:36:22,581 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (210,  209)
            
2025-05-23 15:36:23,019 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 15:36:23,036 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 15:36:23,038 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:36:23,051 - train_models - INFO - Engineering features...
2025-05-23 15:36:23,560 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:36:23,576 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:36:23,578 - train_models - INFO - Creating lag features...
2025-05-23 15:36:23,584 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:36:23,664 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 15:36:23,664 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 15:36:23,666 - train_models - INFO - Found 2 unique work types
2025-05-23 15:36:23,667 - train_models - INFO - Building models for 2 work types
2025-05-23 15:36:23,667 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:36:23,667 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:36:23,667 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:36:25,401 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:36:45,384 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:36:45,385 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:36:45,385 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:36:45,385 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:36:45,385 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:36:45,385 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:36:45,386 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:36:45,386 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:36:45,386 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:36:45,387 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:36:45,388 - train_models - INFO - Building model for WorkType: 210
2025-05-23 15:36:46,818 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:37:10,065 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 15:37:10,066 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 15:37:10,066 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 15:37:10,066 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 15:37:10,066 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 15:37:10,066 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 15:37:10,067 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 15:37:10,067 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 15:37:10,068 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 15:37:10,068 - train_models - INFO - Cross-validation details for 210:
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 15:37:10,068 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 15:37:10,069 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 15:37:10,069 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 15:37:10,069 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 15:37:10,178 - train_models - INFO - Model files saved successfully
2025-05-23 15:37:10,178 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:37:10,179 - train_models - INFO - Model training completed successfully
2025-05-23 15:38:47,816 - train_models - INFO - Starting the model training process
2025-05-23 15:38:47,816 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:38:47,821 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:38:47,934 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:38:48,440 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:38:48,458 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:38:48,460 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:38:48,467 - train_models - INFO - Engineering features...
2025-05-23 15:38:48,960 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:38:48,975 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:38:48,977 - train_models - INFO - Creating lag features...
2025-05-23 15:38:48,983 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:38:49,065 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:38:49,066 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:38:49,068 - train_models - INFO - Found 1 unique work types
2025-05-23 15:38:49,068 - train_models - INFO - Building models for 1 work types
2025-05-23 15:38:49,069 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:38:49,069 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:38:49,069 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:38:49,427 - train_models - ERROR - Error building models: [Errno 13] Permission denied: 'work_type_data_All.xlsx'
2025-05-23 15:38:49,722 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 157, in build_models
    work_type_data.to_excel('work_type_data_All.xlsx', index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'work_type_data_All.xlsx'

2025-05-23 15:38:49,727 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:38:49,738 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:38:49,802 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 420, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:38:49,803 - train_models - INFO - Model training completed successfully
2025-05-23 15:38:57,733 - train_models - INFO - Starting the model training process
2025-05-23 15:38:57,734 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:38:57,738 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:38:57,849 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:38:58,229 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:38:58,245 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:38:58,246 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:38:58,252 - train_models - INFO - Engineering features...
2025-05-23 15:38:58,670 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:38:58,681 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:38:58,683 - train_models - INFO - Creating lag features...
2025-05-23 15:38:58,689 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:38:58,750 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:38:58,751 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:38:58,754 - train_models - INFO - Found 1 unique work types
2025-05-23 15:38:58,754 - train_models - INFO - Building models for 1 work types
2025-05-23 15:38:58,755 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:38:58,755 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:38:58,755 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:39:00,223 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:39:21,017 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 15:39:21,018 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 15:39:21,018 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 15:39:21,018 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 15:39:21,018 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 15:39:21,018 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 15:39:21,019 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 15:39:21,020 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 15:39:21,020 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 15:39:21,020 - train_models - INFO - Cross-validation details for 209:
2025-05-23 15:39:21,020 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 15:39:21,020 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 15:39:21,021 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 15:39:21,022 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-23 15:39:21,099 - train_models - INFO - Model files saved successfully
2025-05-23 15:39:21,100 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:39:21,101 - train_models - INFO - Model training completed successfully
2025-05-23 15:46:50,296 - train_models - INFO - Starting the model training process
2025-05-23 15:46:50,297 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:46:50,301 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:46:50,426 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:46:50,822 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:46:50,837 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:46:50,838 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:46:50,847 - train_models - INFO - Engineering features...
2025-05-23 15:46:51,322 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:46:51,340 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:46:51,343 - train_models - INFO - Creating lag features...
2025-05-23 15:46:51,349 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:46:51,418 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:46:51,420 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:46:51,427 - train_models - INFO - Found 1 unique work types
2025-05-23 15:46:51,428 - train_models - INFO - Building models for 1 work types
2025-05-23 15:46:51,428 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:46:51,429 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:46:51,429 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:46:53,199 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:46:53,201 - train_models - ERROR - Error building models: [Errno 13] Permission denied: 'work_type_data.xlsx'
2025-05-23 15:46:53,206 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 169, in build_models
    work_type_data.to_excel('work_type_data.xlsx', index=False)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 61, in __init__
    super().__init__(
    ~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<3 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1246, in __init__
    self._handles = get_handle(
                    ~~~~~~~~~~^
        path, mode, storage_options=storage_options, is_text=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
PermissionError: [Errno 13] Permission denied: 'work_type_data.xlsx'

2025-05-23 15:46:53,207 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:46:53,214 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:46:53,219 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 421, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:46:53,219 - train_models - INFO - Model training completed successfully
2025-05-23 15:47:03,800 - train_models - INFO - Starting the model training process
2025-05-23 15:47:03,801 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:47:03,804 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:47:03,917 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:47:04,299 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:47:04,316 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:47:04,317 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:47:04,329 - train_models - INFO - Engineering features...
2025-05-23 15:47:04,734 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:47:04,747 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:47:04,749 - train_models - INFO - Creating lag features...
2025-05-23 15:47:04,754 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:47:04,817 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:47:04,817 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:47:04,819 - train_models - INFO - Found 1 unique work types
2025-05-23 15:47:04,819 - train_models - INFO - Building models for 1 work types
2025-05-23 15:47:04,819 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:47:04,819 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:47:04,820 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:47:06,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:47:07,606 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:47:07,692 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 204, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:47:07,693 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:47:07,694 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:47:07,699 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 421, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:47:07,699 - train_models - INFO - Model training completed successfully
2025-05-23 15:48:35,458 - train_models - INFO - Starting the model training process
2025-05-23 15:48:35,458 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:48:35,461 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:48:35,582 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:48:35,966 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:48:35,989 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:48:35,991 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:48:35,999 - train_models - INFO - Engineering features...
2025-05-23 15:48:36,404 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:48:36,415 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:48:36,417 - train_models - INFO - Creating lag features...
2025-05-23 15:48:36,424 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:48:36,485 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:48:36,486 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:48:36,487 - train_models - INFO - Found 1 unique work types
2025-05-23 15:48:36,488 - train_models - INFO - Building models for 1 work types
2025-05-23 15:48:36,488 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:48:36,488 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:48:36,488 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:48:38,019 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:48:39,347 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:48:39,359 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:48:39,360 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:48:39,363 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:48:39,369 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 422, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:48:39,370 - train_models - INFO - Model training completed successfully
2025-05-23 15:49:04,529 - train_models - INFO - Starting the model training process
2025-05-23 15:49:04,529 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:49:04,536 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:49:04,667 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:49:05,043 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:49:05,059 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:49:05,061 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:49:05,071 - train_models - INFO - Engineering features...
2025-05-23 15:49:05,500 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:49:05,514 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:49:05,517 - train_models - INFO - Creating lag features...
2025-05-23 15:49:05,523 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:49:05,591 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:49:05,592 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:49:05,595 - train_models - INFO - Found 1 unique work types
2025-05-23 15:49:05,595 - train_models - INFO - Building models for 1 work types
2025-05-23 15:49:05,595 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:49:05,596 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:49:05,596 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:49:07,159 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:49:08,548 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:49:08,549 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:49:08,550 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:49:08,552 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:49:08,639 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 422, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:49:08,640 - train_models - INFO - Model training completed successfully
2025-05-23 15:54:45,561 - train_models - INFO - Starting the model training process
2025-05-23 15:54:45,561 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:54:45,566 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:54:45,684 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:54:45,995 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:54:46,011 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:54:46,013 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:54:46,022 - train_models - INFO - Engineering features...
2025-05-23 15:54:46,512 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:54:46,525 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:54:46,526 - train_models - INFO - Creating lag features...
2025-05-23 15:54:46,535 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:54:46,595 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:54:46,595 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:54:46,597 - train_models - INFO - Found 1 unique work types
2025-05-23 15:54:46,597 - train_models - INFO - Building models for 1 work types
2025-05-23 15:54:46,598 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:54:46,598 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:54:46,599 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:54:48,179 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:54:49,463 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:54:49,465 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:54:49,466 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:54:49,468 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:54:49,473 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:54:49,474 - train_models - INFO - Model training completed successfully
2025-05-23 15:55:54,805 - train_models - INFO - Starting the model training process
2025-05-23 15:55:54,805 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:55:54,809 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:55:54,927 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:55:55,298 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:55:55,315 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:55:55,317 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:55:55,327 - train_models - INFO - Engineering features...
2025-05-23 15:55:55,758 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:55:55,771 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:55:55,773 - train_models - INFO - Creating lag features...
2025-05-23 15:55:55,780 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:55:55,848 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:55:55,849 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:55:55,851 - train_models - INFO - Found 1 unique work types
2025-05-23 15:55:55,851 - train_models - INFO - Building models for 1 work types
2025-05-23 15:55:55,851 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:55:55,852 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:55:55,852 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:55:57,413 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:55:58,911 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:55:58,913 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:55:58,913 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:55:58,914 - train_models - ERROR - Error saving models: DataFrame constructor not properly called!
2025-05-23 15:55:58,917 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 420, in save_models
    performance_df = pd.DataFrame('COLXX', performance_summary)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 886, in __init__
    raise ValueError("DataFrame constructor not properly called!")
ValueError: DataFrame constructor not properly called!

2025-05-23 15:55:58,918 - train_models - INFO - Model training completed successfully
2025-05-23 15:56:35,718 - train_models - INFO - Starting the model training process
2025-05-23 15:56:35,718 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:56:35,724 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:56:35,837 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:56:36,213 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:56:36,229 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:56:36,230 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:56:36,238 - train_models - INFO - Engineering features...
2025-05-23 15:56:36,648 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:56:36,661 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:56:36,663 - train_models - INFO - Creating lag features...
2025-05-23 15:56:36,672 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:56:36,732 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:56:36,732 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:56:36,735 - train_models - INFO - Found 1 unique work types
2025-05-23 15:56:36,735 - train_models - INFO - Building models for 1 work types
2025-05-23 15:56:36,736 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:56:36,736 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:56:36,736 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:56:38,193 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:56:39,624 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:56:39,627 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:56:39,628 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:56:39,632 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:56:39,639 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:56:39,640 - train_models - INFO - Model training completed successfully
2025-05-23 15:58:07,011 - train_models - INFO - Starting the model training process
2025-05-23 15:58:07,011 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:58:07,015 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:58:07,130 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:58:07,501 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:58:07,517 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:58:07,518 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:58:07,529 - train_models - INFO - Engineering features...
2025-05-23 15:58:07,922 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:58:07,933 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:58:07,935 - train_models - INFO - Creating lag features...
2025-05-23 15:58:07,944 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:58:08,002 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:58:08,003 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:58:08,005 - train_models - INFO - Found 1 unique work types
2025-05-23 15:58:08,005 - train_models - INFO - Building models for 1 work types
2025-05-23 15:58:08,005 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:58:08,006 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:58:08,006 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:58:09,486 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:58:10,913 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:58:10,915 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:58:10,915 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:58:10,918 - train_models - ERROR - Error saving models: 'R²'
2025-05-23 15:58:10,923 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 423, in save_models
    performance_df = pd.DataFrame(performance_summary).sort_values('R²', ascending=False)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 7189, in sort_values
    k = self._get_label_or_level_values(by[0], axis=axis)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 1911, in _get_label_or_level_values
    raise KeyError(key)
KeyError: 'R²'

2025-05-23 15:58:10,924 - train_models - INFO - Model training completed successfully
2025-05-23 15:58:58,171 - train_models - INFO - Starting the model training process
2025-05-23 15:58:58,171 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:58:58,174 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:58:58,291 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:58:58,669 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:58:58,685 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:58:58,686 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:58:58,693 - train_models - INFO - Engineering features...
2025-05-23 15:58:59,085 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:58:59,098 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:58:59,100 - train_models - INFO - Creating lag features...
2025-05-23 15:58:59,108 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:58:59,177 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:58:59,177 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:58:59,180 - train_models - INFO - Found 1 unique work types
2025-05-23 15:58:59,180 - train_models - INFO - Building models for 1 work types
2025-05-23 15:58:59,180 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:58:59,180 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:58:59,181 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:00,699 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:02,106 - train_models - ERROR - Error building models: 'ColumnTransformer' object has no attribute 'to_excel'
2025-05-23 15:59:02,108 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 179, in build_models
    preprocessor.to_excel('work_type_data.xlsx', index=False)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ColumnTransformer' object has no attribute 'to_excel'

2025-05-23 15:59:02,109 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:02,130 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:02,131 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:02,131 - train_models - INFO - Model training completed successfully
2025-05-23 15:59:40,349 - train_models - INFO - Starting the model training process
2025-05-23 15:59:40,350 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:59:40,353 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:59:40,472 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:59:40,691 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:59:40,706 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:59:40,708 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:59:40,718 - train_models - INFO - Engineering features...
2025-05-23 15:59:41,124 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:59:41,138 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:59:41,141 - train_models - INFO - Creating lag features...
2025-05-23 15:59:41,148 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:59:41,212 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:59:41,213 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:59:41,215 - train_models - INFO - Found 1 unique work types
2025-05-23 15:59:41,215 - train_models - INFO - Building models for 1 work types
2025-05-23 15:59:41,216 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:59:41,216 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:59:41,216 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:42,760 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:44,153 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:59:44,220 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:59:44,222 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:44,233 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:44,234 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:44,234 - train_models - INFO - Model training completed successfully
2025-05-23 15:59:52,712 - train_models - INFO - Starting the model training process
2025-05-23 15:59:52,712 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 15:59:52,717 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 15:59:52,836 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 15:59:53,241 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 15:59:53,258 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 15:59:53,259 - train_models - INFO - Converting Date column to datetime format
2025-05-23 15:59:53,268 - train_models - INFO - Engineering features...
2025-05-23 15:59:53,687 - utils.feature_engineering - INFO - Engineering features
2025-05-23 15:59:53,700 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 15:59:53,702 - train_models - INFO - Creating lag features...
2025-05-23 15:59:53,707 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 15:59:53,775 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 15:59:53,775 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 15:59:53,778 - train_models - INFO - Found 1 unique work types
2025-05-23 15:59:53,778 - train_models - INFO - Building models for 1 work types
2025-05-23 15:59:53,779 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 15:59:53,779 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 15:59:53,779 - train_models - INFO - Building model for WorkType: 209
2025-05-23 15:59:55,236 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 15:59:56,650 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 15:59:56,655 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 15:59:56,656 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 15:59:56,670 - train_models - INFO - Model files saved successfully
2025-05-23 15:59:56,671 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 15:59:56,672 - train_models - INFO - Model training completed successfully
2025-05-23 16:02:19,139 - train_models - INFO - Starting the model training process
2025-05-23 16:02:19,139 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:02:19,143 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:02:19,262 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:02:19,653 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:02:19,669 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:02:19,670 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:02:19,682 - train_models - INFO - Engineering features...
2025-05-23 16:02:20,083 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:02:20,097 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:02:20,099 - train_models - INFO - Creating lag features...
2025-05-23 16:02:20,108 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:02:20,179 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:02:20,179 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:02:20,181 - train_models - INFO - Found 1 unique work types
2025-05-23 16:02:20,181 - train_models - INFO - Building models for 1 work types
2025-05-23 16:02:20,182 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:02:20,182 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:02:20,182 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:02:21,883 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:02:23,211 - train_models - ERROR - Error building models: float() argument must be a string or a real number, not 'Timestamp'
2025-05-23 16:02:23,217 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 202, in build_models
    pipeline.fit(X_train, y_train)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\pipeline.py", line 662, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\ensemble\_forest.py", line 360, in fit
    X, y = validate_data(
           ~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<5 lines>...
        ensure_all_finite=False,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        X,
    ...<12 lines>...
        input_name="X",
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\sklearn\utils\_array_api.py", line 839, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
TypeError: float() argument must be a string or a real number, not 'Timestamp'

2025-05-23 16:02:23,218 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-23 16:02:23,230 - train_models - INFO - Model files saved successfully
2025-05-23 16:02:23,230 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:02:23,231 - train_models - INFO - Model training completed successfully
2025-05-23 16:05:32,389 - train_models - INFO - Starting the model training process
2025-05-23 16:05:32,390 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:05:32,393 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:05:32,511 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:05:32,935 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:05:32,950 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:05:32,951 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:05:32,956 - train_models - INFO - Engineering features...
2025-05-23 16:05:33,525 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:05:33,539 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:05:33,542 - train_models - INFO - Creating lag features...
2025-05-23 16:05:33,551 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:05:33,627 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:05:33,627 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:05:33,630 - train_models - INFO - Found 1 unique work types
2025-05-23 16:05:33,630 - train_models - INFO - Building models for 1 work types
2025-05-23 16:05:33,630 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:05:33,631 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:05:33,631 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:05:35,371 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:05:45,770 - train_models - INFO - Starting the model training process
2025-05-23 16:05:45,770 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:05:45,773 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:05:45,885 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:05:46,254 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:05:46,271 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:05:46,273 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:05:46,284 - train_models - INFO - Engineering features...
2025-05-23 16:05:46,674 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:05:46,686 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:05:46,689 - train_models - INFO - Creating lag features...
2025-05-23 16:05:46,695 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:05:46,754 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:05:46,754 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:05:46,756 - train_models - INFO - Found 1 unique work types
2025-05-23 16:05:46,757 - train_models - INFO - Building models for 1 work types
2025-05-23 16:05:46,757 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:05:46,757 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:05:46,758 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:05:48,331 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:06:16,403 - train_models - INFO - Starting the model training process
2025-05-23 16:06:16,404 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:06:16,407 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:06:16,527 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-23 16:06:16,891 - train_models - INFO - Read chunk of 1526 rows
2025-05-23 16:06:16,908 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-23 16:06:16,910 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:06:16,921 - train_models - INFO - Engineering features...
2025-05-23 16:06:17,329 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:06:17,340 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:06:17,342 - train_models - INFO - Creating lag features...
2025-05-23 16:06:17,350 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:06:17,414 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-23 16:06:17,415 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-23 16:06:17,417 - train_models - INFO - Found 1 unique work types
2025-05-23 16:06:17,417 - train_models - INFO - Building models for 1 work types
2025-05-23 16:06:17,417 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:06:17,418 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:06:17,418 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:06:18,837 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:06:37,375 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 16:06:37,376 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 16:06:37,376 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 16:06:37,376 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 16:06:37,377 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 16:06:37,377 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 16:06:37,377 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 16:06:37,378 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 16:06:37,379 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 16:06:37,379 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 16:06:37,379 - train_models - INFO - Cross-validation details for 209:
2025-05-23 16:06:37,379 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 16:06:37,380 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 16:06:37,381 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-23 16:06:37,437 - train_models - INFO - Model files saved successfully
2025-05-23 16:06:37,437 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:06:37,437 - train_models - INFO - Model training completed successfully
2025-05-23 16:07:32,751 - train_models - INFO - Starting the model training process
2025-05-23 16:07:32,752 - train_models - INFO - Training from SQL database (command line argument)
2025-05-23 16:07:32,756 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-23 16:07:32,870 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-23 16:07:33,307 - train_models - INFO - Read chunk of 3052 rows
2025-05-23 16:07:33,323 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-23 16:07:33,324 - train_models - INFO - Converting Date column to datetime format
2025-05-23 16:07:33,334 - train_models - INFO - Engineering features...
2025-05-23 16:07:33,733 - utils.feature_engineering - INFO - Engineering features
2025-05-23 16:07:33,745 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-23 16:07:33,748 - train_models - INFO - Creating lag features...
2025-05-23 16:07:33,757 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-23 16:07:33,829 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-23 16:07:33,829 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-23 16:07:33,831 - train_models - INFO - Found 2 unique work types
2025-05-23 16:07:33,832 - train_models - INFO - Building models for 2 work types
2025-05-23 16:07:33,832 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-23 16:07:33,832 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-23 16:07:33,833 - train_models - INFO - Building model for WorkType: 209
2025-05-23 16:07:35,271 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:07:53,929 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-23 16:07:53,929 - train_models - INFO - Top 10 most important features for 209:
2025-05-23 16:07:53,929 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-23 16:07:53,930 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-23 16:07:53,930 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-23 16:07:53,931 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-23 16:07:53,931 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-23 16:07:53,932 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-23 16:07:53,932 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-23 16:07:53,932 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-23 16:07:53,933 - train_models - INFO - Cross-validation details for 209:
2025-05-23 16:07:53,933 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-23 16:07:53,933 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-23 16:07:53,934 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-23 16:07:53,934 - train_models - INFO - Building model for WorkType: 210
2025-05-23 16:07:55,218 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-23 16:08:13,398 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-23 16:08:13,398 - train_models - INFO - Top 10 most important features for 210:
2025-05-23 16:08:13,399 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-23 16:08:13,399 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-23 16:08:13,399 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-23 16:08:13,399 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-23 16:08:13,400 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-23 16:08:13,400 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-23 16:08:13,400 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-23 16:08:13,401 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-23 16:08:13,401 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-23 16:08:13,401 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-23 16:08:13,402 - train_models - INFO - Cross-validation details for 210:
2025-05-23 16:08:13,402 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-23 16:08:13,402 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-23 16:08:13,403 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-23 16:08:13,404 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-23 16:08:13,540 - train_models - INFO - Model files saved successfully
2025-05-23 16:08:13,540 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-23 16:08:13,541 - train_models - INFO - Model training completed successfully
2025-05-25 10:24:24,286 - train_models - INFO - Starting the model training process
2025-05-25 10:24:24,288 - train_models - INFO - Training from SQL database (command line argument)
2025-05-25 10:24:24,295 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-25 10:24:24,617 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-25 10:24:25,424 - train_models - INFO - Read chunk of 10000 rows
2025-05-25 10:24:25,524 - train_models - INFO - Read chunk of 5476 rows
2025-05-25 10:24:25,587 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-25 10:24:25,591 - train_models - INFO - Converting Date column to datetime format
2025-05-25 10:24:25,613 - train_models - INFO - Engineering features...
2025-05-25 10:24:26,548 - utils.feature_engineering - INFO - Engineering features
2025-05-25 10:24:26,619 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-25 10:24:26,627 - train_models - INFO - Creating lag features...
2025-05-25 10:24:26,647 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-25 10:24:27,056 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-25 10:24:27,056 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-25 10:24:27,075 - train_models - INFO - Found 10 unique work types
2025-05-25 10:24:27,076 - train_models - INFO - Building models for 10 work types
2025-05-25 10:24:27,076 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-25 10:24:27,077 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-25 10:24:27,077 - train_models - INFO - Building model for WorkType: 202
2025-05-25 10:24:30,643 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:25:10,714 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-25 10:25:10,715 - train_models - INFO - Top 10 most important features for 202:
2025-05-25 10:25:10,715 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-25 10:25:10,715 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-25 10:25:10,716 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-25 10:25:10,716 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-25 10:25:10,717 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-25 10:25:10,717 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-25 10:25:10,717 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-25 10:25:10,718 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-25 10:25:10,718 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-25 10:25:10,719 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-25 10:25:10,719 - train_models - INFO - Cross-validation details for 202:
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-25 10:25:10,720 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-25 10:25:10,721 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-25 10:25:10,722 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-25 10:25:10,722 - train_models - INFO - Building model for WorkType: 203
2025-05-25 10:25:13,742 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:26:01,202 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-25 10:26:01,203 - train_models - INFO - Top 10 most important features for 203:
2025-05-25 10:26:01,203 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-25 10:26:01,204 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-25 10:26:01,204 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-25 10:26:01,205 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-25 10:26:01,206 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-25 10:26:01,206 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-25 10:26:01,207 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-25 10:26:01,208 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-25 10:26:01,208 - train_models - INFO - Cross-validation details for 203:
2025-05-25 10:26:01,208 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-25 10:26:01,209 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-25 10:26:01,210 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-25 10:26:01,210 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-25 10:26:01,211 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-25 10:26:01,212 - train_models - INFO - Building model for WorkType: 206
2025-05-25 10:26:05,050 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:27:06,531 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-25 10:27:06,532 - train_models - INFO - Top 10 most important features for 206:
2025-05-25 10:27:06,532 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-25 10:27:06,533 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-25 10:27:06,533 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-25 10:27:06,534 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-25 10:27:06,534 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-25 10:27:06,535 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-25 10:27:06,535 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-25 10:27:06,536 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-25 10:27:06,536 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-25 10:27:06,537 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-25 10:27:06,537 - train_models - INFO - Cross-validation details for 206:
2025-05-25 10:27:06,538 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-25 10:27:06,538 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-25 10:27:06,539 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-25 10:27:06,539 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-25 10:27:06,540 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-25 10:27:06,540 - train_models - INFO - Building model for WorkType: 209
2025-05-25 10:27:09,530 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:27:55,158 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-25 10:27:55,159 - train_models - INFO - Top 10 most important features for 209:
2025-05-25 10:27:55,160 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-25 10:27:55,160 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-25 10:27:55,160 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-25 10:27:55,161 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-25 10:27:55,161 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-25 10:27:55,162 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-25 10:27:55,162 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-25 10:27:55,163 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-25 10:27:55,164 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-25 10:27:55,164 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-25 10:27:55,166 - train_models - INFO - Cross-validation details for 209:
2025-05-25 10:27:55,166 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-25 10:27:55,167 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-25 10:27:55,168 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-25 10:27:55,168 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-25 10:27:55,169 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-25 10:27:55,169 - train_models - INFO - Building model for WorkType: 210
2025-05-25 10:27:58,213 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:28:41,387 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-25 10:28:41,388 - train_models - INFO - Top 10 most important features for 210:
2025-05-25 10:28:41,388 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-25 10:28:41,388 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-25 10:28:41,389 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-25 10:28:41,389 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-25 10:28:41,390 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-25 10:28:41,390 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-25 10:28:41,391 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-25 10:28:41,391 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-25 10:28:41,392 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-25 10:28:41,392 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-25 10:28:41,392 - train_models - INFO - Cross-validation details for 210:
2025-05-25 10:28:41,393 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-25 10:28:41,393 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-25 10:28:41,394 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-25 10:28:41,394 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-25 10:28:41,395 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-25 10:28:41,395 - train_models - INFO - Building model for WorkType: 211
2025-05-25 10:28:44,399 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:29:31,855 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-25 10:29:31,856 - train_models - INFO - Top 10 most important features for 211:
2025-05-25 10:29:31,857 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-25 10:29:31,857 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-25 10:29:31,857 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-25 10:29:31,858 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-25 10:29:31,858 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-25 10:29:31,859 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-25 10:29:31,859 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-25 10:29:31,860 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-25 10:29:31,860 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-25 10:29:31,861 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-25 10:29:31,861 - train_models - INFO - Cross-validation details for 211:
2025-05-25 10:29:31,861 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-25 10:29:31,862 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-25 10:29:31,862 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-25 10:29:31,863 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-25 10:29:31,863 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-25 10:29:31,864 - train_models - INFO - Building model for WorkType: 213
2025-05-25 10:29:34,581 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:30:18,617 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-25 10:30:18,617 - train_models - INFO - Top 10 most important features for 213:
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-25 10:30:18,618 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-25 10:30:18,619 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-25 10:30:18,620 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-25 10:30:18,620 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-25 10:30:18,621 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-25 10:30:18,621 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-25 10:30:18,622 - train_models - INFO - Cross-validation details for 213:
2025-05-25 10:30:18,622 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-25 10:30:18,623 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-25 10:30:18,623 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-25 10:30:18,624 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-25 10:30:18,624 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-25 10:30:18,625 - train_models - INFO - Building model for WorkType: 214
2025-05-25 10:30:21,330 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:31:03,279 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-25 10:31:03,280 - train_models - INFO - Top 10 most important features for 214:
2025-05-25 10:31:03,280 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-25 10:31:03,281 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-25 10:31:03,281 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-25 10:31:03,282 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-25 10:31:03,282 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-25 10:31:03,283 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-25 10:31:03,283 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-25 10:31:03,284 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-25 10:31:03,284 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-25 10:31:03,285 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-25 10:31:03,285 - train_models - INFO - Cross-validation details for 214:
2025-05-25 10:31:03,285 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-25 10:31:03,286 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-25 10:31:03,286 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-25 10:31:03,287 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-25 10:31:03,287 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-25 10:31:03,288 - train_models - INFO - Building model for WorkType: 215
2025-05-25 10:31:07,075 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:31:57,833 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-25 10:31:57,834 - train_models - INFO - Top 10 most important features for 215:
2025-05-25 10:31:57,835 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-25 10:31:57,835 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-25 10:31:57,835 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-25 10:31:57,836 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-25 10:31:57,836 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-25 10:31:57,837 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-25 10:31:57,837 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-25 10:31:57,838 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-25 10:31:57,838 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-25 10:31:57,839 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-25 10:31:57,839 - train_models - INFO - Cross-validation details for 215:
2025-05-25 10:31:57,840 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-25 10:31:57,840 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-25 10:31:57,841 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-25 10:31:57,841 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-25 10:31:57,842 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-25 10:31:57,842 - train_models - INFO - Building model for WorkType: 217
2025-05-25 10:32:00,383 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 10:32:37,697 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-25 10:32:37,697 - train_models - INFO - Top 10 most important features for 217:
2025-05-25 10:32:37,698 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-25 10:32:37,698 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-25 10:32:37,699 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-25 10:32:37,699 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-25 10:32:37,700 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-25 10:32:37,700 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-25 10:32:37,700 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-25 10:32:37,701 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-25 10:32:37,701 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-25 10:32:37,702 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-25 10:32:37,702 - train_models - INFO - Cross-validation details for 217:
2025-05-25 10:32:37,703 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-25 10:32:37,703 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-25 10:32:37,704 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-25 10:32:37,704 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-25 10:32:37,705 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-25 10:32:37,706 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-25 10:32:38,461 - train_models - INFO - Model files saved successfully
2025-05-25 10:32:38,461 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-25 10:32:38,468 - train_models - INFO - Model training completed successfully
2025-05-25 12:13:02,083 - train_models - INFO - Starting the model training process
2025-05-25 12:13:02,084 - train_models - INFO - Training from SQL database (command line argument)
2025-05-25 12:13:02,091 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-25 12:13:02,385 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-25 12:13:03,246 - train_models - INFO - Read chunk of 10000 rows
2025-05-25 12:13:03,358 - train_models - INFO - Read chunk of 5476 rows
2025-05-25 12:13:03,404 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-25 12:13:03,406 - train_models - INFO - Converting Date column to datetime format
2025-05-25 12:13:03,431 - train_models - INFO - Engineering features...
2025-05-25 12:13:04,389 - utils.feature_engineering - INFO - Engineering features
2025-05-25 12:13:04,456 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-25 12:13:04,465 - train_models - INFO - Creating lag features...
2025-05-25 12:13:04,484 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-25 12:13:04,921 - utils.feature_engineering - INFO - Lag features created. Dropped 3655 rows with NaN values.
2025-05-25 12:13:04,922 - utils.feature_engineering - INFO - Final shape: (11821, 72)
2025-05-25 12:13:04,951 - train_models - INFO - Found 10 unique work types
2025-05-25 12:13:04,952 - train_models - INFO - Building models for 10 work types
2025-05-25 12:13:04,952 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-25 12:13:04,953 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-25 12:13:04,953 - train_models - INFO - Building model for WorkType: 202
2025-05-25 12:13:08,333 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:13:48,103 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-25 12:13:48,104 - train_models - INFO - Top 10 most important features for 202:
2025-05-25 12:13:48,104 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-25 12:13:48,105 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-25 12:13:48,105 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-25 12:13:48,106 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-25 12:13:48,107 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-25 12:13:48,107 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-25 12:13:48,108 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-25 12:13:48,108 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-25 12:13:48,109 - train_models - INFO - Cross-validation details for 202:
2025-05-25 12:13:48,109 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-25 12:13:48,110 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-25 12:13:48,110 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-25 12:13:48,111 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-25 12:13:48,111 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-25 12:13:48,111 - train_models - INFO - Building model for WorkType: 203
2025-05-25 12:13:51,090 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:14:33,027 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-25 12:14:33,028 - train_models - INFO - Top 10 most important features for 203:
2025-05-25 12:14:33,028 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-25 12:14:33,028 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-25 12:14:33,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-25 12:14:33,030 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-25 12:14:33,031 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-25 12:14:33,031 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-25 12:14:33,032 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-25 12:14:33,032 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-25 12:14:33,033 - train_models - INFO - Cross-validation details for 203:
2025-05-25 12:14:33,033 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-25 12:14:33,033 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-25 12:14:33,034 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-25 12:14:33,034 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-25 12:14:33,035 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-25 12:14:33,035 - train_models - INFO - Building model for WorkType: 206
2025-05-25 12:14:36,681 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:15:33,452 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-25 12:15:33,453 - train_models - INFO - Top 10 most important features for 206:
2025-05-25 12:15:33,453 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-25 12:15:33,454 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-25 12:15:33,454 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-25 12:15:33,455 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-25 12:15:33,455 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-25 12:15:33,456 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-25 12:15:33,456 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-25 12:15:33,457 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-25 12:15:33,457 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-25 12:15:33,457 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-25 12:15:33,458 - train_models - INFO - Cross-validation details for 206:
2025-05-25 12:15:33,458 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-25 12:15:33,459 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-25 12:15:33,459 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-25 12:15:33,460 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-25 12:15:33,460 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-25 12:15:33,461 - train_models - INFO - Building model for WorkType: 209
2025-05-25 12:15:36,242 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:16:20,311 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-25 12:16:20,312 - train_models - INFO - Top 10 most important features for 209:
2025-05-25 12:16:20,312 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-25 12:16:20,312 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-25 12:16:20,313 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-25 12:16:20,313 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-25 12:16:20,314 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-25 12:16:20,314 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-25 12:16:20,315 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-25 12:16:20,316 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-25 12:16:20,316 - train_models - INFO - Cross-validation details for 209:
2025-05-25 12:16:20,317 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-25 12:16:20,317 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-25 12:16:20,318 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-25 12:16:20,318 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-25 12:16:20,319 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-25 12:16:20,319 - train_models - INFO - Building model for WorkType: 210
2025-05-25 12:16:23,230 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:17:05,585 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-25 12:17:05,585 - train_models - INFO - Top 10 most important features for 210:
2025-05-25 12:17:05,586 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-25 12:17:05,586 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-25 12:17:05,586 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-25 12:17:05,587 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-25 12:17:05,587 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-25 12:17:05,587 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-25 12:17:05,588 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-25 12:17:05,589 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-25 12:17:05,589 - train_models - INFO - Cross-validation details for 210:
2025-05-25 12:17:05,589 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-25 12:17:05,590 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-25 12:17:05,591 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-25 12:17:05,591 - train_models - INFO - Building model for WorkType: 211
2025-05-25 12:17:08,634 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:17:56,476 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-25 12:17:56,477 - train_models - INFO - Top 10 most important features for 211:
2025-05-25 12:17:56,477 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-25 12:17:56,477 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-25 12:17:56,478 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-25 12:17:56,478 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-25 12:17:56,479 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-25 12:17:56,479 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-25 12:17:56,480 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-25 12:17:56,480 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-25 12:17:56,481 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-25 12:17:56,481 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-25 12:17:56,481 - train_models - INFO - Cross-validation details for 211:
2025-05-25 12:17:56,482 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-25 12:17:56,482 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-25 12:17:56,483 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-25 12:17:56,483 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-25 12:17:56,484 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-25 12:17:56,484 - train_models - INFO - Building model for WorkType: 213
2025-05-25 12:17:59,199 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:18:43,065 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-25 12:18:43,066 - train_models - INFO - Top 10 most important features for 213:
2025-05-25 12:18:43,066 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-25 12:18:43,067 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-25 12:18:43,067 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-25 12:18:43,068 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-25 12:18:43,068 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-25 12:18:43,069 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-25 12:18:43,069 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-25 12:18:43,070 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-25 12:18:43,070 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-25 12:18:43,071 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-25 12:18:43,071 - train_models - INFO - Cross-validation details for 213:
2025-05-25 12:18:43,071 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-25 12:18:43,072 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-25 12:18:43,072 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-25 12:18:43,073 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-25 12:18:43,073 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-25 12:18:43,074 - train_models - INFO - Building model for WorkType: 214
2025-05-25 12:18:45,902 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:19:28,185 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-25 12:19:28,185 - train_models - INFO - Top 10 most important features for 214:
2025-05-25 12:19:28,186 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-25 12:19:28,186 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-25 12:19:28,187 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-25 12:19:28,187 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-25 12:19:28,187 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-25 12:19:28,188 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-25 12:19:28,189 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-25 12:19:28,189 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-25 12:19:28,189 - train_models - INFO - Cross-validation details for 214:
2025-05-25 12:19:28,190 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-25 12:19:28,190 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-25 12:19:28,191 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-25 12:19:28,192 - train_models - INFO - Building model for WorkType: 215
2025-05-25 12:19:31,487 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:20:20,097 - train_models - INFO - Model for 215 - MAE: 0.3419, RMSE: 0.6228, R²: 0.9645, MAPE: 6.50%
2025-05-25 12:20:20,097 - train_models - INFO - Top 10 most important features for 215:
2025-05-25 12:20:20,098 - train_models - INFO -   Relative_Quantity: 0.8937
2025-05-25 12:20:20,098 - train_models - INFO -   Quantity_per_Worker: 0.0372
2025-05-25 12:20:20,099 - train_models - INFO -   Hours_per_Quantity: 0.0367
2025-05-25 12:20:20,099 - train_models - INFO -   NoOfMan_7day_trend: 0.0074
2025-05-25 12:20:20,100 - train_models - INFO -   NoOfMan_1day_trend: 0.0049
2025-05-25 12:20:20,100 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0039
2025-05-25 12:20:20,101 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0022
2025-05-25 12:20:20,101 - train_models - INFO -   SystemHours_per_Quantity: 0.0022
2025-05-25 12:20:20,102 - train_models - INFO -   Quantity_1day_trend: 0.0010
2025-05-25 12:20:20,102 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0010
2025-05-25 12:20:20,102 - train_models - INFO - Cross-validation details for 215:
2025-05-25 12:20:20,103 - train_models - INFO -   Fold 1: MAE=0.5024, RMSE=0.6994, R²=0.9610, MAPE=9.78%
2025-05-25 12:20:20,103 - train_models - INFO -   Fold 2: MAE=0.4898, RMSE=0.9047, R²=0.9405, MAPE=8.66%
2025-05-25 12:20:20,104 - train_models - INFO -   Fold 3: MAE=0.2378, RMSE=0.3569, R²=0.9797, MAPE=5.44%
2025-05-25 12:20:20,104 - train_models - INFO -   Fold 4: MAE=0.2218, RMSE=0.5049, R²=0.9772, MAPE=5.55%
2025-05-25 12:20:20,105 - train_models - INFO -   Fold 5: MAE=0.2579, RMSE=0.6480, R²=0.9643, MAPE=3.07%
2025-05-25 12:20:20,105 - train_models - INFO - Building model for WorkType: 217
2025-05-25 12:20:22,603 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-25 12:20:58,721 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-25 12:20:58,722 - train_models - INFO - Top 10 most important features for 217:
2025-05-25 12:20:58,722 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-25 12:20:58,723 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-25 12:20:58,723 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-25 12:20:58,724 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-25 12:20:58,724 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-25 12:20:58,725 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-25 12:20:58,725 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-25 12:20:58,725 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-25 12:20:58,726 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-25 12:20:58,726 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-25 12:20:58,727 - train_models - INFO - Cross-validation details for 217:
2025-05-25 12:20:58,727 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-25 12:20:58,727 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-25 12:20:58,728 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-25 12:20:58,728 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-25 12:20:58,729 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-25 12:20:58,730 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-25 12:20:59,446 - train_models - INFO - Model files saved successfully
2025-05-25 12:20:59,447 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-25 12:20:59,452 - train_models - INFO - Model training completed successfully
2025-05-26 10:16:37,296 - train_models - INFO - Starting the model training process
2025-05-26 10:16:37,298 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-26 10:16:49,829 - train_models - INFO - Loading data from 
2025-05-26 10:16:49,830 - train_models - ERROR - Error loading data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)
2025-05-26 10:16:49,835 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 65, in load_data
    raise ValueError("Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)")
ValueError: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

2025-05-26 10:16:49,835 - train_models - ERROR - Error in main training process: Failed to load data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)
2025-05-26 10:16:49,837 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 65, in load_data
    raise ValueError("Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)")
ValueError: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 462, in main
    df = load_data(file_path)
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 97, in load_data
    raise Exception(f"Failed to load data: {str(e)}")
Exception: Failed to load data: Unsupported file format. Please use Excel (.xlsx/.xls) or CSV (.csv)

2025-05-26 10:17:05,777 - train_models - INFO - Starting the model training process
2025-05-26 10:17:05,777 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:17:05,781 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:17:05,906 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:17:06,260 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:17:06,276 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:17:06,277 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:17:06,282 - train_models - INFO - Engineering features...
2025-05-26 10:17:06,763 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:17:06,775 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:17:06,777 - train_models - INFO - Creating lag features...
2025-05-26 10:17:06,783 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:17:06,846 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:17:06,847 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:17:06,849 - train_models - INFO - Found 1 unique work types
2025-05-26 10:17:06,849 - train_models - INFO - Building models for 1 work types
2025-05-26 10:17:06,849 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:17:06,849 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:17:06,850 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:17:08,352 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:17:27,198 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:17:27,200 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:17:27,200 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:17:27,200 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:17:27,201 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:17:27,201 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:17:27,201 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:17:27,202 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:17:27,202 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:17:27,202 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:17:27,202 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:17:27,202 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:17:27,203 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:17:27,204 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:17:27,270 - train_models - INFO - Model files saved successfully
2025-05-26 10:17:27,270 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:17:27,271 - train_models - INFO - Model training completed successfully
2025-05-26 10:19:47,384 - train_models - INFO - Starting the model training process
2025-05-26 10:19:47,384 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:19:47,388 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:19:47,498 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:19:47,860 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:19:47,877 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:19:47,879 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:19:47,889 - train_models - INFO - Engineering features...
2025-05-26 10:19:48,237 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:19:48,252 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:19:48,254 - train_models - INFO - Creating lag features...
2025-05-26 10:19:48,261 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:19:48,319 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:19:48,319 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:19:48,321 - train_models - INFO - Found 1 unique work types
2025-05-26 10:19:48,325 - train_models - ERROR - Error building models: No engine for filetype: 'xlxs'
2025-05-26 10:19:48,439 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1136, in __new__
    engine = config.get_option(f"io.excel.{ext}.writer", silent=True)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 274, in __call__
    return self.__func__(*args, **kwds)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 146, in _get_option
    key = _get_single_key(pat, silent)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\_config\config.py", line 132, in _get_single_key
    raise OptionError(f"No such keys(s): {repr(pat)}")
pandas._config.config.OptionError: No such keys(s): 'io.excel.xlxs.writer'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 121, in build_models
    processed_data.to_excel('209.xlxs')
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 2417, in to_excel
    formatter.write(
    ~~~~~~~~~~~~~~~^
        excel_writer,
        ^^^^^^^^^^^^^
    ...<6 lines>...
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\formats\excel.py", line 943, in write
    writer = ExcelWriter(
        writer,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1140, in __new__
    raise ValueError(f"No engine for filetype: '{ext}'") from err
ValueError: No engine for filetype: 'xlxs'

2025-05-26 10:19:48,440 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-26 10:19:48,701 - train_models - INFO - Model files saved successfully
2025-05-26 10:19:48,701 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:19:48,702 - train_models - INFO - Model training completed successfully
2025-05-26 10:21:23,314 - train_models - INFO - Starting the model training process
2025-05-26 10:21:23,315 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:21:23,318 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:21:23,428 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:21:23,813 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:21:23,828 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:21:23,829 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:21:23,834 - train_models - INFO - Engineering features...
2025-05-26 10:21:24,203 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:21:24,213 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:21:24,215 - train_models - INFO - Creating lag features...
2025-05-26 10:21:24,226 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:21:24,287 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:21:24,288 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:21:24,290 - train_models - INFO - Found 1 unique work types
2025-05-26 10:21:24,291 - train_models - INFO - Building models for 1 work types
2025-05-26 10:21:24,291 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:21:24,291 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:21:24,291 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:21:25,708 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:21:46,576 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:21:46,577 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:21:46,577 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:21:46,577 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:21:46,578 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:21:46,578 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:21:46,578 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:21:46,579 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:21:46,580 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:21:46,580 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:21:46,580 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:21:46,580 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:21:46,581 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:21:46,582 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:21:46,633 - train_models - INFO - Model files saved successfully
2025-05-26 10:21:46,633 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:21:46,634 - train_models - INFO - Model training completed successfully
2025-05-26 10:21:51,231 - train_models - INFO - Starting the model training process
2025-05-26 10:21:51,232 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:21:51,235 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:21:51,338 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:21:51,705 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:21:51,721 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:21:51,723 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:21:51,734 - train_models - INFO - Engineering features...
2025-05-26 10:21:52,088 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:21:52,101 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:21:52,103 - train_models - INFO - Creating lag features...
2025-05-26 10:21:52,109 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:21:52,170 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:21:52,171 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:21:52,173 - train_models - INFO - Found 1 unique work types
2025-05-26 10:21:52,174 - train_models - INFO - Building models for 1 work types
2025-05-26 10:21:52,174 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:21:52,174 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:21:52,175 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:21:53,932 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:22:13,209 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:22:13,209 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:22:13,209 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:22:13,209 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:22:13,210 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:22:13,210 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:22:13,210 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:22:13,210 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:22:13,211 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:22:13,211 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:22:13,212 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:22:13,212 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:22:13,213 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:22:13,267 - train_models - INFO - Model files saved successfully
2025-05-26 10:22:13,267 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:22:13,268 - train_models - INFO - Model training completed successfully
2025-05-26 10:22:51,140 - train_models - INFO - Starting the model training process
2025-05-26 10:22:51,141 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:22:51,144 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:22:51,261 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:22:51,617 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:22:51,634 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:22:51,635 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:22:51,647 - train_models - INFO - Engineering features...
2025-05-26 10:22:51,994 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:22:52,007 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:22:52,009 - train_models - INFO - Creating lag features...
2025-05-26 10:22:52,016 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:22:52,073 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:22:52,074 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:22:52,077 - train_models - INFO - Found 1 unique work types
2025-05-26 10:22:52,077 - train_models - INFO - Building models for 1 work types
2025-05-26 10:22:53,540 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:22:53,541 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:22:53,541 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:22:54,754 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:23:15,065 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:23:15,066 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:23:15,066 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:23:15,066 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:23:15,066 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:23:15,066 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:23:15,067 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:23:15,068 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:23:15,068 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:23:15,068 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:23:15,069 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:23:15,069 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:23:15,069 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:23:15,117 - train_models - INFO - Model files saved successfully
2025-05-26 10:23:15,118 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:23:15,118 - train_models - INFO - Model training completed successfully
2025-05-26 10:29:20,092 - train_models - INFO - Starting the model training process
2025-05-26 10:29:20,093 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:29:20,096 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:29:20,263 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209)
            
2025-05-26 10:29:20,632 - train_models - INFO - Read chunk of 1526 rows
2025-05-26 10:29:20,649 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-26 10:29:20,651 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:29:21,140 - train_models - INFO - Engineering features...
2025-05-26 10:29:21,625 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:29:21,640 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:29:21,642 - train_models - INFO - Creating lag features...
2025-05-26 10:29:21,648 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:29:21,722 - utils.feature_engineering - INFO - Lag features created. Dropped 365 rows with NaN values.
2025-05-26 10:29:21,723 - utils.feature_engineering - INFO - Final shape: (1161, 72)
2025-05-26 10:29:21,725 - train_models - INFO - Found 1 unique work types
2025-05-26 10:29:21,726 - train_models - INFO - Building models for 1 work types
2025-05-26 10:29:21,726 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:29:21,727 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:29:21,727 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:29:23,225 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:29:44,523 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:29:44,523 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:29:44,523 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:29:44,524 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:29:44,524 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:29:44,524 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:29:44,525 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:29:44,526 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:29:44,526 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:29:44,526 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:29:44,526 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:29:44,527 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:29:44,528 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-26 10:29:44,588 - train_models - INFO - Model files saved successfully
2025-05-26 10:29:44,588 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:29:44,589 - train_models - INFO - Model training completed successfully
2025-05-26 10:47:57,443 - train_models - INFO - Starting the model training process
2025-05-26 10:47:57,443 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 10:47:57,447 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 10:47:57,554 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 10:47:58,137 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 10:47:58,191 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 10:47:58,208 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 10:47:58,209 - train_models - INFO - Converting Date column to datetime format
2025-05-26 10:47:58,220 - train_models - INFO - Engineering features...
2025-05-26 10:47:58,636 - utils.feature_engineering - INFO - Engineering features
2025-05-26 10:47:58,665 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 10:47:58,671 - train_models - INFO - Creating lag features...
2025-05-26 10:47:58,681 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 10:47:58,851 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 10:47:58,852 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 10:47:58,860 - train_models - INFO - Found 9 unique work types
2025-05-26 10:47:58,860 - train_models - INFO - Building models for 9 work types
2025-05-26 10:47:58,860 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 10:47:58,861 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 10:47:58,861 - train_models - INFO - Building model for WorkType: 202
2025-05-26 10:48:00,220 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:48:17,377 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 10:48:17,377 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 10:48:17,378 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 10:48:17,379 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 10:48:17,379 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 10:48:17,380 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 10:48:17,380 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 10:48:17,380 - train_models - INFO - Cross-validation details for 202:
2025-05-26 10:48:17,380 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 10:48:17,380 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 10:48:17,381 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 10:48:17,381 - train_models - INFO - Building model for WorkType: 203
2025-05-26 10:48:18,632 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:48:36,351 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 10:48:36,351 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 10:48:36,352 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 10:48:36,353 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 10:48:36,354 - train_models - INFO - Cross-validation details for 203:
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 10:48:36,354 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 10:48:36,355 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 10:48:36,355 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 10:48:36,355 - train_models - INFO - Building model for WorkType: 206
2025-05-26 10:48:37,961 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:02,487 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 10:49:02,488 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 10:49:02,488 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 10:49:02,488 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 10:49:02,488 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 10:49:02,488 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 10:49:02,489 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 10:49:02,489 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 10:49:02,490 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 10:49:02,490 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 10:49:02,490 - train_models - INFO - Cross-validation details for 206:
2025-05-26 10:49:02,490 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 10:49:02,491 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 10:49:02,492 - train_models - INFO - Building model for WorkType: 209
2025-05-26 10:49:03,661 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:21,973 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 10:49:21,973 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 10:49:21,973 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 10:49:21,973 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 10:49:21,974 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 10:49:21,974 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 10:49:21,974 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 10:49:21,975 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 10:49:21,975 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 10:49:21,975 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 10:49:21,975 - train_models - INFO - Cross-validation details for 209:
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 10:49:21,976 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 10:49:21,977 - train_models - INFO - Building model for WorkType: 210
2025-05-26 10:49:23,208 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:49:42,074 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 10:49:42,075 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 10:49:42,075 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 10:49:42,075 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 10:49:42,075 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 10:49:42,075 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 10:49:42,076 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 10:49:42,076 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 10:49:42,077 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 10:49:42,077 - train_models - INFO - Cross-validation details for 210:
2025-05-26 10:49:42,077 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 10:49:42,078 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 10:49:42,078 - train_models - INFO - Building model for WorkType: 211
2025-05-26 10:49:43,747 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:05,945 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 10:50:05,945 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 10:50:05,946 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 10:50:05,946 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 10:50:05,946 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 10:50:05,947 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 10:50:05,948 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 10:50:05,948 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 10:50:05,948 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 10:50:05,948 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 10:50:05,949 - train_models - INFO - Cross-validation details for 211:
2025-05-26 10:50:05,949 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 10:50:05,949 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 10:50:05,950 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 10:50:05,950 - train_models - INFO - Building model for WorkType: 213
2025-05-26 10:50:07,069 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:26,017 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 10:50:26,018 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 10:50:26,018 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 10:50:26,019 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 10:50:26,019 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 10:50:26,020 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 10:50:26,020 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 10:50:26,020 - train_models - INFO - Cross-validation details for 213:
2025-05-26 10:50:26,020 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 10:50:26,020 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 10:50:26,021 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 10:50:26,021 - train_models - INFO - Building model for WorkType: 214
2025-05-26 10:50:27,258 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:50:46,275 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 10:50:46,276 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 10:50:46,276 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 10:50:46,276 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 10:50:46,277 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 10:50:46,277 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 10:50:46,277 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 10:50:46,278 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 10:50:46,279 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 10:50:46,279 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 10:50:46,279 - train_models - INFO - Cross-validation details for 214:
2025-05-26 10:50:46,279 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 10:50:46,280 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 10:50:46,281 - train_models - INFO - Building model for WorkType: 217
2025-05-26 10:50:47,383 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 10:51:03,960 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 10:51:03,961 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 10:51:03,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 10:51:03,961 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 10:51:03,962 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 10:51:03,962 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 10:51:03,963 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 10:51:03,964 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 10:51:03,964 - train_models - INFO - Cross-validation details for 217:
2025-05-26 10:51:03,964 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 10:51:03,965 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 10:51:03,966 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 10:51:04,412 - train_models - INFO - Model files saved successfully
2025-05-26 10:51:04,413 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 10:51:04,415 - train_models - INFO - Model training completed successfully
2025-05-26 11:37:21,869 - train_models - INFO - Starting the model training process
2025-05-26 11:37:21,870 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:37:21,873 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:37:21,983 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 11:37:22,548 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 11:37:22,607 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 11:37:22,625 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 11:37:22,626 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:37:22,638 - train_models - INFO - Engineering features...
2025-05-26 11:37:23,033 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:37:23,065 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:37:23,069 - train_models - INFO - Creating lag features...
2025-05-26 11:37:23,079 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:37:23,247 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 11:37:23,248 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 11:37:23,259 - train_models - INFO - Found 9 unique work types
2025-05-26 11:37:23,260 - train_models - INFO - Building models for 9 work types
2025-05-26 11:37:23,260 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:37:23,260 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:37:23,261 - train_models - INFO - Building model for WorkType: 202
2025-05-26 11:37:24,627 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:37:41,217 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 11:37:41,217 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 11:37:41,218 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 11:37:41,219 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 11:37:41,219 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 11:37:41,220 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 11:37:41,220 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 11:37:41,220 - train_models - INFO - Cross-validation details for 202:
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 11:37:41,221 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 11:37:41,222 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 11:37:41,222 - train_models - INFO - Building model for WorkType: 203
2025-05-26 11:37:42,469 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:37:59,842 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 11:37:59,842 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 11:37:59,843 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 11:37:59,844 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 11:37:59,845 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 11:37:59,846 - train_models - INFO - Cross-validation details for 203:
2025-05-26 11:37:59,846 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 11:37:59,846 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 11:37:59,847 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 11:37:59,847 - train_models - INFO - Building model for WorkType: 206
2025-05-26 11:38:01,478 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:38:25,219 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 11:38:25,219 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 11:38:25,219 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 11:38:25,220 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 11:38:25,220 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 11:38:25,220 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 11:38:25,221 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 11:38:25,221 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 11:38:25,221 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 11:38:25,222 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 11:38:25,222 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 11:38:25,222 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 11:38:25,222 - train_models - INFO - Cross-validation details for 206:
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 11:38:25,223 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 11:38:25,224 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 11:38:25,224 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 11:38:25,224 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:38:26,353 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:38:44,564 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:38:44,564 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:38:44,564 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:38:44,564 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:38:44,565 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:38:44,565 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:38:44,565 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:38:44,566 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:38:44,567 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:38:44,567 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:38:44,567 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:38:44,568 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:38:44,569 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:38:45,928 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:03,641 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:39:03,641 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:39:03,641 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:39:03,642 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:39:03,642 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:39:03,642 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:39:03,642 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:39:03,643 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:39:03,643 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:39:03,644 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:39:03,644 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:39:03,644 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:39:03,644 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:39:03,645 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:39:03,645 - train_models - INFO - Building model for WorkType: 211
2025-05-26 11:39:04,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:24,750 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 11:39:24,751 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 11:39:24,751 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 11:39:24,751 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 11:39:24,752 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 11:39:24,753 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 11:39:24,753 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 11:39:24,753 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 11:39:24,754 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 11:39:24,754 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 11:39:24,754 - train_models - INFO - Cross-validation details for 211:
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 11:39:24,755 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 11:39:24,756 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 11:39:24,756 - train_models - INFO - Building model for WorkType: 213
2025-05-26 11:39:25,854 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:39:43,858 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 11:39:43,859 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 11:39:43,859 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 11:39:43,860 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 11:39:43,861 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 11:39:43,861 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 11:39:43,862 - train_models - INFO - Cross-validation details for 213:
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 11:39:43,862 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 11:39:43,863 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 11:39:43,863 - train_models - INFO - Building model for WorkType: 214
2025-05-26 11:39:44,972 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:40:02,270 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 11:40:02,270 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 11:40:02,271 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 11:40:02,271 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 11:40:02,272 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 11:40:02,273 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 11:40:02,273 - train_models - INFO - Cross-validation details for 214:
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 11:40:02,274 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 11:40:02,275 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 11:40:02,275 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 11:40:02,275 - train_models - INFO - Building model for WorkType: 217
2025-05-26 11:40:03,370 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:40:18,360 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 11:40:18,361 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 11:40:18,361 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 11:40:18,362 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 11:40:18,363 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 11:40:18,363 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 11:40:18,363 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 11:40:18,364 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 11:40:18,364 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 11:40:18,364 - train_models - INFO - Cross-validation details for 217:
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 11:40:18,365 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 11:40:18,366 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 11:40:18,367 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 11:40:18,684 - train_models - INFO - Model files saved successfully
2025-05-26 11:40:18,684 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:40:18,687 - train_models - INFO - Model training completed successfully
2025-05-26 11:45:15,740 - train_models - INFO - Starting the model training process
2025-05-26 11:45:15,740 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:45:15,743 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:45:15,857 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 11:45:16,441 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 11:45:16,497 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 11:45:16,513 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 11:45:16,515 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:45:16,527 - train_models - INFO - Engineering features...
2025-05-26 11:45:16,915 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:45:16,945 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:45:16,948 - train_models - INFO - Creating lag features...
2025-05-26 11:45:16,958 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:45:17,117 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 11:45:17,117 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 11:45:17,127 - train_models - INFO - Found 9 unique work types
2025-05-26 11:45:17,127 - train_models - INFO - Building models for 9 work types
2025-05-26 11:45:17,127 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:45:17,128 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:45:17,128 - train_models - INFO - Building model for WorkType: 202
2025-05-26 11:45:18,458 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:45:34,980 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 11:45:34,981 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 11:45:34,981 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 11:45:34,981 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 11:45:34,982 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 11:45:34,983 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 11:45:34,983 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 11:45:34,983 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 11:45:34,983 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 11:45:34,983 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 11:45:34,984 - train_models - INFO - Cross-validation details for 202:
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 11:45:34,984 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 11:45:34,985 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 11:45:34,985 - train_models - INFO - Building model for WorkType: 203
2025-05-26 11:45:36,194 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:45:53,768 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 11:45:53,768 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 11:45:53,768 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 11:45:53,769 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 11:45:53,770 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 11:45:53,771 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 11:45:53,771 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 11:45:53,771 - train_models - INFO - Cross-validation details for 203:
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 11:45:53,772 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 11:45:53,773 - train_models - INFO - Building model for WorkType: 206
2025-05-26 11:45:55,343 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:18,891 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 11:46:18,891 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 11:46:18,891 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 11:46:18,892 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 11:46:18,892 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 11:46:18,892 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 11:46:18,893 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 11:46:18,893 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 11:46:18,893 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 11:46:18,894 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 11:46:18,894 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 11:46:18,894 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 11:46:18,894 - train_models - INFO - Cross-validation details for 206:
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 11:46:18,895 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 11:46:18,896 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 11:46:18,896 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 11:46:18,896 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:46:20,025 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:38,288 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:46:38,288 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:46:38,288 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:46:38,289 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:46:38,289 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:46:38,289 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:46:38,289 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:46:38,290 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:46:38,291 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:46:38,291 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:46:38,291 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:46:38,291 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:46:38,292 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:46:38,292 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:46:39,580 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:46:57,224 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:46:57,224 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:46:57,225 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:46:57,225 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:46:57,225 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:46:57,225 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:46:57,225 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:46:57,226 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:46:57,226 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:46:57,227 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:46:57,227 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:46:57,227 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:46:57,227 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:46:57,228 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:46:57,228 - train_models - INFO - Building model for WorkType: 211
2025-05-26 11:46:58,576 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:18,933 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 11:47:18,933 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 11:47:18,933 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 11:47:18,934 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 11:47:18,935 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 11:47:18,935 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 11:47:18,936 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 11:47:18,936 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 11:47:18,936 - train_models - INFO - Cross-validation details for 211:
2025-05-26 11:47:18,936 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 11:47:18,937 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 11:47:18,938 - train_models - INFO - Building model for WorkType: 213
2025-05-26 11:47:20,283 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:39,703 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 11:47:39,703 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 11:47:39,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 11:47:39,704 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 11:47:39,705 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 11:47:39,705 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 11:47:39,706 - train_models - INFO - Cross-validation details for 213:
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 11:47:39,706 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 11:47:39,707 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 11:47:39,707 - train_models - INFO - Building model for WorkType: 214
2025-05-26 11:47:40,899 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:47:58,381 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 11:47:58,381 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 11:47:58,381 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 11:47:58,382 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 11:47:58,382 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 11:47:58,382 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 11:47:58,383 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 11:47:58,384 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 11:47:58,384 - train_models - INFO - Cross-validation details for 214:
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 11:47:58,385 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 11:47:58,386 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 11:47:58,386 - train_models - INFO - Building model for WorkType: 217
2025-05-26 11:47:59,510 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:48:16,088 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 11:48:16,088 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 11:48:16,089 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 11:48:16,090 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 11:48:16,090 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 11:48:16,091 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 11:48:16,091 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 11:48:16,091 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 11:48:16,092 - train_models - INFO - Cross-validation details for 217:
2025-05-26 11:48:16,092 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 11:48:16,092 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 11:48:16,093 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 11:48:16,094 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 11:48:16,388 - train_models - INFO - Model files saved successfully
2025-05-26 11:48:16,388 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:48:16,392 - train_models - INFO - Model training completed successfully
2025-05-26 11:50:12,550 - train_models - INFO - Starting the model training process
2025-05-26 11:50:12,550 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:50:12,554 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:50:12,672 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-26 11:50:12,909 - train_models - INFO - Read chunk of 3052 rows
2025-05-26 11:50:12,924 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-26 11:50:12,925 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:50:12,934 - train_models - INFO - Engineering features...
2025-05-26 11:50:13,312 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:50:13,328 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:50:13,331 - train_models - INFO - Creating lag features...
2025-05-26 11:50:13,339 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:50:13,426 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-26 11:50:13,426 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-26 11:50:13,428 - train_models - INFO - Found 2 unique work types
2025-05-26 11:50:13,428 - train_models - INFO - Building models for 2 work types
2025-05-26 11:50:13,429 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:50:13,429 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:50:13,429 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:50:14,943 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:50:37,224 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:50:37,224 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:50:37,225 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:50:37,225 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:50:37,225 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:50:37,226 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:50:37,226 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:50:37,227 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:50:37,227 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:50:37,227 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:50:37,227 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:50:37,228 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:50:37,229 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:50:37,229 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:50:37,229 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:50:38,576 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:50:58,186 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:50:58,187 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:50:58,187 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:50:58,187 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:50:58,187 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:50:58,188 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:50:58,188 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:50:58,189 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:50:58,189 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:50:58,189 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:50:58,190 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:50:58,190 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:50:58,191 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:50:58,191 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:50:58,192 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-26 11:50:58,302 - train_models - INFO - Model files saved successfully
2025-05-26 11:50:58,302 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:50:58,303 - train_models - INFO - Model training completed successfully
2025-05-26 11:55:24,092 - train_models - INFO - Starting the model training process
2025-05-26 11:55:24,092 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 11:55:24,095 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 11:55:24,201 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 210)
            
2025-05-26 11:55:24,632 - train_models - INFO - Read chunk of 3052 rows
2025-05-26 11:55:24,648 - train_models - INFO - Data loaded successfully. Total rows: 3052
2025-05-26 11:55:24,649 - train_models - INFO - Converting Date column to datetime format
2025-05-26 11:55:24,658 - train_models - INFO - Engineering features...
2025-05-26 11:55:24,988 - utils.feature_engineering - INFO - Engineering features
2025-05-26 11:55:25,001 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 11:55:25,003 - train_models - INFO - Creating lag features...
2025-05-26 11:55:25,011 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 11:55:25,079 - utils.feature_engineering - INFO - Lag features created. Dropped 730 rows with NaN values.
2025-05-26 11:55:25,080 - utils.feature_engineering - INFO - Final shape: (2322, 72)
2025-05-26 11:55:25,083 - train_models - INFO - Found 2 unique work types
2025-05-26 11:55:25,083 - train_models - INFO - Building models for 2 work types
2025-05-26 11:55:25,083 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 11:55:25,084 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 11:55:25,084 - train_models - INFO - Building model for WorkType: 209
2025-05-26 11:55:26,439 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:55:44,794 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 11:55:44,795 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 11:55:44,795 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 11:55:44,795 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 11:55:44,796 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 11:55:44,796 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 11:55:44,796 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 11:55:44,796 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 11:55:44,797 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 11:55:44,798 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 11:55:44,798 - train_models - INFO - Cross-validation details for 209:
2025-05-26 11:55:44,798 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 11:55:44,798 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 11:55:44,799 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 11:55:44,799 - train_models - INFO - Building model for WorkType: 210
2025-05-26 11:55:46,156 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 11:56:03,959 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 11:56:03,960 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 11:56:03,960 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 11:56:03,960 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 11:56:03,960 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 11:56:03,961 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 11:56:03,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 11:56:03,961 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 11:56:03,962 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 11:56:03,962 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 11:56:03,963 - train_models - INFO - Cross-validation details for 210:
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 11:56:03,963 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 11:56:03,964 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 11:56:03,964 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 11:56:03,964 - train_models - INFO - Saving 2 models to C:/forlogssystems/Models
2025-05-26 11:56:04,044 - train_models - INFO - Model files saved successfully
2025-05-26 11:56:04,044 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 11:56:04,045 - train_models - INFO - Model training completed successfully
2025-05-26 13:07:11,866 - train_models - INFO - Starting the model training process
2025-05-26 13:07:11,867 - train_models - INFO - Training from SQL database (command line argument)
2025-05-26 13:07:11,870 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-26 13:07:11,985 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217)
            
2025-05-26 13:07:12,233 - train_models - INFO - Read chunk of 10000 rows
2025-05-26 13:07:12,250 - train_models - INFO - Read chunk of 3803 rows
2025-05-26 13:07:12,267 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-26 13:07:12,269 - train_models - INFO - Converting Date column to datetime format
2025-05-26 13:07:12,278 - train_models - INFO - Engineering features...
2025-05-26 13:07:12,664 - utils.feature_engineering - INFO - Engineering features
2025-05-26 13:07:12,694 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-26 13:07:12,699 - train_models - INFO - Creating lag features...
2025-05-26 13:07:12,709 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-26 13:07:12,865 - utils.feature_engineering - INFO - Lag features created. Dropped 3290 rows with NaN values.
2025-05-26 13:07:12,866 - utils.feature_engineering - INFO - Final shape: (10513, 72)
2025-05-26 13:07:12,876 - train_models - INFO - Found 9 unique work types
2025-05-26 13:07:12,876 - train_models - INFO - Building models for 9 work types
2025-05-26 13:07:12,876 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-26 13:07:12,877 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-26 13:07:12,877 - train_models - INFO - Building model for WorkType: 202
2025-05-26 13:07:14,277 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:07:30,660 - train_models - INFO - Model for 202 - MAE: 0.1966, RMSE: 0.2838, R²: 0.8723, MAPE: 9.29%
2025-05-26 13:07:30,660 - train_models - INFO - Top 10 most important features for 202:
2025-05-26 13:07:30,660 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3731
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_7day_trend: 0.1931
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_1day_trend: 0.1204
2025-05-26 13:07:30,661 - train_models - INFO -   NoOfMan_lag_7: 0.0693
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_lag_1: 0.0658
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0612
2025-05-26 13:07:30,662 - train_models - INFO -   Relative_Quantity: 0.0383
2025-05-26 13:07:30,662 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0185
2025-05-26 13:07:30,663 - train_models - INFO -   Hours_per_Quantity: 0.0161
2025-05-26 13:07:30,663 - train_models - INFO -   Quantity_per_Worker: 0.0092
2025-05-26 13:07:30,663 - train_models - INFO - Cross-validation details for 202:
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 1: MAE=0.1841, RMSE=0.2576, R²=0.8572, MAPE=10.23%
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 2: MAE=0.2142, RMSE=0.3456, R²=0.8237, MAPE=10.75%
2025-05-26 13:07:30,664 - train_models - INFO -   Fold 3: MAE=0.1832, RMSE=0.2485, R²=0.8885, MAPE=9.36%
2025-05-26 13:07:30,665 - train_models - INFO -   Fold 4: MAE=0.1715, RMSE=0.2485, R²=0.8999, MAPE=7.19%
2025-05-26 13:07:30,665 - train_models - INFO -   Fold 5: MAE=0.2299, RMSE=0.3190, R²=0.8921, MAPE=8.91%
2025-05-26 13:07:30,665 - train_models - INFO - Building model for WorkType: 203
2025-05-26 13:07:31,853 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:07:48,957 - train_models - INFO - Model for 203 - MAE: 0.2666, RMSE: 0.4019, R²: 0.8605, MAPE: 5.51%
2025-05-26 13:07:48,957 - train_models - INFO - Top 10 most important features for 203:
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_7day_trend: 0.3471
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1349
2025-05-26 13:07:48,958 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1333
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_lag_7: 0.1003
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0984
2025-05-26 13:07:48,959 - train_models - INFO -   NoOfMan_1day_trend: 0.0910
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_lag_1: 0.0483
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0052
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_lag_2: 0.0031
2025-05-26 13:07:48,960 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0030
2025-05-26 13:07:48,961 - train_models - INFO - Cross-validation details for 203:
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 1: MAE=0.3999, RMSE=0.5335, R²=0.7543, MAPE=7.24%
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 2: MAE=0.2764, RMSE=0.5427, R²=0.7950, MAPE=4.73%
2025-05-26 13:07:48,961 - train_models - INFO -   Fold 3: MAE=0.2718, RMSE=0.3870, R²=0.8976, MAPE=5.77%
2025-05-26 13:07:48,962 - train_models - INFO -   Fold 4: MAE=0.1967, RMSE=0.2976, R²=0.9251, MAPE=5.36%
2025-05-26 13:07:48,962 - train_models - INFO -   Fold 5: MAE=0.1884, RMSE=0.2487, R²=0.9306, MAPE=4.45%
2025-05-26 13:07:48,962 - train_models - INFO - Building model for WorkType: 206
2025-05-26 13:07:50,470 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:14,214 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.1029, R²: 0.9334, MAPE: 10.12%
2025-05-26 13:08:14,214 - train_models - INFO - Top 10 most important features for 206:
2025-05-26 13:08:14,214 - train_models - INFO -   Relative_Quantity: 0.6751
2025-05-26 13:08:14,215 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1309
2025-05-26 13:08:14,215 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0407
2025-05-26 13:08:14,215 - train_models - INFO -   Hours_per_Quantity: 0.0371
2025-05-26 13:08:14,216 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0364
2025-05-26 13:08:14,216 - train_models - INFO -   Quantity_per_Worker: 0.0293
2025-05-26 13:08:14,216 - train_models - INFO -   NoOfMan_1day_trend: 0.0122
2025-05-26 13:08:14,217 - train_models - INFO -   NoOfMan_7day_trend: 0.0070
2025-05-26 13:08:14,217 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-26 13:08:14,217 - train_models - INFO -   Quantity_same_dow_lag: 0.0040
2025-05-26 13:08:14,217 - train_models - INFO - Cross-validation details for 206:
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 1: MAE=1.7818, RMSE=2.3562, R²=0.9259, MAPE=9.13%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 2: MAE=1.3853, RMSE=1.8939, R²=0.9457, MAPE=8.21%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 3: MAE=1.0758, RMSE=2.2676, R²=0.9040, MAPE=5.86%
2025-05-26 13:08:14,218 - train_models - INFO -   Fold 4: MAE=0.9833, RMSE=1.8489, R²=0.9372, MAPE=13.93%
2025-05-26 13:08:14,219 - train_models - INFO -   Fold 5: MAE=1.2559, RMSE=2.1479, R²=0.9541, MAPE=13.45%
2025-05-26 13:08:14,219 - train_models - INFO - Building model for WorkType: 209
2025-05-26 13:08:15,311 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:33,077 - train_models - INFO - Model for 209 - MAE: 0.5517, RMSE: 1.0404, R²: 0.9385, MAPE: 10.22%
2025-05-26 13:08:33,077 - train_models - INFO - Top 10 most important features for 209:
2025-05-26 13:08:33,077 - train_models - INFO -   Relative_Quantity: 0.7434
2025-05-26 13:08:33,078 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1248
2025-05-26 13:08:33,078 - train_models - INFO -   Hours_per_Quantity: 0.0546
2025-05-26 13:08:33,078 - train_models - INFO -   Quantity_per_Worker: 0.0459
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0076
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_7day_trend: 0.0057
2025-05-26 13:08:33,079 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0020
2025-05-26 13:08:33,080 - train_models - INFO -   NoOfMan_1day_trend: 0.0014
2025-05-26 13:08:33,080 - train_models - INFO -   NoOfMan_lag_7: 0.0011
2025-05-26 13:08:33,080 - train_models - INFO -   ResourceKPI_lag_1: 0.0009
2025-05-26 13:08:33,080 - train_models - INFO - Cross-validation details for 209:
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 1: MAE=0.9797, RMSE=1.9484, R²=0.8307, MAPE=15.43%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 2: MAE=0.3891, RMSE=0.6143, R²=0.9731, MAPE=4.55%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 3: MAE=0.5120, RMSE=1.1364, R²=0.9420, MAPE=6.11%
2025-05-26 13:08:33,081 - train_models - INFO -   Fold 4: MAE=0.4646, RMSE=0.7389, R²=0.9662, MAPE=19.95%
2025-05-26 13:08:33,082 - train_models - INFO -   Fold 5: MAE=0.4130, RMSE=0.7640, R²=0.9807, MAPE=5.07%
2025-05-26 13:08:33,082 - train_models - INFO - Building model for WorkType: 210
2025-05-26 13:08:34,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:08:51,397 - train_models - INFO - Model for 210 - MAE: 0.4240, RMSE: 0.8405, R²: 0.9399, MAPE: 7.68%
2025-05-26 13:08:51,398 - train_models - INFO - Top 10 most important features for 210:
2025-05-26 13:08:51,398 - train_models - INFO -   Relative_Quantity: 0.8398
2025-05-26 13:08:51,398 - train_models - INFO -   Hours_per_Quantity: 0.0455
2025-05-26 13:08:51,398 - train_models - INFO -   Quantity_per_Worker: 0.0445
2025-05-26 13:08:51,399 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0418
2025-05-26 13:08:51,399 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0077
2025-05-26 13:08:51,399 - train_models - INFO -   SystemHours_per_Quantity: 0.0038
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_7day_trend: 0.0021
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-26 13:08:51,400 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0013
2025-05-26 13:08:51,401 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-26 13:08:51,401 - train_models - INFO - Cross-validation details for 210:
2025-05-26 13:08:51,401 - train_models - INFO -   Fold 1: MAE=0.5914, RMSE=1.2312, R²=0.8855, MAPE=9.06%
2025-05-26 13:08:51,401 - train_models - INFO -   Fold 2: MAE=0.3998, RMSE=0.6481, R²=0.9587, MAPE=4.68%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 3: MAE=0.4204, RMSE=0.9508, R²=0.9170, MAPE=6.46%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 4: MAE=0.3568, RMSE=0.5934, R²=0.9683, MAPE=13.62%
2025-05-26 13:08:51,402 - train_models - INFO -   Fold 5: MAE=0.3515, RMSE=0.7791, R²=0.9698, MAPE=4.57%
2025-05-26 13:08:51,402 - train_models - INFO - Building model for WorkType: 211
2025-05-26 13:08:52,676 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:12,003 - train_models - INFO - Model for 211 - MAE: 0.7181, RMSE: 1.0179, R²: 0.9022, MAPE: 11.32%
2025-05-26 13:09:12,004 - train_models - INFO - Top 10 most important features for 211:
2025-05-26 13:09:12,004 - train_models - INFO -   Relative_Quantity: 0.4584
2025-05-26 13:09:12,004 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1704
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_1day_trend: 0.0957
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0857
2025-05-26 13:09:12,005 - train_models - INFO -   NoOfMan_7day_trend: 0.0709
2025-05-26 13:09:12,006 - train_models - INFO -   NoOfMan_lag_1: 0.0334
2025-05-26 13:09:12,006 - train_models - INFO -   NoOfMan_lag_7: 0.0205
2025-05-26 13:09:12,006 - train_models - INFO -   Quantity_per_Worker: 0.0120
2025-05-26 13:09:12,006 - train_models - INFO -   Hours_per_Quantity: 0.0083
2025-05-26 13:09:12,007 - train_models - INFO -   SystemHours_per_Quantity: 0.0061
2025-05-26 13:09:12,007 - train_models - INFO - Cross-validation details for 211:
2025-05-26 13:09:12,007 - train_models - INFO -   Fold 1: MAE=0.9295, RMSE=1.3181, R²=0.8356, MAPE=12.15%
2025-05-26 13:09:12,007 - train_models - INFO -   Fold 2: MAE=0.8370, RMSE=1.2905, R²=0.8772, MAPE=17.07%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 3: MAE=0.4956, RMSE=0.6765, R²=0.9442, MAPE=6.14%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 4: MAE=0.8053, RMSE=1.0463, R²=0.9129, MAPE=15.28%
2025-05-26 13:09:12,008 - train_models - INFO -   Fold 5: MAE=0.5230, RMSE=0.7581, R²=0.9409, MAPE=5.98%
2025-05-26 13:09:12,008 - train_models - INFO - Building model for WorkType: 213
2025-05-26 13:09:13,088 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:31,027 - train_models - INFO - Model for 213 - MAE: 0.3652, RMSE: 0.5318, R²: 0.8792, MAPE: 16.00%
2025-05-26 13:09:31,027 - train_models - INFO - Top 10 most important features for 213:
2025-05-26 13:09:31,027 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3528
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_7day_trend: 0.2751
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_1day_trend: 0.1606
2025-05-26 13:09:31,028 - train_models - INFO -   NoOfMan_lag_1: 0.0458
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0377
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0321
2025-05-26 13:09:31,029 - train_models - INFO -   NoOfMan_lag_7: 0.0233
2025-05-26 13:09:31,030 - train_models - INFO -   Relative_Quantity: 0.0210
2025-05-26 13:09:31,030 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0103
2025-05-26 13:09:31,030 - train_models - INFO -   NoOfMan_lag_3: 0.0039
2025-05-26 13:09:31,030 - train_models - INFO - Cross-validation details for 213:
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 1: MAE=0.4228, RMSE=0.5268, R²=0.8031, MAPE=25.54%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 2: MAE=0.4249, RMSE=0.6591, R²=0.8574, MAPE=17.38%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 3: MAE=0.3701, RMSE=0.5328, R²=0.9108, MAPE=15.08%
2025-05-26 13:09:31,031 - train_models - INFO -   Fold 4: MAE=0.2930, RMSE=0.4935, R²=0.9082, MAPE=11.76%
2025-05-26 13:09:31,032 - train_models - INFO -   Fold 5: MAE=0.3152, RMSE=0.4471, R²=0.9164, MAPE=10.21%
2025-05-26 13:09:31,032 - train_models - INFO - Building model for WorkType: 214
2025-05-26 13:09:32,119 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:09:49,164 - train_models - INFO - Model for 214 - MAE: 0.5290, RMSE: 0.7906, R²: 0.8804, MAPE: 11.74%
2025-05-26 13:09:49,164 - train_models - INFO - Top 10 most important features for 214:
2025-05-26 13:09:49,165 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4963
2025-05-26 13:09:49,165 - train_models - INFO -   NoOfMan_7day_trend: 0.1492
2025-05-26 13:09:49,165 - train_models - INFO -   Relative_Quantity: 0.0951
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0615
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_1day_trend: 0.0557
2025-05-26 13:09:49,166 - train_models - INFO -   NoOfMan_lag_7: 0.0321
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_lag_1: 0.0213
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0122
2025-05-26 13:09:49,167 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0106
2025-05-26 13:09:49,168 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0100
2025-05-26 13:09:49,168 - train_models - INFO - Cross-validation details for 214:
2025-05-26 13:09:49,168 - train_models - INFO -   Fold 1: MAE=0.5091, RMSE=0.6635, R²=0.8630, MAPE=12.84%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 2: MAE=0.4450, RMSE=0.5736, R²=0.9150, MAPE=11.73%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 3: MAE=0.4155, RMSE=0.5811, R²=0.9157, MAPE=9.03%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 4: MAE=0.6155, RMSE=1.0759, R²=0.8420, MAPE=11.85%
2025-05-26 13:09:49,169 - train_models - INFO -   Fold 5: MAE=0.6598, RMSE=1.0588, R²=0.8664, MAPE=13.26%
2025-05-26 13:09:49,169 - train_models - INFO - Building model for WorkType: 217
2025-05-26 13:09:50,232 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-26 13:10:04,961 - train_models - INFO - Model for 217 - MAE: 0.4292, RMSE: 0.6073, R²: 0.9036, MAPE: 16.76%
2025-05-26 13:10:04,961 - train_models - INFO - Top 10 most important features for 217:
2025-05-26 13:10:04,961 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3810
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_rolling_max_7: 0.2293
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_7day_trend: 0.1901
2025-05-26 13:10:04,962 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_lag_7: 0.0376
2025-05-26 13:10:04,963 - train_models - INFO -   Relative_Quantity: 0.0268
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0221
2025-05-26 13:10:04,963 - train_models - INFO -   NoOfMan_lag_1: 0.0210
2025-05-26 13:10:04,964 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0055
2025-05-26 13:10:04,964 - train_models - INFO -   Hours_per_Quantity: 0.0053
2025-05-26 13:10:04,964 - train_models - INFO - Cross-validation details for 217:
2025-05-26 13:10:04,964 - train_models - INFO -   Fold 1: MAE=0.4528, RMSE=0.6085, R²=0.8604, MAPE=22.05%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 2: MAE=0.4698, RMSE=0.7099, R²=0.9008, MAPE=16.35%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 3: MAE=0.3432, RMSE=0.4589, R²=0.9252, MAPE=13.86%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 4: MAE=0.4748, RMSE=0.6488, R²=0.9218, MAPE=17.60%
2025-05-26 13:10:04,965 - train_models - INFO -   Fold 5: MAE=0.4054, RMSE=0.6102, R²=0.9098, MAPE=13.96%
2025-05-26 13:10:04,966 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-26 13:10:05,254 - train_models - INFO - Model files saved successfully
2025-05-26 13:10:05,254 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-26 13:10:05,257 - train_models - INFO - Model training completed successfully
2025-05-30 12:53:33,161 - train_models - INFO - Starting the model training process
2025-05-30 12:53:33,162 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 12:57:20,329 - train_models - INFO - Starting the model training process
2025-05-30 12:57:20,330 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 12:57:20,335 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 12:57:20,506 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            
2025-05-30 12:57:21,060 - train_models - ERROR - Error in train_from_sql: Execution failed on sql '
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")
2025-05-30 12:57:21,116 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2674, in execute
    cur.execute(sql, *args)
    ~~~~~~~~~~~^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 313, in train_from_sql
    for chunk in pd.read_sql(sql_query, conn, chunksize=CHUNK_SIZE):
                 ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 706, in read_sql
    return pandas_sql.read_query(
           ~~~~~~~~~~~~~~~~~~~~~^
        sql,
        ^^^^
    ...<6 lines>...
        dtype=dtype,
        ^^^^^^^^^^^^
    )
    ^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2738, in read_query
    cursor = self.execute(sql, params)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\io\sql.py", line 2686, in execute
    raise ex from exc
pandas.errors.DatabaseError: Execution failed on sql '
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) WHERE Date = '2023-05-01'
            ': ('42000', "[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Incorrect syntax near the keyword 'WHERE'. (156) (SQLExecDirectW)")

2025-05-30 12:57:21,117 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 12:57:49,077 - train_models - INFO - Starting the model training process
2025-05-30 12:57:49,078 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 12:57:49,087 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 12:57:49,289 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) and Date = '2024-05-01'
            
2025-05-30 12:57:49,742 - train_models - INFO - Read chunk of 4 rows
2025-05-30 12:57:49,760 - train_models - INFO - Data loaded successfully. Total rows: 4
2025-05-30 12:57:49,762 - train_models - INFO - Converting Date column to datetime format
2025-05-30 12:57:49,770 - train_models - INFO - Engineering features...
2025-05-30 12:57:50,422 - utils.feature_engineering - INFO - Engineering features
2025-05-30 12:57:50,443 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 12:57:50,445 - train_models - INFO - Creating lag features...
2025-05-30 12:57:50,456 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 12:57:50,595 - utils.feature_engineering - INFO - Lag features created. Dropped 4 rows with NaN values.
2025-05-30 12:57:50,595 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 12:57:50,611 - train_models - INFO - Found 0 unique work types
2025-05-30 12:57:50,611 - train_models - INFO - Building models for 0 work types
2025-05-30 12:57:50,611 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 12:57:50,612 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 12:57:50,612 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 12:57:51,129 - train_models - INFO - Model files saved successfully
2025-05-30 12:57:51,130 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 12:57:51,130 - train_models - INFO - Model training completed successfully
2025-05-30 13:00:08,522 - train_models - INFO - Starting the model training process
2025-05-30 13:00:08,522 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:00:08,525 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:00:08,661 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
            FROM WorkUtilizationData where PunchCode in (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) and Date >= '2024-05-01'
            
2025-05-30 13:00:09,299 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:00:09,320 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:00:09,323 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:00:09,355 - train_models - INFO - Engineering features...
2025-05-30 13:00:09,818 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:00:09,833 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:00:09,835 - train_models - INFO - Creating lag features...
2025-05-30 13:00:09,841 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:00:09,989 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:00:09,990 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:00:09,991 - train_models - INFO - Found 0 unique work types
2025-05-30 13:00:09,991 - train_models - INFO - Building models for 0 work types
2025-05-30 13:00:09,992 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:00:09,992 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:00:09,992 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:00:10,494 - train_models - INFO - Model files saved successfully
2025-05-30 13:00:10,494 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:00:10,496 - train_models - INFO - Model training completed successfully
2025-05-30 13:02:10,785 - train_models - INFO - Starting the model training process
2025-05-30 13:02:10,786 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:02:10,789 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:02:10,932 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01'
            
2025-05-30 13:02:11,706 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:02:11,725 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:02:11,726 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:02:11,754 - train_models - INFO - Engineering features...
2025-05-30 13:02:12,299 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:02:12,311 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:02:12,313 - train_models - INFO - Creating lag features...
2025-05-30 13:02:12,321 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:02:12,436 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:02:12,437 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:02:12,438 - train_models - INFO - Found 0 unique work types
2025-05-30 13:02:12,438 - train_models - INFO - Building models for 0 work types
2025-05-30 13:02:12,439 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:02:12,439 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:02:12,439 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:02:12,917 - train_models - INFO - Model files saved successfully
2025-05-30 13:02:12,918 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:02:12,918 - train_models - INFO - Model training completed successfully
2025-05-30 13:04:26,330 - train_models - INFO - Starting the model training process
2025-05-30 13:04:26,331 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:04:26,335 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:04:26,491 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01'
            
2025-05-30 13:04:27,225 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:04:27,254 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:04:27,270 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:04:27,375 - train_models - INFO - Engineering features...
2025-05-30 13:04:27,867 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:04:27,886 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:04:27,888 - train_models - INFO - Creating lag features...
2025-05-30 13:04:27,896 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:04:28,030 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:04:28,031 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:04:28,032 - train_models - INFO - Found 0 unique work types
2025-05-30 13:04:28,033 - train_models - INFO - Building models for 0 work types
2025-05-30 13:04:28,033 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:04:28,033 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:04:28,034 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:04:28,409 - train_models - INFO - Model files saved successfully
2025-05-30 13:04:28,409 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:04:28,410 - train_models - INFO - Model training completed successfully
2025-05-30 13:05:06,115 - train_models - INFO - Starting the model training process
2025-05-30 13:05:06,116 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:05:06,124 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:05:06,318 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:05:06,752 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:05:06,774 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:05:06,775 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:05:06,812 - train_models - INFO - Engineering features...
2025-05-30 13:05:07,710 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:05:07,726 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:05:07,732 - train_models - INFO - Creating lag features...
2025-05-30 13:05:07,756 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:05:07,956 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:05:07,957 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:05:07,958 - train_models - INFO - Found 0 unique work types
2025-05-30 13:05:07,959 - train_models - INFO - Building models for 0 work types
2025-05-30 13:05:07,959 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:05:07,959 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:05:07,960 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:05:08,551 - train_models - INFO - Model files saved successfully
2025-05-30 13:05:08,552 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:05:08,553 - train_models - INFO - Model training completed successfully
2025-05-30 13:06:15,991 - train_models - INFO - Starting the model training process
2025-05-30 13:06:15,993 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:06:16,006 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:06:16,166 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:06:16,802 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:06:16,825 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:06:16,827 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:06:16,843 - train_models - INFO - Engineering features...
2025-05-30 13:06:17,281 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:06:17,302 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:06:17,333 - train_models - INFO - Creating lag features...
2025-05-30 13:06:17,343 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:06:17,514 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:06:17,514 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:06:17,516 - train_models - INFO - Found 0 unique work types
2025-05-30 13:06:17,516 - train_models - INFO - Building models for 0 work types
2025-05-30 13:06:17,517 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:06:17,517 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:06:17,517 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:06:17,805 - train_models - INFO - Model files saved successfully
2025-05-30 13:06:17,806 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:06:17,806 - train_models - INFO - Model training completed successfully
2025-05-30 13:07:25,548 - train_models - INFO - Starting the model training process
2025-05-30 13:07:25,548 - train_models - WARNING - File not found: c:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 13:07:44,172 - train_models - INFO - Starting the model training process
2025-05-30 13:07:44,173 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:07:44,176 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:07:44,305 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:07:44,830 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:07:44,854 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:07:44,855 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:07:44,867 - train_models - INFO - Engineering features...
2025-05-30 13:07:45,319 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:07:45,335 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:07:46,961 - train_models - INFO - Creating lag features...
2025-05-30 13:07:46,973 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:07:47,170 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:07:47,171 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:07:47,173 - train_models - INFO - Found 0 unique work types
2025-05-30 13:07:47,173 - train_models - INFO - Building models for 0 work types
2025-05-30 13:07:47,174 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:07:47,174 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:07:47,174 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:07:47,187 - train_models - INFO - Model files saved successfully
2025-05-30 13:07:47,187 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:07:47,189 - train_models - INFO - Model training completed successfully
2025-05-30 13:13:08,964 - train_models - INFO - Starting the model training process
2025-05-30 13:13:08,964 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:13:08,971 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:13:09,121 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:13:09,970 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:13:09,992 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:13:09,995 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:13:10,027 - train_models - INFO - Engineering features...
2025-05-30 13:13:10,770 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:13:10,803 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:13:10,806 - train_models - INFO - Creating lag features...
2025-05-30 13:13:10,820 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:13:11,033 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:13:11,033 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:13:11,035 - train_models - INFO - Found 0 unique work types
2025-05-30 13:13:11,035 - train_models - INFO - Building models for 0 work types
2025-05-30 13:13:11,036 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:13:11,036 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:13:11,036 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:13:11,491 - train_models - INFO - Model files saved successfully
2025-05-30 13:13:11,492 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:13:11,492 - train_models - INFO - Model training completed successfully
2025-05-30 13:14:38,933 - train_models - INFO - Starting the model training process
2025-05-30 13:14:38,933 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:14:38,938 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:14:39,078 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:14:39,850 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:14:39,870 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:14:39,872 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:14:39,883 - train_models - INFO - Engineering features...
2025-05-30 13:14:40,682 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:14:40,698 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:14:40,699 - train_models - INFO - Creating lag features...
2025-05-30 13:14:40,707 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:14:40,832 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:14:40,833 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:14:40,835 - train_models - INFO - Found 9 unique work types
2025-05-30 13:14:40,835 - train_models - INFO - Building models for 9 work types
2025-05-30 13:14:40,835 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:14:40,836 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:14:40,836 - train_models - INFO - Building model for WorkType: 206
2025-05-30 13:14:40,837 - train_models - WARNING - Skipping 206: Not enough data (0 records)
2025-05-30 13:14:40,837 - train_models - INFO - Building model for WorkType: 209
2025-05-30 13:14:40,839 - train_models - WARNING - Skipping 209: Not enough data (0 records)
2025-05-30 13:14:40,839 - train_models - INFO - Building model for WorkType: 211
2025-05-30 13:14:40,840 - train_models - WARNING - Skipping 211: Not enough data (0 records)
2025-05-30 13:14:40,840 - train_models - INFO - Building model for WorkType: 210
2025-05-30 13:14:40,841 - train_models - WARNING - Skipping 210: Not enough data (0 records)
2025-05-30 13:14:40,842 - train_models - INFO - Building model for WorkType: 214
2025-05-30 13:14:40,843 - train_models - WARNING - Skipping 214: Not enough data (0 records)
2025-05-30 13:14:40,843 - train_models - INFO - Building model for WorkType: 217
2025-05-30 13:14:40,844 - train_models - WARNING - Skipping 217: Not enough data (0 records)
2025-05-30 13:14:40,844 - train_models - INFO - Building model for WorkType: 202
2025-05-30 13:14:40,846 - train_models - WARNING - Skipping 202: Not enough data (0 records)
2025-05-30 13:14:40,846 - train_models - INFO - Building model for WorkType: 203
2025-05-30 13:14:40,847 - train_models - WARNING - Skipping 203: Not enough data (0 records)
2025-05-30 13:14:40,848 - train_models - INFO - Building model for WorkType: 213
2025-05-30 13:14:40,850 - train_models - WARNING - Skipping 213: Not enough data (0 records)
2025-05-30 13:14:40,850 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:14:41,322 - train_models - INFO - Model files saved successfully
2025-05-30 13:14:41,323 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:14:41,323 - train_models - INFO - Model training completed successfully
2025-05-30 13:16:27,092 - train_models - INFO - Starting the model training process
2025-05-30 13:16:27,092 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:16:27,097 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:16:27,231 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:16:27,920 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:16:27,941 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:16:27,942 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:16:27,959 - train_models - INFO - Engineering features...
2025-05-30 13:16:28,405 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:16:28,419 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:16:28,421 - train_models - INFO - Creating lag features...
2025-05-30 13:16:28,429 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:16:28,567 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:16:28,567 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:16:28,569 - train_models - ERROR - Error in train_from_sql: 'DataFrame' object has no attribute 'Head'
2025-05-30 13:16:28,658 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 362, in train_from_sql
    print('XXX-X ', lag_features_df.Head())
                    ^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'Head'. Did you mean: 'head'?

2025-05-30 13:16:28,660 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 13:16:55,904 - train_models - INFO - Starting the model training process
2025-05-30 13:16:55,904 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:16:55,908 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:16:56,177 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:16:57,097 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:16:57,116 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:16:57,118 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:16:57,133 - train_models - INFO - Engineering features...
2025-05-30 13:16:57,555 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:16:57,570 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:16:57,572 - train_models - INFO - Creating lag features...
2025-05-30 13:16:57,580 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:16:57,725 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:16:57,726 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:16:57,734 - train_models - INFO - Found 0 unique work types
2025-05-30 13:16:57,735 - train_models - INFO - Building models for 0 work types
2025-05-30 13:16:57,736 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:16:57,737 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:16:57,739 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:16:58,148 - train_models - INFO - Model files saved successfully
2025-05-30 13:16:58,148 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:16:58,149 - train_models - INFO - Model training completed successfully
2025-05-30 13:44:28,247 - train_models - INFO - Starting the model training process
2025-05-30 13:44:28,247 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:44:28,251 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:44:28,549 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:44:28,949 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:44:28,966 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:44:28,968 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:44:28,976 - train_models - INFO - Engineering features...
2025-05-30 13:44:29,428 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:44:29,440 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:44:29,442 - train_models - INFO - Creating lag features...
2025-05-30 13:44:29,449 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:44:29,565 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:44:29,565 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:44:29,569 - train_models - INFO - Found 0 unique work types
2025-05-30 13:44:29,569 - train_models - INFO - Building models for 0 work types
2025-05-30 13:44:29,569 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:44:29,570 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:44:29,570 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:44:29,824 - train_models - INFO - Model files saved successfully
2025-05-30 13:44:29,824 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:44:29,825 - train_models - INFO - Model training completed successfully
2025-05-30 13:45:08,431 - train_models - INFO - Starting the model training process
2025-05-30 13:45:08,432 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:45:08,434 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:45:08,548 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:45:08,944 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:45:08,960 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:45:08,961 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:45:08,968 - train_models - INFO - Engineering features...
2025-05-30 13:45:09,325 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:45:09,339 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:45:09,342 - train_models - INFO - Creating lag features...
2025-05-30 13:45:09,350 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:45:09,470 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:45:09,470 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:45:09,473 - train_models - INFO - Found 0 unique work types
2025-05-30 13:45:09,474 - train_models - INFO - Building models for 0 work types
2025-05-30 13:45:09,474 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:45:09,474 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:45:09,475 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:45:09,713 - train_models - INFO - Model files saved successfully
2025-05-30 13:45:09,714 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:45:09,714 - train_models - INFO - Model training completed successfully
2025-05-30 13:45:34,889 - train_models - INFO - Starting the model training process
2025-05-30 13:45:34,890 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:45:34,893 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:45:35,007 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:45:35,396 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:45:35,411 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:45:35,412 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:45:35,422 - train_models - INFO - Engineering features...
2025-05-30 13:45:35,750 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:45:35,762 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:45:35,764 - train_models - INFO - Creating lag features...
2025-05-30 13:45:35,771 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:45:35,885 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:45:35,885 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:45:35,888 - train_models - INFO - Found 0 unique work types
2025-05-30 13:45:35,888 - train_models - INFO - Building models for 0 work types
2025-05-30 13:45:35,888 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:45:35,889 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:45:35,889 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:45:36,113 - train_models - INFO - Model files saved successfully
2025-05-30 13:45:36,114 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:45:36,114 - train_models - INFO - Model training completed successfully
2025-05-30 13:46:21,908 - train_models - INFO - Starting the model training process
2025-05-30 13:46:21,908 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:46:21,911 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:46:22,023 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:46:22,422 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:46:22,441 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:46:22,442 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:46:22,455 - train_models - INFO - Engineering features...
2025-05-30 13:46:22,789 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:46:22,801 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:46:22,804 - train_models - INFO - Creating lag features...
2025-05-30 13:46:22,811 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:46:22,929 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:46:22,929 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:46:22,932 - train_models - INFO - Found 0 unique work types
2025-05-30 13:46:22,932 - train_models - INFO - Building models for 0 work types
2025-05-30 13:46:22,933 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:46:22,933 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:46:22,934 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:46:23,204 - train_models - INFO - Model files saved successfully
2025-05-30 13:46:23,204 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:46:23,205 - train_models - INFO - Model training completed successfully
2025-05-30 13:48:04,297 - train_models - INFO - Starting the model training process
2025-05-30 13:48:04,297 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:48:04,300 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:48:04,420 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:48:04,634 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:48:04,650 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:48:04,651 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:48:04,656 - train_models - INFO - Engineering features...
2025-05-30 13:48:05,035 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:48:05,063 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:48:05,066 - train_models - INFO - Creating lag features...
2025-05-30 13:48:05,077 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:48:05,190 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:48:05,190 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:48:05,194 - train_models - INFO - Found 0 unique work types
2025-05-30 13:48:05,194 - train_models - INFO - Building models for 0 work types
2025-05-30 13:48:05,194 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:48:05,195 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:48:05,195 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:48:05,438 - train_models - INFO - Model files saved successfully
2025-05-30 13:48:05,439 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:48:05,439 - train_models - INFO - Model training completed successfully
2025-05-30 13:50:19,738 - train_models - INFO - Starting the model training process
2025-05-30 13:50:19,738 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:50:19,741 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:50:19,860 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:50:20,322 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:50:20,338 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:50:20,340 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:50:20,354 - train_models - INFO - Engineering features...
2025-05-30 13:50:20,749 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:50:20,765 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:50:20,768 - train_models - INFO - Creating lag features...
2025-05-30 13:50:20,775 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:50:20,896 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:50:20,896 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:50:20,899 - train_models - INFO - Found 0 unique work types
2025-05-30 13:50:20,899 - train_models - INFO - Building models for 0 work types
2025-05-30 13:50:20,899 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:50:20,900 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:50:20,900 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:50:21,135 - train_models - INFO - Model files saved successfully
2025-05-30 13:50:21,136 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:50:21,137 - train_models - INFO - Model training completed successfully
2025-05-30 13:54:59,828 - train_models - INFO - Starting the model training process
2025-05-30 13:54:59,828 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:54:59,831 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:54:59,947 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:55:00,345 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:55:00,360 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:55:00,361 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:55:00,366 - train_models - INFO - Engineering features...
2025-05-30 13:55:00,785 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:55:00,798 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:55:00,801 - train_models - INFO - Creating lag features...
2025-05-30 13:55:00,806 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:55:00,832 - utils.feature_engineering - ERROR - Error creating lag features: 'DataFrame' object has no attribute 'HEAD'
2025-05-30 13:55:00,877 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 213, in create_lag_features
    print('XXX-X ',daily_data.HEAD())
                   ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'HEAD'

2025-05-30 13:55:00,878 - train_models - ERROR - Error in train_from_sql: Failed to create lag features: 'DataFrame' object has no attribute 'HEAD'
2025-05-30 13:55:00,881 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 213, in create_lag_features
    print('XXX-X ',daily_data.HEAD())
                   ^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'HEAD'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 359, in train_from_sql
    lag_features_df = create_lag_features(feature_df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 277, in create_lag_features
    raise Exception(f"Failed to create lag features: {str(e)}")
Exception: Failed to create lag features: 'DataFrame' object has no attribute 'HEAD'

2025-05-30 13:55:00,882 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 13:55:20,926 - train_models - INFO - Starting the model training process
2025-05-30 13:55:20,926 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:55:20,930 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:55:21,053 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:55:21,452 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:55:21,469 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:55:21,470 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:55:21,481 - train_models - INFO - Engineering features...
2025-05-30 13:55:21,980 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:55:21,991 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:55:21,993 - train_models - INFO - Creating lag features...
2025-05-30 13:55:22,001 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:55:22,179 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:55:22,180 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:55:22,182 - train_models - INFO - Found 0 unique work types
2025-05-30 13:55:22,183 - train_models - INFO - Building models for 0 work types
2025-05-30 13:55:22,183 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:55:22,183 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:55:22,184 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:55:22,433 - train_models - INFO - Model files saved successfully
2025-05-30 13:55:22,433 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:55:22,434 - train_models - INFO - Model training completed successfully
2025-05-30 13:57:28,092 - train_models - INFO - Starting the model training process
2025-05-30 13:57:28,093 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:57:28,096 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:57:28,206 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:57:28,608 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:57:28,623 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:57:28,624 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:57:28,634 - train_models - INFO - Engineering features...
2025-05-30 13:57:29,192 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:57:29,210 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:57:29,213 - train_models - INFO - Creating lag features...
2025-05-30 13:57:29,220 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:57:29,368 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:57:29,369 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:57:29,372 - train_models - INFO - Found 0 unique work types
2025-05-30 13:57:29,372 - train_models - INFO - Building models for 0 work types
2025-05-30 13:57:29,372 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:57:29,373 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:57:29,373 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:57:29,624 - train_models - INFO - Model files saved successfully
2025-05-30 13:57:29,625 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:57:29,625 - train_models - INFO - Model training completed successfully
2025-05-30 13:57:59,357 - train_models - INFO - Starting the model training process
2025-05-30 13:57:59,357 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:57:59,360 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:57:59,480 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:57:59,698 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:57:59,714 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:57:59,715 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:57:59,721 - train_models - INFO - Engineering features...
2025-05-30 13:58:00,106 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:58:00,131 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:58:00,134 - train_models - INFO - Creating lag features...
2025-05-30 13:58:00,142 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:58:00,272 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:58:00,273 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:58:00,275 - train_models - INFO - Found 0 unique work types
2025-05-30 13:58:00,276 - train_models - INFO - Building models for 0 work types
2025-05-30 13:58:00,276 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:58:00,276 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:58:00,277 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:58:00,507 - train_models - INFO - Model files saved successfully
2025-05-30 13:58:00,507 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:58:00,507 - train_models - INFO - Model training completed successfully
2025-05-30 13:58:40,891 - train_models - INFO - Starting the model training process
2025-05-30 13:58:40,892 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:58:40,896 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:58:41,005 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:58:41,410 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:58:41,427 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:58:41,429 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:58:41,436 - train_models - INFO - Engineering features...
2025-05-30 13:58:41,761 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:58:41,772 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:58:41,775 - train_models - INFO - Creating lag features...
2025-05-30 13:58:41,783 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:58:41,917 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:58:41,917 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:58:41,920 - train_models - INFO - Found 0 unique work types
2025-05-30 13:58:41,920 - train_models - INFO - Building models for 0 work types
2025-05-30 13:58:41,921 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:58:41,921 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:58:41,922 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:58:42,162 - train_models - INFO - Model files saved successfully
2025-05-30 13:58:42,162 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:58:42,163 - train_models - INFO - Model training completed successfully
2025-05-30 13:59:25,045 - train_models - INFO - Starting the model training process
2025-05-30 13:59:25,046 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 13:59:25,049 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 13:59:25,158 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 13:59:25,542 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 13:59:25,559 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 13:59:25,560 - train_models - INFO - Converting Date column to datetime format
2025-05-30 13:59:25,570 - train_models - INFO - Engineering features...
2025-05-30 13:59:25,971 - utils.feature_engineering - INFO - Engineering features
2025-05-30 13:59:25,985 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 13:59:25,986 - train_models - INFO - Creating lag features...
2025-05-30 13:59:25,994 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 13:59:26,140 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 13:59:26,141 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 13:59:26,144 - train_models - INFO - Found 0 unique work types
2025-05-30 13:59:26,144 - train_models - INFO - Building models for 0 work types
2025-05-30 13:59:26,144 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 13:59:26,145 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 13:59:26,145 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 13:59:26,379 - train_models - INFO - Model files saved successfully
2025-05-30 13:59:26,379 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 13:59:26,380 - train_models - INFO - Model training completed successfully
2025-05-30 14:00:06,876 - train_models - INFO - Starting the model training process
2025-05-30 14:00:06,876 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:00:06,879 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:00:06,986 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:00:07,376 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:00:07,391 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:00:07,392 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:00:07,397 - train_models - INFO - Engineering features...
2025-05-30 14:00:07,800 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:00:07,813 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:00:07,815 - train_models - INFO - Creating lag features...
2025-05-30 14:00:07,822 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:00:07,963 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:00:07,964 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:00:07,967 - train_models - INFO - Found 0 unique work types
2025-05-30 14:00:07,967 - train_models - INFO - Building models for 0 work types
2025-05-30 14:00:07,968 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:00:07,968 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:00:07,968 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:00:08,203 - train_models - INFO - Model files saved successfully
2025-05-30 14:00:08,203 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:00:08,204 - train_models - INFO - Model training completed successfully
2025-05-30 14:00:28,063 - train_models - INFO - Starting the model training process
2025-05-30 14:00:28,063 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:00:28,066 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:00:28,180 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:00:28,575 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:00:28,591 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:00:28,593 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:00:28,605 - train_models - INFO - Engineering features...
2025-05-30 14:00:28,948 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:00:28,962 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:00:28,964 - train_models - INFO - Creating lag features...
2025-05-30 14:00:28,971 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:00:29,118 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:00:29,118 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:00:29,121 - train_models - INFO - Found 0 unique work types
2025-05-30 14:00:29,122 - train_models - INFO - Building models for 0 work types
2025-05-30 14:00:29,122 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:00:29,122 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:00:29,123 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:00:29,364 - train_models - INFO - Model files saved successfully
2025-05-30 14:00:29,364 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:00:29,365 - train_models - INFO - Model training completed successfully
2025-05-30 14:01:13,855 - train_models - INFO - Starting the model training process
2025-05-30 14:01:13,855 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:01:13,858 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:01:13,983 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:01:14,391 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:01:14,408 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:01:14,409 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:01:14,422 - train_models - INFO - Engineering features...
2025-05-30 14:01:14,764 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:01:14,786 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:01:14,789 - train_models - INFO - Creating lag features...
2025-05-30 14:01:14,800 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:01:14,979 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:01:14,979 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:01:14,981 - train_models - INFO - Found 0 unique work types
2025-05-30 14:01:14,981 - train_models - INFO - Building models for 0 work types
2025-05-30 14:01:14,981 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:01:14,982 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:01:14,982 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:01:15,205 - train_models - INFO - Model files saved successfully
2025-05-30 14:01:15,205 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:01:15,206 - train_models - INFO - Model training completed successfully
2025-05-30 14:02:41,569 - train_models - INFO - Starting the model training process
2025-05-30 14:02:41,569 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:02:41,572 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:02:41,684 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:02:42,075 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:02:42,090 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:02:42,091 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:02:42,097 - train_models - INFO - Engineering features...
2025-05-30 14:02:42,436 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:02:42,449 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:02:42,450 - train_models - INFO - Creating lag features...
2025-05-30 14:02:42,457 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:02:42,578 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:02:42,579 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:02:42,582 - train_models - INFO - Found 0 unique work types
2025-05-30 14:02:42,582 - train_models - INFO - Building models for 0 work types
2025-05-30 14:02:42,583 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:02:42,583 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:02:42,584 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:02:42,823 - train_models - INFO - Model files saved successfully
2025-05-30 14:02:42,823 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:02:42,824 - train_models - INFO - Model training completed successfully
2025-05-30 14:03:51,753 - train_models - INFO - Starting the model training process
2025-05-30 14:03:51,754 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:03:51,757 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:03:51,874 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:03:52,289 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:03:52,306 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:03:52,307 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:03:52,316 - train_models - INFO - Engineering features...
2025-05-30 14:03:52,728 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:03:52,740 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:03:52,742 - train_models - INFO - Creating lag features...
2025-05-30 14:03:52,750 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:03:52,873 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:03:52,873 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:03:52,878 - train_models - INFO - Found 0 unique work types
2025-05-30 14:03:52,878 - train_models - INFO - Building models for 0 work types
2025-05-30 14:03:52,878 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:03:52,879 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:03:52,879 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:03:53,139 - train_models - INFO - Model files saved successfully
2025-05-30 14:03:53,140 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:03:53,141 - train_models - INFO - Model training completed successfully
2025-05-30 14:05:03,605 - train_models - INFO - Starting the model training process
2025-05-30 14:05:03,605 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:05:03,608 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:05:03,729 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:05:04,126 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:05:04,143 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:05:04,145 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:05:04,154 - train_models - INFO - Engineering features...
2025-05-30 14:05:04,564 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:05:04,576 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:05:04,579 - train_models - INFO - Creating lag features...
2025-05-30 14:05:04,587 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:05:04,744 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:05:04,744 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:05:04,748 - train_models - INFO - Found 0 unique work types
2025-05-30 14:05:04,748 - train_models - INFO - Building models for 0 work types
2025-05-30 14:05:04,748 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:05:04,749 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:05:04,749 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:05:04,993 - train_models - INFO - Model files saved successfully
2025-05-30 14:05:04,993 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:05:04,994 - train_models - INFO - Model training completed successfully
2025-05-30 14:07:34,995 - train_models - INFO - Starting the model training process
2025-05-30 14:07:34,995 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:07:34,998 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:07:35,149 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:07:35,543 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:07:35,559 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:07:35,561 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:07:35,570 - train_models - INFO - Engineering features...
2025-05-30 14:07:35,980 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:07:35,991 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:07:35,994 - train_models - INFO - Creating lag features...
2025-05-30 14:07:36,000 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:07:36,153 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:07:36,154 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:07:36,157 - train_models - INFO - Found 0 unique work types
2025-05-30 14:07:36,158 - train_models - INFO - Building models for 0 work types
2025-05-30 14:07:36,158 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:07:36,159 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:07:36,159 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:07:36,406 - train_models - INFO - Model files saved successfully
2025-05-30 14:07:36,406 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:07:36,407 - train_models - INFO - Model training completed successfully
2025-05-30 14:13:31,309 - train_models - INFO - Starting the model training process
2025-05-30 14:13:31,310 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:13:31,313 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:13:31,442 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:13:31,875 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:13:31,891 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:13:31,892 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:13:31,900 - train_models - INFO - Engineering features...
2025-05-30 14:13:32,357 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:13:32,390 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:13:32,392 - train_models - INFO - Creating lag features...
2025-05-30 14:13:32,404 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:13:35,792 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:13:35,793 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:13:35,796 - train_models - INFO - Found 0 unique work types
2025-05-30 14:13:35,796 - train_models - INFO - Building models for 0 work types
2025-05-30 14:13:35,797 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:13:35,797 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:13:35,798 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:13:35,822 - train_models - INFO - Model files saved successfully
2025-05-30 14:13:35,823 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:13:35,824 - train_models - INFO - Model training completed successfully
2025-05-30 14:18:26,991 - train_models - INFO - Starting the model training process
2025-05-30 14:18:26,991 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:18:26,994 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:18:27,110 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:18:27,515 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:18:27,531 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:18:27,533 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:18:27,544 - train_models - INFO - Engineering features...
2025-05-30 14:18:28,014 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:18:28,027 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:18:28,029 - train_models - INFO - Creating lag features...
2025-05-30 14:18:28,035 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:18:28,195 - utils.feature_engineering - INFO - Lag features created. Dropped 2508 rows with NaN values.
2025-05-30 14:18:28,195 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:18:28,198 - train_models - INFO - Found 0 unique work types
2025-05-30 14:18:28,199 - train_models - INFO - Building models for 0 work types
2025-05-30 14:18:28,199 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:18:28,199 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:18:28,200 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:18:28,469 - train_models - INFO - Model files saved successfully
2025-05-30 14:18:28,469 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:18:28,470 - train_models - INFO - Model training completed successfully
2025-05-30 14:21:08,900 - train_models - INFO - Starting the model training process
2025-05-30 14:21:08,900 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:21:08,904 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:21:09,011 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:21:09,426 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:21:09,443 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:21:09,444 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:21:09,453 - train_models - INFO - Engineering features...
2025-05-30 14:21:09,860 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:21:09,874 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:21:09,877 - train_models - INFO - Creating lag features...
2025-05-30 14:21:09,883 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:21:10,032 - utils.feature_engineering - INFO - Lag features created. Dropped 273 2508 rows with NaN values.
2025-05-30 14:21:10,032 - utils.feature_engineering - INFO - Final shape: (0, 72)
2025-05-30 14:21:10,037 - train_models - INFO - Found 0 unique work types
2025-05-30 14:21:10,037 - train_models - INFO - Building models for 0 work types
2025-05-30 14:21:10,037 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:21:10,038 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:21:10,038 - train_models - INFO - Saving 0 models to C:/forlogssystems/Models
2025-05-30 14:21:10,288 - train_models - INFO - Model files saved successfully
2025-05-30 14:21:10,288 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:21:10,289 - train_models - INFO - Model training completed successfully
2025-05-30 14:26:06,135 - train_models - INFO - Starting the model training process
2025-05-30 14:26:06,136 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:26:06,140 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:26:06,267 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:26:06,676 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:26:06,694 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:26:06,695 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:26:06,703 - train_models - INFO - Engineering features...
2025-05-30 14:26:07,148 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:26:07,164 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:26:07,166 - train_models - INFO - Creating lag features...
2025-05-30 14:26:07,172 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:26:07,466 - utils.feature_engineering - INFO - Lag features created. Dropped 273 320 rows with NaN values.
2025-05-30 14:26:07,466 - utils.feature_engineering - INFO - Final shape: (2188, 71)
2025-05-30 14:26:07,526 - train_models - INFO - Found 9 unique work types
2025-05-30 14:26:07,527 - train_models - INFO - Building models for 9 work types
2025-05-30 14:26:07,527 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:26:07,527 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:26:07,527 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:26:08,062 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:11,764 - train_models - INFO - Model for 202 - MAE: 0.4370, RMSE: 0.5447, R²: 0.3888, MAPE: 21.40%
2025-05-30 14:26:11,764 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:26:11,764 - train_models - INFO -   NoOfMan_7day_trend: 0.2539
2025-05-30 14:26:11,764 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2422
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1521
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_1day_trend: 0.0798
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0743
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_lag_7: 0.0359
2025-05-30 14:26:11,765 - train_models - INFO -   NoOfMan_lag_1: 0.0248
2025-05-30 14:26:11,766 - train_models - INFO -   Relative_Quantity: 0.0247
2025-05-30 14:26:11,766 - train_models - INFO -   Hours_per_Quantity: 0.0125
2025-05-30 14:26:11,766 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0123
2025-05-30 14:26:11,766 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 1: MAE=0.6832, RMSE=0.8306, R²=0.0214, MAPE=44.63%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 2: MAE=0.5031, RMSE=0.6078, R²=-0.2087, MAPE=13.78%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 3: MAE=0.3501, RMSE=0.4301, R²=0.7068, MAPE=12.64%
2025-05-30 14:26:11,767 - train_models - INFO -   Fold 4: MAE=0.3514, RMSE=0.4675, R²=0.6735, MAPE=18.46%
2025-05-30 14:26:11,768 - train_models - INFO -   Fold 5: MAE=0.2970, RMSE=0.3876, R²=0.7508, MAPE=17.48%
2025-05-30 14:26:11,768 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:26:12,028 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:15,779 - train_models - INFO - Model for 203 - MAE: 0.4061, RMSE: 0.5467, R²: 0.6239, MAPE: 8.79%
2025-05-30 14:26:15,779 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_7day_trend: 0.3821
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_lag_7: 0.1570
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_1day_trend: 0.0941
2025-05-30 14:26:15,780 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0866
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0801
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_lag_1: 0.0516
2025-05-30 14:26:15,781 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0434
2025-05-30 14:26:15,782 - train_models - INFO -   Relative_Quantity: 0.0096
2025-05-30 14:26:15,782 - train_models - INFO -   Quantity_7day_trend: 0.0080
2025-05-30 14:26:15,782 - train_models - INFO -   Quantity_1day_trend: 0.0077
2025-05-30 14:26:15,783 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 1: MAE=0.5195, RMSE=0.6445, R²=0.4529, MAPE=10.74%
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 2: MAE=0.4008, RMSE=0.4868, R²=0.5832, MAPE=8.19%
2025-05-30 14:26:15,783 - train_models - INFO -   Fold 3: MAE=0.4977, RMSE=0.6484, R²=0.6028, MAPE=10.99%
2025-05-30 14:26:15,784 - train_models - INFO -   Fold 4: MAE=0.3272, RMSE=0.4170, R²=0.7747, MAPE=8.82%
2025-05-30 14:26:15,784 - train_models - INFO -   Fold 5: MAE=0.2854, RMSE=0.5368, R²=0.7061, MAPE=5.21%
2025-05-30 14:26:15,784 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:26:16,101 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:21,066 - train_models - INFO - Model for 206 - MAE: 2.3149, RMSE: 3.0920, R²: 0.8877, MAPE: 20.42%
2025-05-30 14:26:21,067 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:26:21,067 - train_models - INFO -   Relative_Quantity: 0.6697
2025-05-30 14:26:21,067 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1990
2025-05-30 14:26:21,067 - train_models - INFO -   Hours_per_Quantity: 0.0173
2025-05-30 14:26:21,067 - train_models - INFO -   Quantity_per_Worker: 0.0156
2025-05-30 14:26:21,068 - train_models - INFO -   NoOfMan_lag_7: 0.0141
2025-05-30 14:26:21,068 - train_models - INFO -   Quantity_same_dow_lag: 0.0125
2025-05-30 14:26:21,068 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0115
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_1day_trend: 0.0089
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 14:26:21,069 - train_models - INFO -   NoOfMan_lag_1: 0.0058
2025-05-30 14:26:21,069 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 1: MAE=1.9725, RMSE=2.6428, R²=0.9040, MAPE=41.39%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 2: MAE=4.1789, RMSE=5.4720, R²=0.7532, MAPE=18.18%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 3: MAE=3.0870, RMSE=4.0498, R²=0.8985, MAPE=27.87%
2025-05-30 14:26:21,070 - train_models - INFO -   Fold 4: MAE=1.2587, RMSE=1.7882, R²=0.9371, MAPE=7.93%
2025-05-30 14:26:21,071 - train_models - INFO -   Fold 5: MAE=1.0774, RMSE=1.5070, R²=0.9456, MAPE=6.71%
2025-05-30 14:26:21,071 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:26:21,351 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:26,499 - train_models - INFO - Model for 209 - MAE: 1.0513, RMSE: 1.5231, R²: 0.8668, MAPE: 13.62%
2025-05-30 14:26:26,499 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:26:26,500 - train_models - INFO -   Relative_Quantity: 0.7998
2025-05-30 14:26:26,500 - train_models - INFO -   Hours_per_Quantity: 0.0436
2025-05-30 14:26:26,500 - train_models - INFO -   Quantity_rolling_mean_7: 0.0336
2025-05-30 14:26:26,501 - train_models - INFO -   Quantity_per_Worker: 0.0327
2025-05-30 14:26:26,501 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0233
2025-05-30 14:26:26,501 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0217
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_lag_3: 0.0076
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0056
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0025
2025-05-30 14:26:26,502 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0025
2025-05-30 14:26:26,503 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:26:26,503 - train_models - INFO -   Fold 1: MAE=1.0165, RMSE=1.4209, R²=0.8762, MAPE=15.13%
2025-05-30 14:26:26,503 - train_models - INFO -   Fold 2: MAE=1.2161, RMSE=1.9983, R²=0.8897, MAPE=13.27%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 3: MAE=1.7240, RMSE=2.5080, R²=0.8868, MAPE=20.18%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 4: MAE=0.6147, RMSE=0.7672, R²=0.8898, MAPE=9.16%
2025-05-30 14:26:26,504 - train_models - INFO -   Fold 5: MAE=0.6853, RMSE=0.9214, R²=0.7917, MAPE=10.34%
2025-05-30 14:26:26,504 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:26:26,800 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:30,900 - train_models - INFO - Model for 210 - MAE: 1.0684, RMSE: 1.5436, R²: 0.8374, MAPE: 14.93%
2025-05-30 14:26:30,900 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:26:30,901 - train_models - INFO -   Relative_Quantity: 0.8227
2025-05-30 14:26:30,901 - train_models - INFO -   Hours_per_Quantity: 0.0274
2025-05-30 14:26:30,901 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0256
2025-05-30 14:26:30,901 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0247
2025-05-30 14:26:30,901 - train_models - INFO -   Quantity_per_Worker: 0.0203
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0141
2025-05-30 14:26:30,902 - train_models - INFO -   SystemHours_per_Quantity: 0.0091
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_1day_trend: 0.0090
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_7day_trend: 0.0045
2025-05-30 14:26:30,902 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0041
2025-05-30 14:26:30,903 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 1: MAE=0.8580, RMSE=1.1201, R²=0.8885, MAPE=16.99%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 2: MAE=1.4346, RMSE=2.0930, R²=0.7613, MAPE=17.99%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 3: MAE=2.0236, RMSE=3.1549, R²=0.7538, MAPE=20.85%
2025-05-30 14:26:30,903 - train_models - INFO -   Fold 4: MAE=0.5838, RMSE=0.7421, R²=0.8731, MAPE=11.23%
2025-05-30 14:26:30,904 - train_models - INFO -   Fold 5: MAE=0.4423, RMSE=0.6077, R²=0.9103, MAPE=7.58%
2025-05-30 14:26:30,904 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:26:31,181 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:35,240 - train_models - INFO - Model for 211 - MAE: 1.2977, RMSE: 1.6444, R²: 0.6187, MAPE: 24.26%
2025-05-30 14:26:35,240 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:26:35,241 - train_models - INFO -   Relative_Quantity: 0.4600
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1435
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_7day_trend: 0.1119
2025-05-30 14:26:35,241 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0799
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_1day_trend: 0.0554
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_lag_7: 0.0211
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0184
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_lag_1: 0.0170
2025-05-30 14:26:35,242 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0094
2025-05-30 14:26:35,243 - train_models - INFO -   Quantity_rolling_mean_7: 0.0092
2025-05-30 14:26:35,243 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 1: MAE=2.1205, RMSE=2.5756, R²=-0.0038, MAPE=28.27%
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 2: MAE=1.7778, RMSE=2.1498, R²=0.6232, MAPE=36.58%
2025-05-30 14:26:35,243 - train_models - INFO -   Fold 3: MAE=1.1830, RMSE=1.6672, R²=0.7294, MAPE=28.81%
2025-05-30 14:26:35,244 - train_models - INFO -   Fold 4: MAE=0.6881, RMSE=0.8603, R²=0.8317, MAPE=8.48%
2025-05-30 14:26:35,244 - train_models - INFO -   Fold 5: MAE=0.7192, RMSE=0.9692, R²=0.9133, MAPE=19.17%
2025-05-30 14:26:35,244 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:26:35,623 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:39,436 - train_models - INFO - Model for 213 - MAE: 0.5635, RMSE: 0.7353, R²: 0.5260, MAPE: 19.23%
2025-05-30 14:26:39,436 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:26:39,437 - train_models - INFO -   Relative_Quantity: 0.7322
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0395
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_7day_trend: 0.0356
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0305
2025-05-30 14:26:39,437 - train_models - INFO -   NoOfMan_1day_trend: 0.0268
2025-05-30 14:26:39,438 - train_models - INFO -   Hours_per_Quantity: 0.0164
2025-05-30 14:26:39,438 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0139
2025-05-30 14:26:39,438 - train_models - INFO -   Quantity_per_Worker: 0.0127
2025-05-30 14:26:39,438 - train_models - INFO -   Quantity_same_dow_lag: 0.0078
2025-05-30 14:26:39,439 - train_models - INFO -   NoOfMan_lag_3: 0.0072
2025-05-30 14:26:39,439 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 1: MAE=0.9961, RMSE=1.2010, R²=0.3235, MAPE=24.52%
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 2: MAE=0.4934, RMSE=0.6980, R²=0.8192, MAPE=18.10%
2025-05-30 14:26:39,439 - train_models - INFO -   Fold 3: MAE=0.5072, RMSE=0.7223, R²=0.7400, MAPE=13.08%
2025-05-30 14:26:39,440 - train_models - INFO -   Fold 4: MAE=0.4489, RMSE=0.5864, R²=0.1588, MAPE=21.32%
2025-05-30 14:26:39,440 - train_models - INFO -   Fold 5: MAE=0.3718, RMSE=0.4688, R²=0.5886, MAPE=19.10%
2025-05-30 14:26:39,440 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:26:39,701 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:43,699 - train_models - INFO - Model for 214 - MAE: 0.9986, RMSE: 1.2457, R²: 0.5877, MAPE: 21.43%
2025-05-30 14:26:43,699 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:26:43,699 - train_models - INFO -   NoOfMan_same_dow_lag: 0.3043
2025-05-30 14:26:43,699 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2584
2025-05-30 14:26:43,700 - train_models - INFO -   Relative_Quantity: 0.1744
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_7day_trend: 0.0587
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_1day_trend: 0.0487
2025-05-30 14:26:43,700 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0236
2025-05-30 14:26:43,700 - train_models - INFO -   Hours_per_Quantity: 0.0131
2025-05-30 14:26:43,701 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0127
2025-05-30 14:26:43,701 - train_models - INFO -   Quantity_per_Worker: 0.0125
2025-05-30 14:26:43,701 - train_models - INFO -   NoOfMan_lag_1: 0.0116
2025-05-30 14:26:43,701 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:26:43,701 - train_models - INFO -   Fold 1: MAE=1.0479, RMSE=1.2443, R²=0.5623, MAPE=15.32%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 2: MAE=1.7898, RMSE=2.2686, R²=0.3783, MAPE=41.57%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 3: MAE=0.8518, RMSE=1.1146, R²=0.8680, MAPE=15.35%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 4: MAE=0.8274, RMSE=0.9411, R²=0.3133, MAPE=26.23%
2025-05-30 14:26:43,702 - train_models - INFO -   Fold 5: MAE=0.4761, RMSE=0.6598, R²=0.8166, MAPE=8.69%
2025-05-30 14:26:43,703 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:26:44,074 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:26:47,573 - train_models - INFO - Model for 217 - MAE: 0.7324, RMSE: 1.0014, R²: 0.6865, MAPE: 25.05%
2025-05-30 14:26:47,574 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:26:47,574 - train_models - INFO -   Relative_Quantity: 0.5540
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_7day_trend: 0.0762
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0586
2025-05-30 14:26:47,574 - train_models - INFO -   NoOfMan_1day_trend: 0.0537
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0503
2025-05-30 14:26:47,575 - train_models - INFO -   Hours_per_Quantity: 0.0426
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0402
2025-05-30 14:26:47,575 - train_models - INFO -   Quantity_per_Worker: 0.0322
2025-05-30 14:26:47,575 - train_models - INFO -   NoOfMan_lag_1: 0.0111
2025-05-30 14:26:47,575 - train_models - INFO -   Quantity_rolling_mean_7: 0.0093
2025-05-30 14:26:47,576 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 1: MAE=0.6824, RMSE=0.9047, R²=0.7039, MAPE=27.62%
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 2: MAE=0.6725, RMSE=0.7898, R²=0.5255, MAPE=19.90%
2025-05-30 14:26:47,576 - train_models - INFO -   Fold 3: MAE=1.0583, RMSE=1.5943, R²=0.5939, MAPE=35.66%
2025-05-30 14:26:47,577 - train_models - INFO -   Fold 4: MAE=0.7917, RMSE=0.9984, R²=0.7799, MAPE=21.89%
2025-05-30 14:26:47,577 - train_models - INFO -   Fold 5: MAE=0.4571, RMSE=0.7199, R²=0.8293, MAPE=20.19%
2025-05-30 14:26:47,577 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:26:47,697 - train_models - INFO - Model files saved successfully
2025-05-30 14:26:47,697 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:26:47,698 - train_models - INFO - Model training completed successfully
2025-05-30 14:32:04,416 - train_models - INFO - Starting the model training process
2025-05-30 14:32:04,417 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:32:04,420 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:32:04,528 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2024-05-01' order by Date
            
2025-05-30 14:32:04,929 - train_models - INFO - Read chunk of 2508 rows
2025-05-30 14:32:04,945 - train_models - INFO - Data loaded successfully. Total rows: 2508
2025-05-30 14:32:04,946 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:32:04,952 - train_models - INFO - Engineering features...
2025-05-30 14:32:05,456 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:32:05,469 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:32:05,471 - train_models - INFO - Creating lag features...
2025-05-30 14:32:05,477 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:32:05,682 - utils.feature_engineering - INFO - Lag features created. Dropped AMILA 0 rows with NaN values.
2025-05-30 14:32:05,682 - utils.feature_engineering - INFO - Final shape: (2508, 71)
2025-05-30 14:32:05,685 - train_models - INFO - Found 9 unique work types
2025-05-30 14:32:05,685 - train_models - INFO - Building models for 9 work types
2025-05-30 14:32:05,686 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:32:05,686 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:32:05,686 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:32:06,236 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:10,535 - train_models - INFO - Model for 202 - MAE: 0.3825, RMSE: 0.4959, R²: 0.6849, MAPE: 17.38%
2025-05-30 14:32:10,535 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:32:10,535 - train_models - INFO -   NoOfMan_7day_trend: 0.2930
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2193
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1087
2025-05-30 14:32:10,536 - train_models - INFO -   NoOfMan_rolling_min_7: 0.1004
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_1day_trend: 0.0888
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_lag_7: 0.0421
2025-05-30 14:32:10,537 - train_models - INFO -   NoOfMan_lag_1: 0.0279
2025-05-30 14:32:10,537 - train_models - INFO -   Relative_Quantity: 0.0168
2025-05-30 14:32:10,538 - train_models - INFO -   Hours_per_Quantity: 0.0142
2025-05-30 14:32:10,538 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0127
2025-05-30 14:32:10,538 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 1: MAE=0.4484, RMSE=0.5973, R²=0.5319, MAPE=15.61%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 2: MAE=0.4518, RMSE=0.5734, R²=0.7260, MAPE=24.04%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 3: MAE=0.3600, RMSE=0.4430, R²=0.6620, MAPE=12.58%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 4: MAE=0.3601, RMSE=0.4903, R²=0.7416, MAPE=19.39%
2025-05-30 14:32:10,539 - train_models - INFO -   Fold 5: MAE=0.2920, RMSE=0.3754, R²=0.7631, MAPE=15.25%
2025-05-30 14:32:10,540 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:32:10,840 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:15,268 - train_models - INFO - Model for 203 - MAE: 0.4452, RMSE: 0.6032, R²: 0.4934, MAPE: 11.46%
2025-05-30 14:32:15,268 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:32:15,268 - train_models - INFO -   NoOfMan_7day_trend: 0.4025
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_lag_7: 0.1357
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_1day_trend: 0.1054
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0762
2025-05-30 14:32:15,269 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0716
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_lag_1: 0.0472
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0445
2025-05-30 14:32:15,270 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0174
2025-05-30 14:32:15,271 - train_models - INFO -   Relative_Quantity: 0.0083
2025-05-30 14:32:15,271 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0073
2025-05-30 14:32:15,271 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:32:15,272 - train_models - INFO -   Fold 1: MAE=0.7082, RMSE=0.8444, R²=-0.2331, MAPE=20.26%
2025-05-30 14:32:15,272 - train_models - INFO -   Fold 2: MAE=0.4275, RMSE=0.5369, R²=0.5640, MAPE=8.31%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 3: MAE=0.4579, RMSE=0.6113, R²=0.6318, MAPE=9.59%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 4: MAE=0.3290, RMSE=0.5403, R²=0.7073, MAPE=12.77%
2025-05-30 14:32:15,273 - train_models - INFO -   Fold 5: MAE=0.3034, RMSE=0.4833, R²=0.7969, MAPE=6.39%
2025-05-30 14:32:15,273 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:32:15,803 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:21,862 - train_models - INFO - Model for 206 - MAE: 2.2802, RMSE: 3.0490, R²: 0.8866, MAPE: 19.17%
2025-05-30 14:32:21,863 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:32:21,863 - train_models - INFO -   Relative_Quantity: 0.6868
2025-05-30 14:32:21,863 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1845
2025-05-30 14:32:21,864 - train_models - INFO -   Hours_per_Quantity: 0.0224
2025-05-30 14:32:21,864 - train_models - INFO -   Quantity_per_Worker: 0.0170
2025-05-30 14:32:21,864 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0129
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_lag_7: 0.0129
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_1day_trend: 0.0086
2025-05-30 14:32:21,865 - train_models - INFO -   Quantity_same_dow_lag: 0.0077
2025-05-30 14:32:21,865 - train_models - INFO -   NoOfMan_7day_trend: 0.0060
2025-05-30 14:32:21,866 - train_models - INFO -   NoOfMan_lag_1: 0.0045
2025-05-30 14:32:21,866 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:32:21,866 - train_models - INFO -   Fold 1: MAE=2.3688, RMSE=3.2272, R²=0.8343, MAPE=36.55%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 2: MAE=2.4216, RMSE=3.2458, R²=0.8815, MAPE=17.49%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 3: MAE=4.3996, RMSE=5.5529, R²=0.8232, MAPE=24.41%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 4: MAE=1.2238, RMSE=1.8185, R²=0.9421, MAPE=11.69%
2025-05-30 14:32:21,867 - train_models - INFO -   Fold 5: MAE=0.9873, RMSE=1.4006, R²=0.9517, MAPE=5.71%
2025-05-30 14:32:21,868 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:32:22,240 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:27,103 - train_models - INFO - Model for 209 - MAE: 1.0983, RMSE: 1.5601, R²: 0.8740, MAPE: 11.96%
2025-05-30 14:32:27,103 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:32:27,104 - train_models - INFO -   Relative_Quantity: 0.8145
2025-05-30 14:32:27,104 - train_models - INFO -   Hours_per_Quantity: 0.0398
2025-05-30 14:32:27,104 - train_models - INFO -   Quantity_rolling_mean_7: 0.0384
2025-05-30 14:32:27,104 - train_models - INFO -   Quantity_per_Worker: 0.0274
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0269
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0129
2025-05-30 14:32:27,105 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0072
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_lag_3: 0.0033
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_lag_1: 0.0027
2025-05-30 14:32:27,106 - train_models - INFO -   NoOfMan_1day_trend: 0.0025
2025-05-30 14:32:27,106 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 1: MAE=0.9555, RMSE=1.2186, R²=0.8971, MAPE=12.63%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 2: MAE=1.0616, RMSE=1.5300, R²=0.9019, MAPE=10.30%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 3: MAE=2.2919, RMSE=3.4727, R²=0.7996, MAPE=18.80%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 4: MAE=0.5942, RMSE=0.7872, R²=0.9357, MAPE=9.15%
2025-05-30 14:32:27,107 - train_models - INFO -   Fold 5: MAE=0.5885, RMSE=0.7922, R²=0.8358, MAPE=8.92%
2025-05-30 14:32:27,108 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:32:27,487 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:32,803 - train_models - INFO - Model for 210 - MAE: 1.0165, RMSE: 1.4622, R²: 0.8475, MAPE: 13.20%
2025-05-30 14:32:32,804 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:32:32,804 - train_models - INFO -   Relative_Quantity: 0.8298
2025-05-30 14:32:32,804 - train_models - INFO -   Hours_per_Quantity: 0.0283
2025-05-30 14:32:32,804 - train_models - INFO -   Quantity_per_Worker: 0.0249
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0244
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0238
2025-05-30 14:32:32,805 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0146
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_1day_trend: 0.0076
2025-05-30 14:32:32,806 - train_models - INFO -   SystemHours_per_Quantity: 0.0051
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0045
2025-05-30 14:32:32,806 - train_models - INFO -   NoOfMan_7day_trend: 0.0041
2025-05-30 14:32:32,807 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 1: MAE=1.0706, RMSE=1.3207, R²=0.8155, MAPE=18.32%
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 2: MAE=0.9194, RMSE=1.2934, R²=0.8884, MAPE=11.38%
2025-05-30 14:32:32,807 - train_models - INFO -   Fold 3: MAE=2.0492, RMSE=3.3407, R²=0.7159, MAPE=16.49%
2025-05-30 14:32:32,808 - train_models - INFO -   Fold 4: MAE=0.6765, RMSE=0.8581, R²=0.8826, MAPE=13.73%
2025-05-30 14:32:32,808 - train_models - INFO -   Fold 5: MAE=0.3668, RMSE=0.4982, R²=0.9350, MAPE=6.08%
2025-05-30 14:32:32,808 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:32:33,113 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:38,271 - train_models - INFO - Model for 211 - MAE: 1.1369, RMSE: 1.3713, R²: 0.7088, MAPE: 17.33%
2025-05-30 14:32:38,272 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:32:38,272 - train_models - INFO -   Relative_Quantity: 0.4646
2025-05-30 14:32:38,272 - train_models - INFO -   NoOfMan_7day_trend: 0.1351
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1329
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0567
2025-05-30 14:32:38,273 - train_models - INFO -   NoOfMan_1day_trend: 0.0471
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_lag_7: 0.0263
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0254
2025-05-30 14:32:38,274 - train_models - INFO -   NoOfMan_lag_1: 0.0230
2025-05-30 14:32:38,275 - train_models - INFO -   NoOfMan_lag_3: 0.0111
2025-05-30 14:32:38,275 - train_models - INFO -   Quantity_rolling_mean_7: 0.0076
2025-05-30 14:32:38,275 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:32:38,275 - train_models - INFO -   Fold 1: MAE=1.0811, RMSE=1.3093, R²=0.6595, MAPE=20.73%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 2: MAE=2.0033, RMSE=2.2920, R²=0.3072, MAPE=21.96%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 3: MAE=1.4614, RMSE=1.7637, R²=0.7388, MAPE=23.51%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 4: MAE=0.5180, RMSE=0.6750, R²=0.9031, MAPE=7.02%
2025-05-30 14:32:38,276 - train_models - INFO -   Fold 5: MAE=0.6206, RMSE=0.8166, R²=0.9356, MAPE=13.42%
2025-05-30 14:32:38,277 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:32:38,561 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:43,172 - train_models - INFO - Model for 213 - MAE: 0.5732, RMSE: 0.7454, R²: 0.6744, MAPE: 21.59%
2025-05-30 14:32:43,173 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:32:43,173 - train_models - INFO -   Relative_Quantity: 0.6992
2025-05-30 14:32:43,173 - train_models - INFO -   NoOfMan_7day_trend: 0.0464
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0403
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0366
2025-05-30 14:32:43,174 - train_models - INFO -   NoOfMan_1day_trend: 0.0269
2025-05-30 14:32:43,175 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0216
2025-05-30 14:32:43,175 - train_models - INFO -   Hours_per_Quantity: 0.0207
2025-05-30 14:32:43,175 - train_models - INFO -   Quantity_per_Worker: 0.0141
2025-05-30 14:32:43,175 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0085
2025-05-30 14:32:43,176 - train_models - INFO -   NoOfMan_lag_1: 0.0084
2025-05-30 14:32:43,176 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:32:43,176 - train_models - INFO -   Fold 1: MAE=0.9422, RMSE=1.1651, R²=0.7060, MAPE=40.11%
2025-05-30 14:32:43,176 - train_models - INFO -   Fold 2: MAE=0.7012, RMSE=0.8772, R²=0.5840, MAPE=19.36%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 3: MAE=0.4585, RMSE=0.6662, R²=0.8210, MAPE=14.06%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 4: MAE=0.4869, RMSE=0.6621, R²=0.5031, MAPE=20.18%
2025-05-30 14:32:43,177 - train_models - INFO -   Fold 5: MAE=0.2774, RMSE=0.3566, R²=0.7580, MAPE=14.23%
2025-05-30 14:32:43,177 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:32:43,482 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:48,390 - train_models - INFO - Model for 214 - MAE: 0.9799, RMSE: 1.2754, R²: 0.6008, MAPE: 22.06%
2025-05-30 14:32:48,391 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:32:48,391 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3510
2025-05-30 14:32:48,391 - train_models - INFO -   NoOfMan_same_dow_lag: 0.1854
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_7day_trend: 0.1140
2025-05-30 14:32:48,392 - train_models - INFO -   Relative_Quantity: 0.1033
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_1day_trend: 0.0589
2025-05-30 14:32:48,392 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0388
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0206
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_lag_1: 0.0140
2025-05-30 14:32:48,393 - train_models - INFO -   NoOfMan_lag_7: 0.0125
2025-05-30 14:32:48,393 - train_models - INFO -   Quantity_per_Worker: 0.0096
2025-05-30 14:32:48,394 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 1: MAE=1.1608, RMSE=1.4729, R²=0.5437, MAPE=23.07%
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 2: MAE=1.0203, RMSE=1.2615, R²=0.6403, MAPE=13.09%
2025-05-30 14:32:48,394 - train_models - INFO -   Fold 3: MAE=1.6900, RMSE=2.3276, R²=0.5194, MAPE=44.64%
2025-05-30 14:32:48,395 - train_models - INFO -   Fold 4: MAE=0.5953, RMSE=0.7479, R²=0.4548, MAPE=21.20%
2025-05-30 14:32:48,395 - train_models - INFO -   Fold 5: MAE=0.4332, RMSE=0.5670, R²=0.8458, MAPE=8.27%
2025-05-30 14:32:48,395 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:32:48,675 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:32:52,769 - train_models - INFO - Model for 217 - MAE: 0.6622, RMSE: 0.8977, R²: 0.3626, MAPE: 28.94%
2025-05-30 14:32:52,769 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:32:52,770 - train_models - INFO -   Relative_Quantity: 0.6237
2025-05-30 14:32:52,770 - train_models - INFO -   NoOfMan_7day_trend: 0.0548
2025-05-30 14:32:52,770 - train_models - INFO -   Hours_per_Quantity: 0.0543
2025-05-30 14:32:52,770 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0482
2025-05-30 14:32:52,771 - train_models - INFO -   Quantity_per_Worker: 0.0450
2025-05-30 14:32:52,771 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0393
2025-05-30 14:32:52,771 - train_models - INFO -   NoOfMan_1day_trend: 0.0305
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0201
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_lag_1: 0.0115
2025-05-30 14:32:52,772 - train_models - INFO -   NoOfMan_lag_7: 0.0096
2025-05-30 14:32:52,773 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:32:52,773 - train_models - INFO -   Fold 1: MAE=0.9056, RMSE=1.0682, R²=-1.2680, MAPE=75.15%
2025-05-30 14:32:52,773 - train_models - INFO -   Fold 2: MAE=0.4783, RMSE=0.5909, R²=0.8154, MAPE=13.05%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 3: MAE=0.6515, RMSE=0.8181, R²=0.7364, MAPE=24.27%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 4: MAE=0.8869, RMSE=1.4481, R²=0.6397, MAPE=16.48%
2025-05-30 14:32:52,774 - train_models - INFO -   Fold 5: MAE=0.3885, RMSE=0.5631, R²=0.8897, MAPE=15.77%
2025-05-30 14:32:52,775 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:32:53,053 - train_models - INFO - Model files saved successfully
2025-05-30 14:32:53,054 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:32:53,055 - train_models - INFO - Model training completed successfully
2025-05-30 14:34:30,160 - train_models - INFO - Starting the model training process
2025-05-30 14:34:30,160 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 14:34:30,163 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 14:34:30,274 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                AND Date >= '2022-01-01' order by Date
            
2025-05-30 14:34:30,825 - train_models - INFO - Read chunk of 7967 rows
2025-05-30 14:34:30,841 - train_models - INFO - Data loaded successfully. Total rows: 7967
2025-05-30 14:34:30,843 - train_models - INFO - Converting Date column to datetime format
2025-05-30 14:34:30,851 - train_models - INFO - Engineering features...
2025-05-30 14:34:31,274 - utils.feature_engineering - INFO - Engineering features
2025-05-30 14:34:31,296 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 14:34:31,299 - train_models - INFO - Creating lag features...
2025-05-30 14:34:31,308 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 14:34:31,480 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 14:34:31,480 - utils.feature_engineering - INFO - Final shape: (7967, 71)
2025-05-30 14:34:31,489 - train_models - INFO - Found 9 unique work types
2025-05-30 14:34:31,490 - train_models - INFO - Building models for 9 work types
2025-05-30 14:34:31,490 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 14:34:31,490 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 14:34:31,490 - train_models - INFO - Building model for WorkType: 202
2025-05-30 14:34:32,548 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:34:45,639 - train_models - INFO - Model for 202 - MAE: 0.2496, RMSE: 0.3415, R²: 0.8206, MAPE: 11.28%
2025-05-30 14:34:45,639 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3089
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_7day_trend: 0.2154
2025-05-30 14:34:45,640 - train_models - INFO -   NoOfMan_1day_trend: 0.1250
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_lag_7: 0.0747
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_lag_1: 0.0713
2025-05-30 14:34:45,641 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0576
2025-05-30 14:34:45,642 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0494
2025-05-30 14:34:45,642 - train_models - INFO -   Relative_Quantity: 0.0291
2025-05-30 14:34:45,642 - train_models - INFO -   Hours_per_Quantity: 0.0165
2025-05-30 14:34:45,643 - train_models - INFO -   Quantity_per_Worker: 0.0073
2025-05-30 14:34:45,643 - train_models - INFO - Cross-validation details for 202:
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 1: MAE=0.3352, RMSE=0.4897, R²=0.6781, MAPE=14.72%
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 2: MAE=0.2478, RMSE=0.3265, R²=0.8086, MAPE=13.91%
2025-05-30 14:34:45,643 - train_models - INFO -   Fold 3: MAE=0.2309, RMSE=0.2907, R²=0.8272, MAPE=10.64%
2025-05-30 14:34:45,644 - train_models - INFO -   Fold 4: MAE=0.1864, RMSE=0.2669, R²=0.9008, MAPE=6.94%
2025-05-30 14:34:45,644 - train_models - INFO -   Fold 5: MAE=0.2478, RMSE=0.3338, R²=0.8881, MAPE=10.18%
2025-05-30 14:34:45,644 - train_models - INFO - Building model for WorkType: 203
2025-05-30 14:34:46,495 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:00,769 - train_models - INFO - Model for 203 - MAE: 0.2772, RMSE: 0.3891, R²: 0.8578, MAPE: 6.51%
2025-05-30 14:35:00,769 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 14:35:00,769 - train_models - INFO -   NoOfMan_7day_trend: 0.3247
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1661
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1131
2025-05-30 14:35:00,770 - train_models - INFO -   NoOfMan_lag_7: 0.1014
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_1day_trend: 0.0978
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0823
2025-05-30 14:35:00,771 - train_models - INFO -   NoOfMan_lag_1: 0.0571
2025-05-30 14:35:00,772 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0074
2025-05-30 14:35:00,772 - train_models - INFO -   Quantity_same_dow_lag: 0.0039
2025-05-30 14:35:00,772 - train_models - INFO -   NoOfMan_lag_3: 0.0037
2025-05-30 14:35:00,772 - train_models - INFO - Cross-validation details for 203:
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 1: MAE=0.3501, RMSE=0.4624, R²=0.7661, MAPE=6.80%
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 2: MAE=0.3825, RMSE=0.5184, R²=0.8099, MAPE=8.54%
2025-05-30 14:35:00,773 - train_models - INFO -   Fold 3: MAE=0.2122, RMSE=0.3255, R²=0.9096, MAPE=5.01%
2025-05-30 14:35:00,774 - train_models - INFO -   Fold 4: MAE=0.2164, RMSE=0.3015, R²=0.9094, MAPE=5.71%
2025-05-30 14:35:00,774 - train_models - INFO -   Fold 5: MAE=0.2250, RMSE=0.3379, R²=0.8940, MAPE=6.47%
2025-05-30 14:35:00,774 - train_models - INFO - Building model for WorkType: 206
2025-05-30 14:35:01,803 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:19,036 - train_models - INFO - Model for 206 - MAE: 1.3970, RMSE: 2.4092, R²: 0.9110, MAPE: 12.81%
2025-05-30 14:35:19,037 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 14:35:19,037 - train_models - INFO -   Relative_Quantity: 0.7677
2025-05-30 14:35:19,037 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0476
2025-05-30 14:35:19,038 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0461
2025-05-30 14:35:19,038 - train_models - INFO -   Hours_per_Quantity: 0.0383
2025-05-30 14:35:19,038 - train_models - INFO -   Quantity_per_Worker: 0.0233
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0196
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_1day_trend: 0.0118
2025-05-30 14:35:19,039 - train_models - INFO -   NoOfMan_7day_trend: 0.0067
2025-05-30 14:35:19,040 - train_models - INFO -   NoOfMan_lag_1: 0.0052
2025-05-30 14:35:19,040 - train_models - INFO -   DayOfWeek_feat_4: 0.0051
2025-05-30 14:35:19,040 - train_models - INFO - Cross-validation details for 206:
2025-05-30 14:35:19,040 - train_models - INFO -   Fold 1: MAE=2.1163, RMSE=3.3036, R²=0.8452, MAPE=11.19%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 2: MAE=1.3937, RMSE=2.6779, R²=0.8767, MAPE=7.96%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 3: MAE=1.0402, RMSE=1.6323, R²=0.9500, MAPE=7.23%
2025-05-30 14:35:19,041 - train_models - INFO -   Fold 4: MAE=1.0814, RMSE=2.1132, R²=0.9346, MAPE=28.85%
2025-05-30 14:35:19,042 - train_models - INFO -   Fold 5: MAE=1.3535, RMSE=2.3193, R²=0.9485, MAPE=8.82%
2025-05-30 14:35:19,042 - train_models - INFO - Building model for WorkType: 209
2025-05-30 14:35:19,906 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:34,411 - train_models - INFO - Model for 209 - MAE: 0.7136, RMSE: 1.2608, R²: 0.9103, MAPE: 10.30%
2025-05-30 14:35:34,411 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 14:35:34,411 - train_models - INFO -   Relative_Quantity: 0.7319
2025-05-30 14:35:34,412 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1132
2025-05-30 14:35:34,412 - train_models - INFO -   Hours_per_Quantity: 0.0639
2025-05-30 14:35:34,413 - train_models - INFO -   Quantity_per_Worker: 0.0470
2025-05-30 14:35:34,413 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0124
2025-05-30 14:35:34,413 - train_models - INFO -   NoOfMan_7day_trend: 0.0046
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0028
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_1day_trend: 0.0024
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0023
2025-05-30 14:35:34,414 - train_models - INFO -   NoOfMan_lag_3: 0.0020
2025-05-30 14:35:34,414 - train_models - INFO - Cross-validation details for 209:
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 1: MAE=1.1079, RMSE=1.7367, R²=0.8167, MAPE=11.20%
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 2: MAE=0.5055, RMSE=0.7861, R²=0.9260, MAPE=8.26%
2025-05-30 14:35:34,415 - train_models - INFO -   Fold 3: MAE=0.9945, RMSE=1.9997, R²=0.8685, MAPE=21.20%
2025-05-30 14:35:34,416 - train_models - INFO -   Fold 4: MAE=0.3945, RMSE=0.6977, R²=0.9760, MAPE=5.12%
2025-05-30 14:35:34,416 - train_models - INFO -   Fold 5: MAE=0.5658, RMSE=1.0838, R²=0.9645, MAPE=5.71%
2025-05-30 14:35:34,416 - train_models - INFO - Building model for WorkType: 210
2025-05-30 14:35:35,277 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:35:49,597 - train_models - INFO - Model for 210 - MAE: 0.5240, RMSE: 0.9807, R²: 0.9206, MAPE: 9.23%
2025-05-30 14:35:49,598 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 14:35:49,598 - train_models - INFO -   Relative_Quantity: 0.8523
2025-05-30 14:35:49,598 - train_models - INFO -   Quantity_per_Worker: 0.0468
2025-05-30 14:35:49,598 - train_models - INFO -   Hours_per_Quantity: 0.0420
2025-05-30 14:35:49,599 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0231
2025-05-30 14:35:49,599 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0066
2025-05-30 14:35:49,599 - train_models - INFO -   SystemHours_per_Quantity: 0.0040
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_7day_trend: 0.0031
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_1day_trend: 0.0027
2025-05-30 14:35:49,600 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0025
2025-05-30 14:35:49,601 - train_models - INFO -   Quantity_7day_trend: 0.0018
2025-05-30 14:35:49,601 - train_models - INFO - Cross-validation details for 210:
2025-05-30 14:35:49,601 - train_models - INFO -   Fold 1: MAE=0.8094, RMSE=1.3325, R²=0.8464, MAPE=8.77%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 2: MAE=0.4162, RMSE=0.6521, R²=0.9473, MAPE=5.08%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 3: MAE=0.6326, RMSE=1.3085, R²=0.8807, MAPE=21.81%
2025-05-30 14:35:49,602 - train_models - INFO -   Fold 4: MAE=0.3180, RMSE=0.5945, R²=0.9757, MAPE=5.44%
2025-05-30 14:35:49,603 - train_models - INFO -   Fold 5: MAE=0.4440, RMSE=1.0158, R²=0.9528, MAPE=5.03%
2025-05-30 14:35:49,603 - train_models - INFO - Building model for WorkType: 211
2025-05-30 14:35:50,494 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:06,074 - train_models - INFO - Model for 211 - MAE: 0.8124, RMSE: 1.1197, R²: 0.8764, MAPE: 14.08%
2025-05-30 14:36:06,075 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 14:36:06,075 - train_models - INFO -   Relative_Quantity: 0.4639
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1331
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0986
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_7day_trend: 0.0934
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_1day_trend: 0.0847
2025-05-30 14:36:06,076 - train_models - INFO -   NoOfMan_lag_1: 0.0267
2025-05-30 14:36:06,077 - train_models - INFO -   NoOfMan_lag_7: 0.0212
2025-05-30 14:36:06,077 - train_models - INFO -   Quantity_per_Worker: 0.0128
2025-05-30 14:36:06,077 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0090
2025-05-30 14:36:06,078 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0080
2025-05-30 14:36:06,078 - train_models - INFO - Cross-validation details for 211:
2025-05-30 14:36:06,078 - train_models - INFO -   Fold 1: MAE=1.3129, RMSE=1.8907, R²=0.7656, MAPE=24.14%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 2: MAE=0.7531, RMSE=1.0065, R²=0.8572, MAPE=11.56%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 3: MAE=0.7056, RMSE=1.0342, R²=0.9300, MAPE=11.51%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 4: MAE=0.7767, RMSE=0.9616, R²=0.8785, MAPE=17.09%
2025-05-30 14:36:06,079 - train_models - INFO -   Fold 5: MAE=0.5139, RMSE=0.7054, R²=0.9507, MAPE=6.08%
2025-05-30 14:36:06,080 - train_models - INFO - Building model for WorkType: 213
2025-05-30 14:36:06,945 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:21,701 - train_models - INFO - Model for 213 - MAE: 0.3923, RMSE: 0.5645, R²: 0.8798, MAPE: 15.07%
2025-05-30 14:36:21,702 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 14:36:21,702 - train_models - INFO -   Relative_Quantity: 0.3760
2025-05-30 14:36:21,702 - train_models - INFO -   NoOfMan_7day_trend: 0.2000
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0859
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0835
2025-05-30 14:36:21,703 - train_models - INFO -   NoOfMan_1day_trend: 0.0699
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0611
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_lag_1: 0.0265
2025-05-30 14:36:21,704 - train_models - INFO -   NoOfMan_lag_7: 0.0189
2025-05-30 14:36:21,705 - train_models - INFO -   Hours_per_Quantity: 0.0114
2025-05-30 14:36:21,705 - train_models - INFO -   Quantity_per_Worker: 0.0071
2025-05-30 14:36:21,705 - train_models - INFO - Cross-validation details for 213:
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 1: MAE=0.5768, RMSE=0.8524, R²=0.7553, MAPE=21.16%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 2: MAE=0.4330, RMSE=0.6221, R²=0.8873, MAPE=18.32%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 3: MAE=0.2834, RMSE=0.3922, R²=0.9126, MAPE=11.04%
2025-05-30 14:36:21,706 - train_models - INFO -   Fold 4: MAE=0.4056, RMSE=0.5968, R²=0.9012, MAPE=15.14%
2025-05-30 14:36:21,707 - train_models - INFO -   Fold 5: MAE=0.2625, RMSE=0.3587, R²=0.9426, MAPE=9.68%
2025-05-30 14:36:21,707 - train_models - INFO - Building model for WorkType: 214
2025-05-30 14:36:22,550 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:36,028 - train_models - INFO - Model for 214 - MAE: 0.6276, RMSE: 0.9079, R²: 0.8500, MAPE: 13.98%
2025-05-30 14:36:36,028 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 14:36:36,028 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5149
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_7day_trend: 0.1277
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0844
2025-05-30 14:36:36,029 - train_models - INFO -   NoOfMan_1day_trend: 0.0738
2025-05-30 14:36:36,029 - train_models - INFO -   Relative_Quantity: 0.0551
2025-05-30 14:36:36,030 - train_models - INFO -   NoOfMan_lag_1: 0.0281
2025-05-30 14:36:36,030 - train_models - INFO -   NoOfMan_lag_7: 0.0215
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0181
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0131
2025-05-30 14:36:36,031 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0095
2025-05-30 14:36:36,031 - train_models - INFO - Cross-validation details for 214:
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 1: MAE=0.6495, RMSE=0.7933, R²=0.8061, MAPE=18.17%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 2: MAE=0.4184, RMSE=0.5633, R²=0.9050, MAPE=11.16%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 3: MAE=0.6352, RMSE=0.9389, R²=0.8309, MAPE=11.55%
2025-05-30 14:36:36,032 - train_models - INFO -   Fold 4: MAE=0.7031, RMSE=1.0753, R²=0.8515, MAPE=13.13%
2025-05-30 14:36:36,033 - train_models - INFO -   Fold 5: MAE=0.7318, RMSE=1.1686, R²=0.8563, MAPE=15.92%
2025-05-30 14:36:36,033 - train_models - INFO - Building model for WorkType: 217
2025-05-30 14:36:36,956 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 14:36:49,111 - train_models - INFO - Model for 217 - MAE: 0.5163, RMSE: 0.7177, R²: 0.8723, MAPE: 19.67%
2025-05-30 14:36:49,112 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 14:36:49,112 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4253
2025-05-30 14:36:49,112 - train_models - INFO -   NoOfMan_7day_trend: 0.1829
2025-05-30 14:36:49,113 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1548
2025-05-30 14:36:49,113 - train_models - INFO -   Relative_Quantity: 0.0616
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_1day_trend: 0.0408
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_lag_7: 0.0375
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0236
2025-05-30 14:36:49,114 - train_models - INFO -   NoOfMan_lag_1: 0.0196
2025-05-30 14:36:49,115 - train_models - INFO -   Hours_per_Quantity: 0.0066
2025-05-30 14:36:49,115 - train_models - INFO -   Quantity_per_Worker: 0.0058
2025-05-30 14:36:49,115 - train_models - INFO - Cross-validation details for 217:
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 1: MAE=0.6605, RMSE=0.8868, R²=0.8177, MAPE=27.42%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 2: MAE=0.5520, RMSE=0.7961, R²=0.8466, MAPE=22.20%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 3: MAE=0.5175, RMSE=0.7297, R²=0.8855, MAPE=14.35%
2025-05-30 14:36:49,116 - train_models - INFO -   Fold 4: MAE=0.3610, RMSE=0.4835, R²=0.9205, MAPE=17.29%
2025-05-30 14:36:49,117 - train_models - INFO -   Fold 5: MAE=0.4905, RMSE=0.6925, R²=0.8913, MAPE=17.09%
2025-05-30 14:36:49,118 - train_models - INFO - Saving 9 models to C:/forlogssystems/Models
2025-05-30 14:36:49,430 - train_models - INFO - Model files saved successfully
2025-05-30 14:36:49,430 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 14:36:49,432 - train_models - INFO - Model training completed successfully
2025-05-30 14:38:42,364 - train_models - INFO - Starting the model training process
2025-05-30 14:38:42,364 - train_models - WARNING - File not found: C:\forlogssystems\work_utilization_app\data\work_utilization_melted1.csv
2025-05-30 15:07:09,350 - train_models - INFO - Starting the model training process
2025-05-30 15:07:09,350 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:07:09,354 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:07:09,476 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:07:10,077 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:07:10,125 - train_models - INFO - Read chunk of 3803 rows
2025-05-30 15:07:10,143 - train_models - INFO - Data loaded successfully. Total rows: 13803
2025-05-30 15:07:10,146 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:07:10,155 - train_models - INFO - Engineering features...
2025-05-30 15:07:10,598 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:07:10,626 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:07:10,631 - train_models - INFO - Creating lag features...
2025-05-30 15:07:10,640 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:07:10,836 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:07:10,836 - utils.feature_engineering - INFO - Final shape: (13803, 71)
2025-05-30 15:07:10,848 - train_models - INFO - Found 9 unique work types
2025-05-30 15:07:10,849 - train_models - INFO - Building models for 9 work types
2025-05-30 15:07:10,849 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:07:10,849 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:07:10,850 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:07:12,667 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:07:36,308 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:07:36,308 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:07:36,308 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:07:36,308 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:07:36,309 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:07:36,310 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:07:36,310 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:07:36,310 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:07:36,311 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:07:36,311 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:07:36,311 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:07:36,312 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:07:36,313 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:07:36,313 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:07:37,974 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:08:03,046 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:08:03,046 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:08:03,046 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:08:03,047 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:08:03,048 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:08:03,049 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:08:03,049 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:08:03,049 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:08:03,049 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:08:03,050 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:08:03,051 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:08:05,217 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:08:36,584 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:08:36,585 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:08:36,585 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:08:36,585 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:08:36,586 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:08:36,586 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:08:36,586 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:08:36,586 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:08:36,587 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:08:36,587 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:08:36,587 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:08:36,587 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:08:36,587 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:08:36,588 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:08:36,588 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:08:38,290 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:09:05,111 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:09:05,112 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:09:05,112 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:09:05,112 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:09:05,112 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:09:05,112 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:09:05,113 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:09:05,113 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:09:05,113 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:09:05,114 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:09:05,114 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:09:05,115 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:09:05,115 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:09:06,654 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:09:32,428 - train_models - INFO - Model for 210 - MAE: 0.3483, RMSE: 0.8012, R²: 0.9361, MAPE: 5.28%
2025-05-30 15:09:32,428 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 15:09:32,428 - train_models - INFO -   Relative_Quantity: 0.8308
2025-05-30 15:09:32,428 - train_models - INFO -   Hours_per_Quantity: 0.0464
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0463
2025-05-30 15:09:32,429 - train_models - INFO -   Quantity_per_Worker: 0.0462
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 15:09:32,429 - train_models - INFO -   Quantity_1day_trend: 0.0048
2025-05-30 15:09:32,429 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0039
2025-05-30 15:09:32,430 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-30 15:09:32,430 - train_models - INFO -   NoOfMan_lag_3: 0.0013
2025-05-30 15:09:32,430 - train_models - INFO -   Quantity_7day_trend: 0.0012
2025-05-30 15:09:32,430 - train_models - INFO - Cross-validation details for 210:
2025-05-30 15:09:32,430 - train_models - INFO -   Fold 1: MAE=0.4781, RMSE=0.7752, R²=0.9460, MAPE=6.91%
2025-05-30 15:09:32,430 - train_models - INFO -   Fold 2: MAE=0.4624, RMSE=1.4247, R²=0.8165, MAPE=7.10%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 3: MAE=0.2539, RMSE=0.4706, R²=0.9787, MAPE=2.89%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 4: MAE=0.2712, RMSE=0.7288, R²=0.9598, MAPE=6.19%
2025-05-30 15:09:32,431 - train_models - INFO -   Fold 5: MAE=0.2760, RMSE=0.6065, R²=0.9796, MAPE=3.32%
2025-05-30 15:09:32,431 - train_models - INFO - Building model for WorkType: 211
2025-05-30 15:09:34,095 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:01,316 - train_models - INFO - Model for 211 - MAE: 0.5923, RMSE: 0.9048, R²: 0.9279, MAPE: 8.83%
2025-05-30 15:10:01,317 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 15:10:01,317 - train_models - INFO -   Relative_Quantity: 0.4814
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1691
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_7day_trend: 0.1091
2025-05-30 15:10:01,317 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0757
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_1day_trend: 0.0392
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_lag_1: 0.0218
2025-05-30 15:10:01,318 - train_models - INFO -   Quantity_per_Worker: 0.0172
2025-05-30 15:10:01,318 - train_models - INFO -   Hours_per_Quantity: 0.0126
2025-05-30 15:10:01,318 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0046
2025-05-30 15:10:01,318 - train_models - INFO - Cross-validation details for 211:
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 1: MAE=0.9589, RMSE=1.5256, R²=0.8421, MAPE=12.05%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 2: MAE=0.5348, RMSE=0.8193, R²=0.9391, MAPE=6.32%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 3: MAE=0.5233, RMSE=0.8709, R²=0.9371, MAPE=11.53%
2025-05-30 15:10:01,319 - train_models - INFO -   Fold 4: MAE=0.4535, RMSE=0.6321, R²=0.9672, MAPE=6.84%
2025-05-30 15:10:01,320 - train_models - INFO -   Fold 5: MAE=0.4913, RMSE=0.6762, R²=0.9542, MAPE=7.39%
2025-05-30 15:10:01,320 - train_models - INFO - Building model for WorkType: 213
2025-05-30 15:10:02,945 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:28,406 - train_models - INFO - Model for 213 - MAE: 0.4047, RMSE: 0.6085, R²: 0.8818, MAPE: 16.08%
2025-05-30 15:10:28,406 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4472
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_7day_trend: 0.2020
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_1day_trend: 0.1429
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_lag_1: 0.0461
2025-05-30 15:10:28,407 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0431
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0361
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_lag_7: 0.0255
2025-05-30 15:10:28,408 - train_models - INFO -   Relative_Quantity: 0.0087
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-05-30 15:10:28,408 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0075
2025-05-30 15:10:28,409 - train_models - INFO - Cross-validation details for 213:
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 1: MAE=0.5493, RMSE=0.8495, R²=0.8377, MAPE=15.08%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 2: MAE=0.4847, RMSE=0.6703, R²=0.8512, MAPE=25.75%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 3: MAE=0.3230, RMSE=0.5194, R²=0.8994, MAPE=15.13%
2025-05-30 15:10:28,409 - train_models - INFO -   Fold 4: MAE=0.3184, RMSE=0.4778, R²=0.9134, MAPE=12.25%
2025-05-30 15:10:28,410 - train_models - INFO -   Fold 5: MAE=0.3481, RMSE=0.5255, R²=0.9072, MAPE=12.16%
2025-05-30 15:10:28,410 - train_models - INFO - Building model for WorkType: 214
2025-05-30 15:10:30,073 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:10:56,399 - train_models - INFO - Model for 214 - MAE: 0.4681, RMSE: 0.6879, R²: 0.8940, MAPE: 10.16%
2025-05-30 15:10:56,399 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 15:10:56,399 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4745
2025-05-30 15:10:56,400 - train_models - INFO -   NoOfMan_7day_trend: 0.1603
2025-05-30 15:10:56,400 - train_models - INFO -   Relative_Quantity: 0.0938
2025-05-30 15:10:56,400 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0711
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_1day_trend: 0.0577
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_lag_7: 0.0461
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_lag_1: 0.0247
2025-05-30 15:10:56,401 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0101
2025-05-30 15:10:56,402 - train_models - INFO -   SystemHours_per_Quantity: 0.0076
2025-05-30 15:10:56,402 - train_models - INFO -   Hours_per_Quantity: 0.0074
2025-05-30 15:10:56,402 - train_models - INFO - Cross-validation details for 214:
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 1: MAE=0.4797, RMSE=0.6487, R²=0.8570, MAPE=11.90%
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.5307, R²=0.9212, MAPE=9.84%
2025-05-30 15:10:56,403 - train_models - INFO -   Fold 3: MAE=0.3354, RMSE=0.4474, R²=0.9468, MAPE=9.28%
2025-05-30 15:10:56,404 - train_models - INFO -   Fold 4: MAE=0.3278, RMSE=0.5535, R²=0.9284, MAPE=6.41%
2025-05-30 15:10:56,404 - train_models - INFO -   Fold 5: MAE=0.7710, RMSE=1.2593, R²=0.8167, MAPE=13.38%
2025-05-30 15:10:56,404 - train_models - INFO - Building model for WorkType: 217
2025-05-30 15:10:57,929 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:11:24,384 - train_models - INFO - Starting the model training process
2025-05-30 15:11:24,384 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:11:24,387 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:11:24,497 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:11:25,092 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:11:25,168 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:11:25,185 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:11:25,186 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:11:25,199 - train_models - INFO - Engineering features...
2025-05-30 15:11:25,541 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:11:25,569 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:11:25,575 - train_models - INFO - Creating lag features...
2025-05-30 15:11:25,585 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:11:25,816 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:11:25,817 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:11:25,835 - train_models - INFO - Found 10 unique work types
2025-05-30 15:11:25,835 - train_models - INFO - Building models for 10 work types
2025-05-30 15:11:25,835 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:11:25,836 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:11:25,836 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:11:27,714 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:11:50,563 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:11:50,563 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:11:50,563 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:11:50,564 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:11:50,565 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:11:50,565 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:11:50,565 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:11:50,566 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:11:50,566 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:11:50,566 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:11:50,566 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:11:50,567 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:11:50,567 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:11:52,224 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:12:16,365 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:12:16,366 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:12:16,366 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:12:16,366 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:12:16,367 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:12:16,368 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:12:16,369 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:12:16,369 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:12:16,369 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:12:16,369 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:12:16,370 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:12:16,371 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:12:16,371 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:12:18,500 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:12:50,818 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:12:50,819 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:12:50,819 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:12:50,819 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:12:50,819 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:12:50,820 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:12:50,820 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:12:50,820 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:12:50,821 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:12:50,821 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:12:50,821 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:12:50,821 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:12:50,821 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:12:50,822 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:12:50,822 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:12:52,476 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:13:18,754 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:13:18,754 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:13:18,754 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:13:18,754 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:13:18,755 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:13:18,755 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:13:18,755 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:13:18,755 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:13:18,756 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:13:18,756 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:13:18,756 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:13:18,756 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:13:18,756 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:13:18,757 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:13:18,757 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:13:20,314 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:13:46,113 - train_models - INFO - Model for 210 - MAE: 0.3483, RMSE: 0.8012, R²: 0.9361, MAPE: 5.28%
2025-05-30 15:13:46,114 - train_models - INFO - Top 10 most important features for 210:
2025-05-30 15:13:46,114 - train_models - INFO -   Relative_Quantity: 0.8308
2025-05-30 15:13:46,114 - train_models - INFO -   Hours_per_Quantity: 0.0464
2025-05-30 15:13:46,114 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0463
2025-05-30 15:13:46,114 - train_models - INFO -   Quantity_per_Worker: 0.0462
2025-05-30 15:13:46,114 - train_models - INFO -   NoOfMan_7day_trend: 0.0061
2025-05-30 15:13:46,115 - train_models - INFO -   Quantity_1day_trend: 0.0048
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0039
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_1day_trend: 0.0021
2025-05-30 15:13:46,115 - train_models - INFO -   NoOfMan_lag_3: 0.0013
2025-05-30 15:13:46,115 - train_models - INFO -   Quantity_7day_trend: 0.0012
2025-05-30 15:13:46,115 - train_models - INFO - Cross-validation details for 210:
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 1: MAE=0.4781, RMSE=0.7752, R²=0.9460, MAPE=6.91%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 2: MAE=0.4624, RMSE=1.4247, R²=0.8165, MAPE=7.10%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 3: MAE=0.2539, RMSE=0.4706, R²=0.9787, MAPE=2.89%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 4: MAE=0.2712, RMSE=0.7288, R²=0.9598, MAPE=6.19%
2025-05-30 15:13:46,116 - train_models - INFO -   Fold 5: MAE=0.2760, RMSE=0.6065, R²=0.9796, MAPE=3.32%
2025-05-30 15:13:46,117 - train_models - INFO - Building model for WorkType: 211
2025-05-30 15:13:47,798 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:14:14,986 - train_models - INFO - Model for 211 - MAE: 0.5923, RMSE: 0.9048, R²: 0.9279, MAPE: 8.83%
2025-05-30 15:14:14,986 - train_models - INFO - Top 10 most important features for 211:
2025-05-30 15:14:14,986 - train_models - INFO -   Relative_Quantity: 0.4814
2025-05-30 15:14:14,986 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1691
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_7day_trend: 0.1091
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0757
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_1day_trend: 0.0392
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_lag_7: 0.0268
2025-05-30 15:14:14,987 - train_models - INFO -   NoOfMan_lag_1: 0.0218
2025-05-30 15:14:14,988 - train_models - INFO -   Quantity_per_Worker: 0.0172
2025-05-30 15:14:14,988 - train_models - INFO -   Hours_per_Quantity: 0.0126
2025-05-30 15:14:14,988 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0046
2025-05-30 15:14:14,988 - train_models - INFO - Cross-validation details for 211:
2025-05-30 15:14:14,988 - train_models - INFO -   Fold 1: MAE=0.9589, RMSE=1.5256, R²=0.8421, MAPE=12.05%
2025-05-30 15:14:14,988 - train_models - INFO -   Fold 2: MAE=0.5348, RMSE=0.8193, R²=0.9391, MAPE=6.32%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 3: MAE=0.5233, RMSE=0.8709, R²=0.9371, MAPE=11.53%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 4: MAE=0.4535, RMSE=0.6321, R²=0.9672, MAPE=6.84%
2025-05-30 15:14:14,989 - train_models - INFO -   Fold 5: MAE=0.4913, RMSE=0.6762, R²=0.9542, MAPE=7.39%
2025-05-30 15:14:14,989 - train_models - INFO - Building model for WorkType: 213
2025-05-30 15:14:16,613 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:14:42,430 - train_models - INFO - Model for 213 - MAE: 0.4047, RMSE: 0.6085, R²: 0.8818, MAPE: 16.08%
2025-05-30 15:14:42,431 - train_models - INFO - Top 10 most important features for 213:
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4472
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_7day_trend: 0.2020
2025-05-30 15:14:42,431 - train_models - INFO -   NoOfMan_1day_trend: 0.1429
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_lag_1: 0.0461
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0431
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0361
2025-05-30 15:14:42,432 - train_models - INFO -   NoOfMan_lag_7: 0.0255
2025-05-30 15:14:42,433 - train_models - INFO -   Relative_Quantity: 0.0087
2025-05-30 15:14:42,433 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0076
2025-05-30 15:14:42,433 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0075
2025-05-30 15:14:42,433 - train_models - INFO - Cross-validation details for 213:
2025-05-30 15:14:42,433 - train_models - INFO -   Fold 1: MAE=0.5493, RMSE=0.8495, R²=0.8377, MAPE=15.08%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 2: MAE=0.4847, RMSE=0.6703, R²=0.8512, MAPE=25.75%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 3: MAE=0.3230, RMSE=0.5194, R²=0.8994, MAPE=15.13%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 4: MAE=0.3184, RMSE=0.4778, R²=0.9134, MAPE=12.25%
2025-05-30 15:14:42,434 - train_models - INFO -   Fold 5: MAE=0.3481, RMSE=0.5255, R²=0.9072, MAPE=12.16%
2025-05-30 15:14:42,435 - train_models - INFO - Building model for WorkType: 214
2025-05-30 15:14:44,541 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:15:09,322 - train_models - INFO - Model for 214 - MAE: 0.4681, RMSE: 0.6879, R²: 0.8940, MAPE: 10.16%
2025-05-30 15:15:09,323 - train_models - INFO - Top 10 most important features for 214:
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.4745
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_7day_trend: 0.1603
2025-05-30 15:15:09,323 - train_models - INFO -   Relative_Quantity: 0.0938
2025-05-30 15:15:09,323 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0711
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_1day_trend: 0.0577
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_lag_7: 0.0461
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_lag_1: 0.0247
2025-05-30 15:15:09,324 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0101
2025-05-30 15:15:09,324 - train_models - INFO -   SystemHours_per_Quantity: 0.0076
2025-05-30 15:15:09,325 - train_models - INFO -   Hours_per_Quantity: 0.0074
2025-05-30 15:15:09,325 - train_models - INFO - Cross-validation details for 214:
2025-05-30 15:15:09,325 - train_models - INFO -   Fold 1: MAE=0.4797, RMSE=0.6487, R²=0.8570, MAPE=11.90%
2025-05-30 15:15:09,325 - train_models - INFO -   Fold 2: MAE=0.4265, RMSE=0.5307, R²=0.9212, MAPE=9.84%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 3: MAE=0.3354, RMSE=0.4474, R²=0.9468, MAPE=9.28%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 4: MAE=0.3278, RMSE=0.5535, R²=0.9284, MAPE=6.41%
2025-05-30 15:15:09,326 - train_models - INFO -   Fold 5: MAE=0.7710, RMSE=1.2593, R²=0.8167, MAPE=13.38%
2025-05-30 15:15:09,326 - train_models - INFO - Building model for WorkType: 215
2025-05-30 15:15:11,134 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:15:39,521 - train_models - INFO - Model for 215 - MAE: 0.2851, RMSE: 0.6385, R²: 0.9597, MAPE: 6.08%
2025-05-30 15:15:39,521 - train_models - INFO - Top 10 most important features for 215:
2025-05-30 15:15:39,522 - train_models - INFO -   Relative_Quantity: 0.8671
2025-05-30 15:15:39,522 - train_models - INFO -   Hours_per_Quantity: 0.0560
2025-05-30 15:15:39,522 - train_models - INFO -   Quantity_per_Worker: 0.0409
2025-05-30 15:15:39,522 - train_models - INFO -   NoOfMan_7day_trend: 0.0077
2025-05-30 15:15:39,522 - train_models - INFO -   NoOfMan_1day_trend: 0.0073
2025-05-30 15:15:39,523 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0063
2025-05-30 15:15:39,523 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0016
2025-05-30 15:15:39,523 - train_models - INFO -   SystemHours_per_Quantity: 0.0016
2025-05-30 15:15:39,523 - train_models - INFO -   Quantity_1day_trend: 0.0011
2025-05-30 15:15:39,524 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0010
2025-05-30 15:15:39,524 - train_models - INFO - Cross-validation details for 215:
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 1: MAE=0.5364, RMSE=1.1687, R²=0.8904, MAPE=10.93%
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 2: MAE=0.2631, RMSE=0.4396, R²=0.9835, MAPE=7.83%
2025-05-30 15:15:39,524 - train_models - INFO -   Fold 3: MAE=0.2331, RMSE=0.6094, R²=0.9691, MAPE=4.26%
2025-05-30 15:15:39,525 - train_models - INFO -   Fold 4: MAE=0.1929, RMSE=0.4279, R²=0.9808, MAPE=4.46%
2025-05-30 15:15:39,525 - train_models - INFO -   Fold 5: MAE=0.1999, RMSE=0.5469, R²=0.9746, MAPE=2.95%
2025-05-30 15:15:39,525 - train_models - INFO - Building model for WorkType: 217
2025-05-30 15:15:41,111 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:16:02,725 - train_models - INFO - Model for 217 - MAE: 0.3809, RMSE: 0.5177, R²: 0.9245, MAPE: 17.43%
2025-05-30 15:16:02,726 - train_models - INFO - Top 10 most important features for 217:
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.5645
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_7day_trend: 0.1173
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0868
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_lag_1: 0.0743
2025-05-30 15:16:02,726 - train_models - INFO -   NoOfMan_1day_trend: 0.0695
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0279
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_lag_7: 0.0232
2025-05-30 15:16:02,727 - train_models - INFO -   Relative_Quantity: 0.0061
2025-05-30 15:16:02,727 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0045
2025-05-30 15:16:02,727 - train_models - INFO -   Hours_per_Quantity: 0.0026
2025-05-30 15:16:02,728 - train_models - INFO - Cross-validation details for 217:
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 1: MAE=0.4965, RMSE=0.6494, R²=0.8629, MAPE=27.24%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 2: MAE=0.4093, RMSE=0.5284, R²=0.9172, MAPE=20.39%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 3: MAE=0.3325, RMSE=0.4335, R²=0.9564, MAPE=13.13%
2025-05-30 15:16:02,728 - train_models - INFO -   Fold 4: MAE=0.3093, RMSE=0.3951, R²=0.9663, MAPE=13.06%
2025-05-30 15:16:02,729 - train_models - INFO -   Fold 5: MAE=0.3569, RMSE=0.5820, R²=0.9194, MAPE=13.30%
2025-05-30 15:16:02,729 - train_models - INFO - Saving 10 models to C:/forlogssystems/Models
2025-05-30 15:16:03,358 - train_models - INFO - Model files saved successfully
2025-05-30 15:16:03,359 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 15:16:03,361 - train_models - INFO - Model training completed successfully
2025-05-30 15:39:16,574 - train_models - INFO - Starting the model training process
2025-05-30 15:39:16,575 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:39:16,578 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:39:16,704 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:39:17,316 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:39:17,377 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:39:17,396 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:39:17,398 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:39:17,421 - train_models - INFO - Engineering features...
2025-05-30 15:39:17,803 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:39:17,831 - utils.feature_engineering - ERROR - Error engineering features: ('Date', 'Relative_Quantity')
2025-05-30 15:39:17,910 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

2025-05-30 15:39:17,912 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: ('Date', 'Relative_Quantity')
2025-05-30 15:39:17,913 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 356, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 128, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: ('Date', 'Relative_Quantity')

2025-05-30 15:39:17,915 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 15:40:12,450 - train_models - INFO - Starting the model training process
2025-05-30 15:40:12,450 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:40:12,453 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:40:12,568 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:40:13,170 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:40:13,247 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:40:13,264 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:40:13,265 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:40:13,277 - train_models - INFO - Engineering features...
2025-05-30 15:40:13,613 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:40:13,641 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:40:13,645 - train_models - INFO - Creating lag features...
2025-05-30 15:40:13,657 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:40:13,865 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:40:13,865 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:40:13,878 - train_models - INFO - Found 10 unique work types
2025-05-30 15:40:13,879 - train_models - INFO - Building models for 10 work types
2025-05-30 15:40:13,879 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:40:13,879 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:40:13,879 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:40:15,667 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:40:39,895 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:40:39,896 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:40:39,896 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:40:39,897 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:40:39,897 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:40:39,898 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:40:39,898 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:40:39,898 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:40:39,899 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:40:39,899 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:40:39,900 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:40:39,900 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:40:39,900 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:40:41,658 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:41:07,403 - train_models - INFO - Model for 203 - MAE: 0.2262, RMSE: 0.3304, R²: 0.9121, MAPE: 4.88%
2025-05-30 15:41:07,403 - train_models - INFO - Top 10 most important features for 203:
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_7day_trend: 0.3086
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.2308
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1198
2025-05-30 15:41:07,404 - train_models - INFO -   NoOfMan_lag_7: 0.0960
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_1day_trend: 0.0878
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0668
2025-05-30 15:41:07,405 - train_models - INFO -   NoOfMan_lag_1: 0.0509
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_rolling_std_7: 0.0051
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0033
2025-05-30 15:41:07,406 - train_models - INFO -   NoOfMan_lag_2: 0.0025
2025-05-30 15:41:07,406 - train_models - INFO - Cross-validation details for 203:
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 1: MAE=0.2850, RMSE=0.3937, R²=0.8803, MAPE=5.72%
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 2: MAE=0.2557, RMSE=0.3449, R²=0.9123, MAPE=5.05%
2025-05-30 15:41:07,407 - train_models - INFO -   Fold 3: MAE=0.2299, RMSE=0.3686, R²=0.8978, MAPE=4.26%
2025-05-30 15:41:07,408 - train_models - INFO -   Fold 4: MAE=0.1740, RMSE=0.2607, R²=0.9444, MAPE=4.13%
2025-05-30 15:41:07,408 - train_models - INFO -   Fold 5: MAE=0.1864, RMSE=0.2840, R²=0.9258, MAPE=5.25%
2025-05-30 15:41:07,408 - train_models - INFO - Building model for WorkType: 206
2025-05-30 15:41:09,296 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:41:41,606 - train_models - INFO - Model for 206 - MAE: 1.2964, RMSE: 2.0803, R²: 0.9387, MAPE: 9.54%
2025-05-30 15:41:41,606 - train_models - INFO - Top 10 most important features for 206:
2025-05-30 15:41:41,607 - train_models - INFO -   Relative_Quantity: 0.6101
2025-05-30 15:41:41,607 - train_models - INFO -   NoOfMan_same_dow_lag: 0.2010
2025-05-30 15:41:41,607 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0423
2025-05-30 15:41:41,608 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0367
2025-05-30 15:41:41,608 - train_models - INFO -   Hours_per_Quantity: 0.0319
2025-05-30 15:41:41,608 - train_models - INFO -   Quantity_per_Worker: 0.0236
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_7day_trend: 0.0121
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_1day_trend: 0.0112
2025-05-30 15:41:41,609 - train_models - INFO -   NoOfMan_lag_1: 0.0048
2025-05-30 15:41:41,610 - train_models - INFO -   NoOfMan_lag_7: 0.0027
2025-05-30 15:41:41,610 - train_models - INFO - Cross-validation details for 206:
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 1: MAE=1.6376, RMSE=2.2916, R²=0.9313, MAPE=12.78%
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 2: MAE=1.4356, RMSE=2.0653, R²=0.9396, MAPE=7.48%
2025-05-30 15:41:41,610 - train_models - INFO -   Fold 3: MAE=1.2350, RMSE=2.3360, R²=0.9183, MAPE=6.68%
2025-05-30 15:41:41,611 - train_models - INFO -   Fold 4: MAE=0.9153, RMSE=1.4961, R²=0.9572, MAPE=5.39%
2025-05-30 15:41:41,611 - train_models - INFO -   Fold 5: MAE=1.2583, RMSE=2.2127, R²=0.9471, MAPE=15.35%
2025-05-30 15:41:41,611 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:41:43,272 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:09,758 - train_models - INFO - Model for 209 - MAE: 0.4333, RMSE: 0.8185, R²: 0.9613, MAPE: 6.68%
2025-05-30 15:42:09,758 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 15:42:09,759 - train_models - INFO -   Relative_Quantity: 0.6830
2025-05-30 15:42:09,759 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1579
2025-05-30 15:42:09,759 - train_models - INFO -   Hours_per_Quantity: 0.0751
2025-05-30 15:42:09,760 - train_models - INFO -   Quantity_per_Worker: 0.0483
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.0078
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_7day_trend: 0.0050
2025-05-30 15:42:09,760 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0031
2025-05-30 15:42:09,761 - train_models - INFO -   Quantity_rolling_mean_7: 0.0023
2025-05-30 15:42:09,761 - train_models - INFO -   NoOfMan_1day_trend: 0.0013
2025-05-30 15:42:09,761 - train_models - INFO -   SystemHours_per_Quantity: 0.0011
2025-05-30 15:42:09,762 - train_models - INFO - Cross-validation details for 209:
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 1: MAE=0.5739, RMSE=0.8990, R²=0.9452, MAPE=7.73%
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 2: MAE=0.5629, RMSE=1.1508, R²=0.9308, MAPE=8.86%
2025-05-30 15:42:09,762 - train_models - INFO -   Fold 3: MAE=0.2895, RMSE=0.5589, R²=0.9759, MAPE=3.63%
2025-05-30 15:42:09,763 - train_models - INFO -   Fold 4: MAE=0.4258, RMSE=0.8641, R²=0.9690, MAPE=9.83%
2025-05-30 15:42:09,763 - train_models - INFO -   Fold 5: MAE=0.3146, RMSE=0.6196, R²=0.9858, MAPE=3.36%
2025-05-30 15:42:09,763 - train_models - INFO - Building model for WorkType: 210
2025-05-30 15:42:11,425 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:31,806 - train_models - INFO - Starting the model training process
2025-05-30 15:42:31,806 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:42:31,810 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:42:31,929 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:42:32,518 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:42:32,593 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:42:32,610 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:42:32,611 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:42:32,624 - train_models - INFO - Engineering features...
2025-05-30 15:42:33,050 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:42:33,077 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:42:33,083 - train_models - INFO - Creating lag features...
2025-05-30 15:42:33,094 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:42:33,303 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:42:33,303 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:42:33,318 - train_models - INFO - Found 10 unique work types
2025-05-30 15:42:33,318 - train_models - INFO - Building models for 10 work types
2025-05-30 15:42:33,318 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:42:33,319 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:42:33,319 - train_models - INFO - Building model for WorkType: 202
2025-05-30 15:42:35,052 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:42:58,153 - train_models - INFO - Model for 202 - MAE: 0.2217, RMSE: 0.3413, R²: 0.7414, MAPE: 10.75%
2025-05-30 15:42:58,154 - train_models - INFO - Top 10 most important features for 202:
2025-05-30 15:42:58,154 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.3701
2025-05-30 15:42:58,154 - train_models - INFO -   NoOfMan_7day_trend: 0.1956
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_1day_trend: 0.1096
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_rolling_max_7: 0.0686
2025-05-30 15:42:58,155 - train_models - INFO -   NoOfMan_lag_7: 0.0649
2025-05-30 15:42:58,156 - train_models - INFO -   NoOfMan_lag_1: 0.0546
2025-05-30 15:42:58,156 - train_models - INFO -   Relative_Quantity: 0.0503
2025-05-30 15:42:58,156 - train_models - INFO -   NoOfMan_rolling_min_7: 0.0272
2025-05-30 15:42:58,157 - train_models - INFO -   Hours_per_Quantity: 0.0159
2025-05-30 15:42:58,157 - train_models - INFO -   Quantity_per_Worker: 0.0091
2025-05-30 15:42:58,157 - train_models - INFO - Cross-validation details for 202:
2025-05-30 15:42:58,157 - train_models - INFO -   Fold 1: MAE=0.2264, RMSE=0.4224, R²=0.3986, MAPE=11.69%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 2: MAE=0.2059, RMSE=0.3055, R²=0.7913, MAPE=11.72%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 3: MAE=0.2328, RMSE=0.3668, R²=0.7942, MAPE=12.17%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 4: MAE=0.1960, RMSE=0.2553, R²=0.8671, MAPE=8.83%
2025-05-30 15:42:58,158 - train_models - INFO -   Fold 5: MAE=0.2472, RMSE=0.3564, R²=0.8560, MAPE=9.31%
2025-05-30 15:42:58,159 - train_models - INFO - Building model for WorkType: 203
2025-05-30 15:42:59,893 - train_models - INFO - Using 28 numeric features and 4 categorical features
2025-05-30 15:45:51,665 - train_models - INFO - Starting the model training process
2025-05-30 15:45:51,665 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:45:51,668 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:45:51,778 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (215, 209, 213, 211, 214, 202, 203, 206, 208, 210, 217) 
                order by Date
            
2025-05-30 15:45:52,371 - train_models - INFO - Read chunk of 10000 rows
2025-05-30 15:45:52,452 - train_models - INFO - Read chunk of 5476 rows
2025-05-30 15:45:52,470 - train_models - INFO - Data loaded successfully. Total rows: 15476
2025-05-30 15:45:52,472 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:45:52,484 - train_models - INFO - Engineering features...
2025-05-30 15:45:52,813 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:45:52,845 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:45:52,850 - train_models - INFO - Creating lag features...
2025-05-30 15:45:52,859 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:45:53,079 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:45:53,082 - utils.feature_engineering - INFO - Final shape: (15476, 71)
2025-05-30 15:45:53,099 - train_models - INFO - Found 10 unique work types
2025-05-30 15:45:53,101 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:45:53,102 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:48:25,105 - train_models - INFO - Starting the model training process
2025-05-30 15:48:25,106 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:48:25,109 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:48:25,219 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:48:25,594 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:48:25,622 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:48:25,623 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:48:25,630 - train_models - INFO - Engineering features...
2025-05-30 15:48:25,963 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:48:25,974 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:48:25,976 - train_models - INFO - Creating lag features...
2025-05-30 15:48:25,983 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:48:26,102 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:48:26,102 - utils.feature_engineering - INFO - Final shape: (1526, 71)
2025-05-30 15:48:26,105 - train_models - INFO - Found 1 unique work types
2025-05-30 15:48:26,105 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:48:26,106 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:50:46,098 - train_models - INFO - Starting the model training process
2025-05-30 15:50:46,098 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:50:46,101 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:50:46,217 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:50:46,586 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:50:46,601 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:50:46,603 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:50:46,612 - train_models - INFO - Engineering features...
2025-05-30 15:50:47,075 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:50:47,087 - utils.feature_engineering - ERROR - Error engineering features: ('Date', 'Relative_Quantity')
2025-05-30 15:50:47,160 - utils.feature_engineering - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

2025-05-30 15:50:47,161 - train_models - ERROR - Error in train_from_sql: Failed to engineer features: ('Date', 'Relative_Quantity')
2025-05-30 15:50:47,163 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: ('Date', 'Relative_Quantity')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 118, in engineer_features
    print(data['Date','Relative_Quantity'])
          ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: ('Date', 'Relative_Quantity')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 356, in train_from_sql
    feature_df = engineer_features(df)
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 219, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 261, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\forlogssystems\work_utilization_app\venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 320, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "C:\forlogssystems\work_utilization_app\utils\feature_engineering.py", line 128, in engineer_features
    raise Exception(f"Failed to engineer features: {str(e)}")
Exception: Failed to engineer features: ('Date', 'Relative_Quantity')

2025-05-30 15:50:47,164 - train_models - ERROR - SQL training failed. Check logs for details.
2025-05-30 15:51:47,025 - train_models - INFO - Starting the model training process
2025-05-30 15:51:47,025 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:51:47,029 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:51:47,136 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:51:47,484 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:51:47,500 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:51:47,502 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:51:47,507 - train_models - INFO - Engineering features...
2025-05-30 15:51:47,868 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:51:47,888 - utils.feature_engineering - INFO - Feature engineering completed. Added 15 new features.
2025-05-30 15:51:47,891 - train_models - INFO - Creating lag features...
2025-05-30 15:51:47,898 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:51:48,004 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:51:48,004 - utils.feature_engineering - INFO - Final shape: (1526, 71)
2025-05-30 15:51:48,007 - train_models - INFO - Found 1 unique work types
2025-05-30 15:51:48,007 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:51:48,008 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:59:28,740 - train_models - INFO - Starting the model training process
2025-05-30 15:59:28,741 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:59:28,745 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:59:28,872 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:59:29,247 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:59:29,264 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:59:29,265 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:59:29,274 - train_models - INFO - Engineering features...
2025-05-30 15:59:29,875 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:59:29,889 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-05-30 15:59:29,891 - train_models - INFO - Creating lag features...
2025-05-30 15:59:29,898 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:59:30,009 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:59:30,009 - utils.feature_engineering - INFO - Final shape: (1526, 70)
2025-05-30 15:59:30,011 - train_models - INFO - Found 1 unique work types
2025-05-30 15:59:30,012 - train_models - ERROR - Error in main training process: 'NoneType' object is not subscriptable
2025-05-30 15:59:30,013 - train_models - ERROR - Traceback (most recent call last):
  File "C:\forlogssystems\work_utilization_app\train_models.py", line 452, in main
    if result[0] is None:
       ~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

2025-05-30 15:59:52,441 - train_models - INFO - Starting the model training process
2025-05-30 15:59:52,441 - train_models - INFO - Training from SQL database (command line argument)
2025-05-30 15:59:52,444 - train_models - INFO - Connecting to database ABC on server 192.168.1.43
2025-05-30 15:59:52,554 - train_models - INFO - Executing SQL query: 
            SELECT Date, PunchCode, Hours, NoOfMan, SystemHours, Quantity, ResourceKPI, SystemKPI 
                FROM WorkUtilizationData 
                WHERE PunchCode IN (209) 
                order by Date
            
2025-05-30 15:59:52,909 - train_models - INFO - Read chunk of 1526 rows
2025-05-30 15:59:52,925 - train_models - INFO - Data loaded successfully. Total rows: 1526
2025-05-30 15:59:52,927 - train_models - INFO - Converting Date column to datetime format
2025-05-30 15:59:52,937 - train_models - INFO - Engineering features...
2025-05-30 15:59:53,283 - utils.feature_engineering - INFO - Engineering features
2025-05-30 15:59:53,292 - utils.feature_engineering - INFO - Feature engineering completed. Added 14 new features.
2025-05-30 15:59:53,294 - train_models - INFO - Creating lag features...
2025-05-30 15:59:53,301 - utils.feature_engineering - INFO - Creating lag features for NoOfMan grouped by WorkType
2025-05-30 15:59:53,407 - utils.feature_engineering - INFO - Lag features created. Dropped 0 rows with NaN values.
2025-05-30 15:59:53,407 - utils.feature_engineering - INFO - Final shape: (1526, 70)
2025-05-30 15:59:53,409 - train_models - INFO - Found 1 unique work types
2025-05-30 15:59:53,409 - train_models - INFO - Building models for 1 work types
2025-05-30 15:59:53,410 - train_models - INFO - Numeric features: ['NoOfMan_lag_1', 'NoOfMan_lag_2', 'NoOfMan_lag_3', 'NoOfMan_lag_7', 'NoOfMan_rolling_mean_7', 'IsWeekend_feat', 'NoOfMan_rolling_max_7', 'NoOfMan_rolling_min_7', 'NoOfMan_rolling_std_7', 'NoOfMan_same_dow_lag', 'NoOfMan_same_dom_lag', 'NoOfMan_7day_trend', 'NoOfMan_1day_trend', 'Quantity_lag_1', 'Quantity_lag_7', 'Quantity_rolling_mean_7', 'Quantity_per_Worker', 'Relative_Quantity', 'Quantity_same_dow_lag', 'ResourceKPI_lag_1', 'SystemKPI_lag_1', 'Combined_KPI_lag_1', 'Hours_SystemHours_Ratio_lag_1', 'Hours_per_Quantity', 'SystemHours_per_Quantity', 'Workers_Predicted_from_Quantity', 'Quantity_7day_trend', 'Quantity_1day_trend']
2025-05-30 15:59:53,410 - train_models - INFO - Categorical features: ['DayOfWeek_feat', 'Month_feat', 'Quarter', 'Year_feat']
2025-05-30 15:59:53,410 - train_models - INFO - Building model for WorkType: 209
2025-05-30 15:59:55,251 - train_models - INFO - Using 27 numeric features and 4 categorical features
2025-05-30 16:00:22,483 - train_models - INFO - Model for 209 - MAE: 0.9495, RMSE: 1.4467, R²: 0.8901, MAPE: 16.59%
2025-05-30 16:00:22,483 - train_models - INFO - Top 10 most important features for 209:
2025-05-30 16:00:22,483 - train_models - INFO -   NoOfMan_7day_trend: 0.3955
2025-05-30 16:00:22,484 - train_models - INFO -   NoOfMan_rolling_mean_7: 0.1317
2025-05-30 16:00:22,484 - train_models - INFO -   NoOfMan_rolling_max_7: 0.1159
2025-05-30 16:00:22,484 - train_models - INFO -   Hours_per_Quantity: 0.0661
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_lag_7: 0.0639
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_1day_trend: 0.0595
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_lag_1: 0.0383
2025-05-30 16:00:22,485 - train_models - INFO -   Quantity_rolling_mean_7: 0.0216
2025-05-30 16:00:22,485 - train_models - INFO -   NoOfMan_same_dow_lag: 0.0197
2025-05-30 16:00:22,486 - train_models - INFO -   Quantity_per_Worker: 0.0104
2025-05-30 16:00:22,486 - train_models - INFO - Cross-validation details for 209:
2025-05-30 16:00:22,486 - train_models - INFO -   Fold 1: MAE=1.0186, RMSE=1.4758, R²=0.8524, MAPE=14.25%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 2: MAE=0.9940, RMSE=1.5382, R²=0.8764, MAPE=16.08%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 3: MAE=0.6812, RMSE=0.8998, R²=0.9376, MAPE=10.49%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 4: MAE=1.0389, RMSE=1.6207, R²=0.8909, MAPE=24.36%
2025-05-30 16:00:22,487 - train_models - INFO -   Fold 5: MAE=1.0150, RMSE=1.6990, R²=0.8929, MAPE=17.76%
2025-05-30 16:00:22,488 - train_models - INFO - Saving 1 models to C:/forlogssystems/Models
2025-05-30 16:00:22,576 - train_models - INFO - Model files saved successfully
2025-05-30 16:00:22,576 - train_models - INFO - Performance summary saved to C:/forlogssystems/Models\model_performance_summary.xlsx
2025-05-30 16:00:22,577 - train_models - INFO - Model training completed successfully
